<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Orthogonal and Unitary Matrices ¬∑ Manifolds.jl</title><meta name="title" content="Orthogonal and Unitary Matrices ¬∑ Manifolds.jl"/><meta property="og:title" content="Orthogonal and Unitary Matrices ¬∑ Manifolds.jl"/><meta property="twitter:title" content="Orthogonal and Unitary Matrices ¬∑ Manifolds.jl"/><meta name="description" content="Documentation for Manifolds.jl."/><meta property="og:description" content="Documentation for Manifolds.jl."/><meta property="twitter:description" content="Documentation for Manifolds.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img class="docs-light-only" src="../assets/logo.png" alt="Manifolds.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.png" alt="Manifolds.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">Manifolds.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">How to...</span><ul><li><a class="tocitem" href="../tutorials/getstarted.html">üöÄ Get Started with <code>Manifolds.jl</code></a></li><li><a class="tocitem" href="../tutorials/working-in-charts.html">work in charts</a></li><li><a class="tocitem" href="../tutorials/hand-gestures.html">perform Hand gesture analysis</a></li><li><a class="tocitem" href="../tutorials/integration.html">integrate on manifolds and handle probability densities</a></li><li><a class="tocitem" href="../tutorials/exploring-curvature.html">explore curvature without coordinates</a></li></ul></li><li><span class="tocitem">Manifolds</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox" checked/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Basic manifolds</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="centeredmatrices.html">Centered matrices</a></li><li><a class="tocitem" href="choleskyspace.html">Cholesky space</a></li><li><a class="tocitem" href="circle.html">Circle</a></li><li><a class="tocitem" href="elliptope.html">Elliptope</a></li><li><a class="tocitem" href="essentialmanifold.html">Essential manifold</a></li><li><a class="tocitem" href="euclidean.html">Euclidean</a></li><li><a class="tocitem" href="fixedrankmatrices.html">Fixed-rank matrices</a></li><li><a class="tocitem" href="flag.html">Flag</a></li><li><a class="tocitem" href="generalizedstiefel.html">Generalized Stiefel</a></li><li><a class="tocitem" href="generalizedgrassmann.html">Generalized Grassmann</a></li><li><a class="tocitem" href="grassmann.html">Grassmann</a></li><li><a class="tocitem" href="hamiltonian.html">Hamiltonian</a></li><li><a class="tocitem" href="hyperbolic.html">Hyperbolic space</a></li><li><a class="tocitem" href="hyperrectangle.html">Hyperrectangle</a></li><li><a class="tocitem" href="lorentz.html">Lorentzian manifold</a></li><li><a class="tocitem" href="multinomialdoublystochastic.html">Multinomial doubly stochastic matrices</a></li><li><a class="tocitem" href="multinomial.html">Multinomial matrices</a></li><li><a class="tocitem" href="multinomialsymmetric.html">Multinomial symmetric matrices</a></li><li><a class="tocitem" href="multinomialsymmetricpositivedefinite.html">Multinomial symmetric positive definite matrices</a></li><li><a class="tocitem" href="oblique.html">Oblique manifold</a></li><li><a class="tocitem" href="probabilitysimplex.html">Probability simplex</a></li><li><a class="tocitem" href="positivenumbers.html">Positive numbers</a></li><li><a class="tocitem" href="projectivespace.html">Projective space</a></li><li class="is-active"><a class="tocitem" href="generalunitary.html">Orthogonal and Unitary Matrices</a><ul class="internal"><li><a class="tocitem" href="#Orthogonal-Matrices"><span>Orthogonal Matrices</span></a></li><li><a class="tocitem" href="#Unitary-Matrices"><span>Unitary Matrices</span></a></li><li><a class="tocitem" href="#generalunitarymatrices"><span>Common functions</span></a></li><li><a class="tocitem" href="#Footnotes-and-References"><span>Footnotes and References</span></a></li></ul></li><li><a class="tocitem" href="rotations.html">Rotations</a></li><li><a class="tocitem" href="shapespace.html">Shape spaces</a></li><li><a class="tocitem" href="skewhermitian.html">Skew-Hermitian matrices</a></li><li><a class="tocitem" href="spectrahedron.html">Spectrahedron</a></li><li><a class="tocitem" href="sphere.html">Sphere</a></li><li><a class="tocitem" href="stiefel.html">Stiefel</a></li><li><a class="tocitem" href="symmetric.html">Symmetric matrices</a></li><li><a class="tocitem" href="symmetricpositivedefinite.html">Symmetric positive definite</a></li><li><a class="tocitem" href="spdfixeddeterminant.html">SPD, fixed determinant</a></li><li><a class="tocitem" href="symmetricpsdfixedrank.html">Symmetric positive semidefinite fixed rank</a></li><li><a class="tocitem" href="symplecticgrassmann.html">Symplectic Grassmann</a></li><li><a class="tocitem" href="symplectic.html">Symplectic matrices</a></li><li><a class="tocitem" href="symplecticstiefel.html">Symplectic Stiefel</a></li><li><a class="tocitem" href="torus.html">Torus</a></li><li><a class="tocitem" href="tucker.html">Tucker</a></li><li><a class="tocitem" href="spheresymmetricmatrices.html">Unit-norm symmetric matrices</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Combined manifolds</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="fiber_bundle.html">Fiber bundle</a></li><li><a class="tocitem" href="graph.html">Graph manifold</a></li><li><a class="tocitem" href="power.html">Power manifold</a></li><li><a class="tocitem" href="product.html">Product manifold</a></li><li><a class="tocitem" href="vector_bundle.html">Vector bundle</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Manifold decorators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="connection.html">Connection manifold</a></li><li><a class="tocitem" href="group.html">Group manifold</a></li><li><a class="tocitem" href="metric.html">Metric manifold</a></li><li><a class="tocitem" href="quotient.html">Quotient manifold</a></li></ul></li></ul></li><li><span class="tocitem">Features on Manifolds</span><ul><li><a class="tocitem" href="../features/atlases.html">Atlases and charts</a></li><li><a class="tocitem" href="../features/differentiation.html">Differentiation</a></li><li><a class="tocitem" href="../features/distributions.html">Distributions</a></li><li><a class="tocitem" href="../features/group_actions.html">Group actions</a></li><li><a class="tocitem" href="../features/integration.html">Integration</a></li><li><a class="tocitem" href="../features/statistics.html">Statistics</a></li><li><a class="tocitem" href="../features/testing.html">Testing</a></li><li><a class="tocitem" href="../features/utilities.html">Utilities</a></li></ul></li><li><span class="tocitem">Miscellanea</span><ul><li><a class="tocitem" href="../misc/about.html">About</a></li><li><a class="tocitem" href="../misc/NEWS.html">Changelog</a></li><li><a class="tocitem" href="../misc/CONTRIBUTING.html">Contributing</a></li><li><a class="tocitem" href="../misc/internals.html">Internals</a></li><li><a class="tocitem" href="../misc/notation.html">Notation</a></li><li><a class="tocitem" href="../misc/references.html">References</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manifolds</a></li><li><a class="is-disabled">Basic manifolds</a></li><li class="is-active"><a href="generalunitary.html">Orthogonal and Unitary Matrices</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="generalunitary.html">Orthogonal and Unitary Matrices</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaManifolds/Manifolds.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/master/docs/src/manifolds/generalunitary.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Orthogonal-and-Unitary-matrices"><a class="docs-heading-anchor" href="#Orthogonal-and-Unitary-matrices">Orthogonal and Unitary matrices</a><a id="Orthogonal-and-Unitary-matrices-1"></a><a class="docs-heading-anchor-permalink" href="#Orthogonal-and-Unitary-matrices" title="Permalink"></a></h1><p>Both <a href="generalunitary.html#Manifolds.OrthogonalMatrices"><code>OrthogonalMatrices</code></a> and <a href="generalunitary.html#Manifolds.UnitaryMatrices"><code>UnitaryMatrices</code></a> are quite similar, as are <a href="rotations.html#Rotations"><code>Rotations</code></a>, as well as unitary matrices with determinant equal to one. So these share a {common implementation}(@ref generalunitarymatrices)</p><h2 id="Orthogonal-Matrices"><a class="docs-heading-anchor" href="#Orthogonal-Matrices">Orthogonal Matrices</a><a id="Orthogonal-Matrices-1"></a><a class="docs-heading-anchor-permalink" href="#Orthogonal-Matrices" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Manifolds.OrthogonalMatrices" href="#Manifolds.OrthogonalMatrices"><code>Manifolds.OrthogonalMatrices</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs"> OrthogonalMatrices{n} = GeneralUnitaryMatrices{n,‚Ñù,AbsoluteDeterminantOneMatrices}</code></pre><p>The manifold of (real) orthogonal matrices <span>$\mathrm{O}(n)$</span>.</p><pre><code class="nohighlight hljs">OrthogonalMatrices(n)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/Orthogonal.jl#L1-L7">source</a></section></article><h2 id="Unitary-Matrices"><a class="docs-heading-anchor" href="#Unitary-Matrices">Unitary Matrices</a><a id="Unitary-Matrices-1"></a><a class="docs-heading-anchor-permalink" href="#Unitary-Matrices" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Manifolds.UnitaryMatrices" href="#Manifolds.UnitaryMatrices"><code>Manifolds.UnitaryMatrices</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">const UnitaryMatrices{n,ùîΩ} = AbstarctUnitaryMatrices{n,ùîΩ,AbsoluteDeterminantOneMatrices}</code></pre><p>The manifold <span>$U(n,ùîΩ)$</span> of <span>$n√ón$</span> complex matrices (when ùîΩ=‚ÑÇ) or quaternionic matrices (when ùîΩ=‚Ñç) such that</p><p><span>$p^{\mathrm{H}}p = \mathrm{I}_n,$</span></p><p>where <span>$\mathrm{I}_n$</span> is the <span>$n√ón$</span> identity matrix. Such matrices <code>p</code> have a property that <span>$\lVert \det(p) \rVert = 1$</span>.</p><p>The tangent spaces are given by</p><p class="math-container">\[    T_pU(n) \coloneqq \bigl\{
    X \big| pY \text{ where } Y \text{ is skew symmetric, i. e. } Y = -Y^{\mathrm{H}}
    \bigr\}\]</p><p>But note that tangent vectors are represented in the Lie algebra, i.e. just using <span>$Y$</span> in the representation above. If you prefer the representation as <code>X</code> you can use the <a href="stiefel.html#Stiefel"><code>Stiefel</code></a><code>(n, n, ‚ÑÇ)</code> manifold.</p><p><strong>Constructor</strong></p><pre><code class="nohighlight hljs">UnitaryMatrices(n, ùîΩ::AbstractNumbers=‚ÑÇ)</code></pre><p>see also <a href="generalunitary.html#Manifolds.OrthogonalMatrices"><code>OrthogonalMatrices</code></a> for the real valued case.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/Unitary.jl#L2-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.rand-Tuple{UnitaryMatrices}" href="#Base.rand-Tuple{UnitaryMatrices}"><code>Base.rand</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rand(::Unitary; vector_at=nothing, œÉ::Real=1.0)</code></pre><p>Generate a random point on the <a href="generalunitary.html#Manifolds.UnitaryMatrices"><code>UnitaryMatrices</code></a> manifold, if <code>vector_at</code> is nothing, by computing the QR decomposition of a <span>$n√óx$</span> matrix.</p><p>Generate a tangent vector at <code>vector_at</code> by projecting a normally distributed matrix onto the tangent space.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/Unitary.jl#L134-L143">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ManifoldDiff.riemannian_Hessian-Tuple{UnitaryMatrices, Vararg{Any, 4}}" href="#ManifoldDiff.riemannian_Hessian-Tuple{UnitaryMatrices, Vararg{Any, 4}}"><code>ManifoldDiff.riemannian_Hessian</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">riemannian_Hessian(M::UnitaryMatrices, p, G, H, X)</code></pre><p>The Riemannian Hessian can be computed by adopting Eq. (5.6) [<a href="../misc/references.html#Nguyen:2023">Ngu23</a>], so very similar to the complex Stiefel manifold. The only difference is, that here the tangent vectors are stored in the Lie algebra, i.e. the update direction is actually <span>$pX$</span> instead of just <span>$X$</span> (in Stiefel). and that means the inverse has to be appliead to the (Euclidean) Hessian to map it into the Lie algebra.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/Unitary.jl#L179-L188">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ManifoldsBase.Weingarten-Tuple{UnitaryMatrices, Any, Any, Any}" href="#ManifoldsBase.Weingarten-Tuple{UnitaryMatrices, Any, Any, Any}"><code>ManifoldsBase.Weingarten</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Weingarten(M::UnitaryMatrices, p, X, V)</code></pre><p>Compute the Weingarten map <span>$\mathcal W_p$</span> at <code>p</code> on the <a href="stiefel.html#Stiefel"><code>Stiefel</code></a> <code>M</code> with respect to the tangent vector <span>$X \in T_p\mathcal M$</span> and the normal vector <span>$V \in N_p\mathcal M$</span>.</p><p>The formula is due to [<a href="../misc/references.html#AbsilMahonyTrumpf:2013">AMT13</a>] given by</p><p class="math-container">\[\mathcal W_p(X,V) = -\frac{1}{2}p\bigl(V^{\mathrm{H}}X - X^\mathrm{H}V\bigr)\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/Unitary.jl#L196-L207">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ManifoldsBase.manifold_dimension-Tuple{UnitaryMatrices{&lt;:Any, ‚ÑÇ}}" href="#ManifoldsBase.manifold_dimension-Tuple{UnitaryMatrices{&lt;:Any, ‚ÑÇ}}"><code>ManifoldsBase.manifold_dimension</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">manifold_dimension(M::UnitaryMatrices{n,‚ÑÇ}) where {n}</code></pre><p>Return the dimension of the manifold unitary matrices.</p><p class="math-container">\[\dim_{\mathrm{U}(n)} = n^2.\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/Unitary.jl#L84-L91">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ManifoldsBase.manifold_dimension-Tuple{UnitaryMatrices{&lt;:Any, ‚Ñç}}" href="#ManifoldsBase.manifold_dimension-Tuple{UnitaryMatrices{&lt;:Any, ‚Ñç}}"><code>ManifoldsBase.manifold_dimension</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">manifold_dimension(M::UnitaryMatrices{&lt;:Any,‚Ñç})</code></pre><p>Return the dimension of the manifold unitary matrices.</p><p class="math-container">\[\dim_{\mathrm{U}(n, ‚Ñç)} = n(2n+1).\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/Unitary.jl#L96-L103">source</a></section></article><h2 id="generalunitarymatrices"><a class="docs-heading-anchor" href="#generalunitarymatrices">Common functions</a><a id="generalunitarymatrices-1"></a><a class="docs-heading-anchor-permalink" href="#generalunitarymatrices" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Manifolds.AbsoluteDeterminantOneMatrices" href="#Manifolds.AbsoluteDeterminantOneMatrices"><code>Manifolds.AbsoluteDeterminantOneMatrices</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbsoluteDeterminantOneMatrices &lt;: AbstractMatrixType</code></pre><p>A type to indicate that we require (orthogonal / unitary) matrices with normed determinant, i.e. that the absolute value of the determinant is 1.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L16-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Manifolds.AbstractMatrixType" href="#Manifolds.AbstractMatrixType"><code>Manifolds.AbstractMatrixType</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractMatrixType</code></pre><p>A plain type to distinguish different types of matrices, for example <a href="generalunitary.html#Manifolds.DeterminantOneMatrices"><code>DeterminantOneMatrices</code></a> and <a href="generalunitary.html#Manifolds.AbsoluteDeterminantOneMatrices"><code>AbsoluteDeterminantOneMatrices</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Manifolds.DeterminantOneMatrices" href="#Manifolds.DeterminantOneMatrices"><code>Manifolds.DeterminantOneMatrices</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DeterminantOneMatrices &lt;: AbstractMatrixType</code></pre><p>A type to indicate that we require special (orthogonal / unitary) matrices, i.e. of determinant 1.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L9-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Manifolds.GeneralUnitaryMatrices" href="#Manifolds.GeneralUnitaryMatrices"><code>Manifolds.GeneralUnitaryMatrices</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">GeneralUnitaryMatrices{T,ùîΩ,S&lt;:AbstractMatrixType} &lt;: AbstractDecoratorManifold</code></pre><p>A common parametric type for matrices with a unitary property of size <span>$n√ón$</span> over the field <span>$ùîΩ$</span> which additionally have the <code>AbstractMatrixType</code>, e.g. are <code>DeterminantOneMatrices</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L24-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.exp-Tuple{Manifolds.GeneralUnitaryMatrices, Any, Any}" href="#Base.exp-Tuple{Manifolds.GeneralUnitaryMatrices, Any, Any}"><code>Base.exp</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">exp(M::Rotations, p, X)
exp(M::OrthogonalMatrices, p, X)
exp(M::UnitaryMatrices, p, X)</code></pre><p>Compute the exponential map, that is, since <span>$X$</span> is represented in the Lie algebra,</p><pre><code class="nohighlight hljs">exp_p(X) = p\mathrm{e}^X</code></pre><p>For different sizes, like <span>$n=2,3,4$</span>, there are specialized implementations.</p><p>The algorithm used is a more numerically stable form of those proposed in [<a href="../misc/references.html#GallierXu:2002">GX02</a>] and [<a href="../misc/references.html#AndricaRohan:2013">AR13</a>].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L207-L222">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.log-Tuple{Manifolds.GeneralUnitaryMatrices, Any, Any}" href="#Base.log-Tuple{Manifolds.GeneralUnitaryMatrices, Any, Any}"><code>Base.log</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">log(M::Rotations, p, X)
log(M::OrthogonalMatrices, p, X)
log(M::UnitaryMatrices, p, X)</code></pre><p>Compute the logarithmic map, that is, since the resulting <span>$X$</span> is represented in the Lie algebra,</p><pre><code class="nohighlight hljs">log_p q = \log(p^{\mathrm{H}q)</code></pre><p>which is projected onto the skew symmetric matrices for numerical stability.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L707-L718">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.log-Tuple{Manifolds.GeneralUnitaryMatrices{&lt;:Any, ‚Ñù}, Vararg{Any}}" href="#Base.log-Tuple{Manifolds.GeneralUnitaryMatrices{&lt;:Any, ‚Ñù}, Vararg{Any}}"><code>Base.log</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">log(M::Rotations, p, q)</code></pre><p>Compute the logarithmic map on the <a href="rotations.html#Rotations"><code>Rotations</code></a> manifold <code>M</code> which is given by</p><p class="math-container">\[\log_p q = \operatorname{log}(p^{\mathrm{T}}q)\]</p><p>where <span>$\operatorname{Log}$</span> denotes the matrix logarithm. For numerical stability, the result is projected onto the set of skew symmetric matrices.</p><p>For antipodal rotations the function returns deterministically one of the tangent vectors that point at <code>q</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L721-L736">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Manifolds.cos_angles_4d_rotation_matrix-Tuple{Any}" href="#Manifolds.cos_angles_4d_rotation_matrix-Tuple{Any}"><code>Manifolds.cos_angles_4d_rotation_matrix</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">cos_angles_4d_rotation_matrix(R)</code></pre><p>4D rotations can be described by two orthogonal planes that are unchanged by the action of the rotation (vectors within a plane rotate only within the plane). The cosines of the two angles <span>$Œ±,Œ≤$</span> of rotation about these planes may be obtained from the distinct real parts of the eigenvalues of the rotation matrix. This function computes these more efficiently by solving the system</p><p class="math-container">\[\begin{aligned}
\cos Œ± + \cos Œ≤ &amp;= \frac{1}{2} \operatorname{tr}(R)\\
\cos Œ± \cos Œ≤ &amp;= \frac{1}{8} \operatorname{tr}(R)^2
                 - \frac{1}{16} \operatorname{tr}((R - R^T)^2) - 1.
\end{aligned}\]</p><p>By convention, the returned values are sorted in decreasing order. See also <a href="rotations.html#Manifolds.angles_4d_skew_sym_matrix-Tuple{Any}"><code>angles_4d_skew_sym_matrix</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L155-L174">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Manifolds.manifold_volume-Tuple{Manifolds.GeneralUnitaryMatrices{&lt;:Any, ‚ÑÇ, Manifolds.DeterminantOneMatrices}}" href="#Manifolds.manifold_volume-Tuple{Manifolds.GeneralUnitaryMatrices{&lt;:Any, ‚ÑÇ, Manifolds.DeterminantOneMatrices}}"><code>Manifolds.manifold_volume</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">manifold_volume(::GeneralUnitaryMatrices{&lt;:Any,‚ÑÇ,DeterminantOneMatrices})</code></pre><p>Volume of the manifold of complex general unitary matrices of determinant one. The formula reads [<a href="../misc/references.html#BoyaSudarshanTilma:2003">BST03</a>]</p><p class="math-container">\[\sqrt{n 2^{n-1}} œÄ^{(n-1)(n+2)/2} \prod_{k=1}^{n-1}\frac{1}{k!}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L920-L929">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Manifolds.manifold_volume-Tuple{Manifolds.GeneralUnitaryMatrices{&lt;:Any, ‚Ñù, Manifolds.AbsoluteDeterminantOneMatrices}}" href="#Manifolds.manifold_volume-Tuple{Manifolds.GeneralUnitaryMatrices{&lt;:Any, ‚Ñù, Manifolds.AbsoluteDeterminantOneMatrices}}"><code>Manifolds.manifold_volume</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">manifold_volume(::GeneralUnitaryMatrices{&lt;:Any,‚Ñù,AbsoluteDeterminantOneMatrices})</code></pre><p>Volume of the manifold of real orthogonal matrices of absolute determinant one. The formula reads [<a href="../misc/references.html#BoyaSudarshanTilma:2003">BST03</a>]:</p><p class="math-container">\[\begin{cases}
\frac{2^{k}(2\pi)^{k^2}}{\prod_{s=1}^{k-1} (2s)!} &amp; \text{ if } n = 2k \\
\frac{2^{k+1}(2\pi)^{k(k+1)}}{\prod_{s=1}^{k-1} (2s+1)!} &amp; \text{ if } n = 2k+1
\end{cases}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L845-L857">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Manifolds.manifold_volume-Tuple{Rotations}" href="#Manifolds.manifold_volume-Tuple{Rotations}"><code>Manifolds.manifold_volume</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">manifold_volume(::GeneralUnitaryMatrices{&lt;:Any,‚Ñù,DeterminantOneMatrices})</code></pre><p>Volume of the manifold of real orthogonal matrices of determinant one. The formula reads [<a href="../misc/references.html#BoyaSudarshanTilma:2003">BST03</a>]:</p><p class="math-container">\[\begin{cases}
2 &amp; \text{ if } n = 0 \\
\frac{2^{k-1/2}(2\pi)^{k^2}}{\prod_{s=1}^{k-1} (2s)!} &amp; \text{ if } n = 2k+2 \\
\frac{2^{k+1/2}(2\pi)^{k(k+1)}}{\prod_{s=1}^{k-1} (2s+1)!} &amp; \text{ if } n = 2k+1
\end{cases}\]</p><p>It differs from the paper by a factor of <code>sqrt(2)</code> due to a different choice of normalization.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L862-L878">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Manifolds.manifold_volume-Tuple{UnitaryMatrices{&lt;:Any, ‚ÑÇ}}" href="#Manifolds.manifold_volume-Tuple{UnitaryMatrices{&lt;:Any, ‚ÑÇ}}"><code>Manifolds.manifold_volume</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">manifold_volume(::GeneralUnitaryMatrices{&lt;:Any,‚ÑÇ,AbsoluteDeterminantOneMatrices})</code></pre><p>Volume of the manifold of complex general unitary matrices of absolute determinant one. The formula reads [<a href="../misc/references.html#BoyaSudarshanTilma:2003">BST03</a>]</p><p class="math-container">\[\sqrt{n 2^{n+1}} œÄ^{n(n+1)/2} \prod_{k=1}^{n-1}\frac{1}{k!}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L900-L909">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Manifolds.volume_density-Tuple{Manifolds.GeneralUnitaryMatrices{&lt;:Any, ‚Ñù}, Any, Any}" href="#Manifolds.volume_density-Tuple{Manifolds.GeneralUnitaryMatrices{&lt;:Any, ‚Ñù}, Any, Any}"><code>Manifolds.volume_density</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">volume_density(M::GeneralUnitaryMatrices{&lt;:Any,‚Ñù}, p, X)</code></pre><p>Compute volume density function of a sphere, i.e. determinant of the differential of exponential map <code>exp(M, p, X)</code>. It is derived from Eq. (4.1) and Corollary 4.4 in [<a href="../misc/references.html#ChevallierLiLuDunson:2022">CLLD22</a>]. See also Theorem 4.1 in [<a href="../misc/references.html#FalorsideHaanDavidsonForre:2019">FdHDF19</a>], (note that it uses a different convention).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L1064-L1071">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Manifolds.volume_density-Tuple{Manifolds.GeneralUnitaryMatrices{ManifoldsBase.TypeParameter{Tuple{2}}, ‚Ñù}, Any, Any}" href="#Manifolds.volume_density-Tuple{Manifolds.GeneralUnitaryMatrices{ManifoldsBase.TypeParameter{Tuple{2}}, ‚Ñù}, Any, Any}"><code>Manifolds.volume_density</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">volume_density(M::GeneralUnitaryMatrices{TypeParameter{Tuple{2}},‚Ñù}, p, X)</code></pre><p>Volume density on O(2)/SO(2) is equal to 1.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L1111-L1115">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Manifolds.volume_density-Tuple{Manifolds.GeneralUnitaryMatrices{ManifoldsBase.TypeParameter{Tuple{3}}, ‚Ñù}, Any, Any}" href="#Manifolds.volume_density-Tuple{Manifolds.GeneralUnitaryMatrices{ManifoldsBase.TypeParameter{Tuple{3}}, ‚Ñù}, Any, Any}"><code>Manifolds.volume_density</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">volume_density(M::GeneralUnitaryMatrices{TypeParameter{Tuple{3}},‚Ñù}, p, X)</code></pre><p>Compute the volume density on O(3)/SO(3). The formula reads [<a href="../misc/references.html#FalorsideHaanDavidsonForre:2019">FdHDF19</a>]</p><p class="math-container">\[\frac{1-1\cos(\sqrt{2}\lVert X \rVert)}{\lVert X \rVert^2}.\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L1093-L1101">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ManifoldsBase.check_point-Union{Tuple{ùîΩ}, Tuple{Manifolds.GeneralUnitaryMatrices{&lt;:Any, ùîΩ, Manifolds.DeterminantOneMatrices}, Any}} where ùîΩ" href="#ManifoldsBase.check_point-Union{Tuple{ùîΩ}, Tuple{Manifolds.GeneralUnitaryMatrices{&lt;:Any, ùîΩ, Manifolds.DeterminantOneMatrices}, Any}} where ùîΩ"><code>ManifoldsBase.check_point</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">check_point(M::Rotations, p; kwargs...)</code></pre><p>Check whether <code>p</code> is a valid point on the <a href="generalunitary.html#Manifolds.UnitaryMatrices"><code>UnitaryMatrices</code></a> <code>M</code>, i.e. that <span>$p$</span> has a determinant of absolute value one, i.e. that <span>$p^{\mathrm{H}}p$</span></p><p>The tolerance for the last test can be set using the <code>kwargs...</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L78-L85">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ManifoldsBase.check_point-Union{Tuple{ùîΩ}, Tuple{UnitaryMatrices{&lt;:Any, ùîΩ}, Any}} where ùîΩ" href="#ManifoldsBase.check_point-Union{Tuple{ùîΩ}, Tuple{UnitaryMatrices{&lt;:Any, ùîΩ}, Any}} where ùîΩ"><code>ManifoldsBase.check_point</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">check_point(M::UnitaryMatrices, p; kwargs...)
check_point(M::OrthogonalMatrices, p; kwargs...)
check_point(M::GeneralUnitaryMatrices, p; kwargs...)</code></pre><p>Check whether <code>p</code> is a valid point on the <a href="generalunitary.html#Manifolds.UnitaryMatrices"><code>UnitaryMatrices</code></a> or [<code>OrthogonalMatrices</code>] <code>M</code>, i.e. that <span>$p$</span> has a determinant of absolute value one</p><p>The tolerance for the last test can be set using the <code>kwargs...</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L48-L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ManifoldsBase.check_vector-Union{Tuple{ùîΩ}, Tuple{Manifolds.GeneralUnitaryMatrices{&lt;:Any, ùîΩ}, Any, Any}} where ùîΩ" href="#ManifoldsBase.check_vector-Union{Tuple{ùîΩ}, Tuple{Manifolds.GeneralUnitaryMatrices{&lt;:Any, ùîΩ}, Any, Any}} where ùîΩ"><code>ManifoldsBase.check_vector</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">check_vector(M::UnitaryMatrices, p, X; kwargs... )
check_vector(M::OrthogonalMatrices, p, X; kwargs... )
check_vector(M::Rotations, p, X; kwargs... )
check_vector(M::GeneralUnitaryMatrices, p, X; kwargs... )</code></pre><p>Check whether <code>X</code> is a tangent vector to <code>p</code> on the <a href="generalunitary.html#Manifolds.UnitaryMatrices"><code>UnitaryMatrices</code></a> space <code>M</code>, i.e. after <a href="centeredmatrices.html#ManifoldsBase.check_point-Union{Tuple{T}, Tuple{CenteredMatrices, T}} where T"><code>check_point</code></a><code>(M,p)</code>, <code>X</code> has to be skew symmetric (Hermitian) and orthogonal to <code>p</code>.</p><p>The tolerance for the last test can be set using the <code>kwargs...</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L138-L149">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ManifoldsBase.embed-Tuple{Manifolds.GeneralUnitaryMatrices, Any, Any}" href="#ManifoldsBase.embed-Tuple{Manifolds.GeneralUnitaryMatrices, Any, Any}"><code>ManifoldsBase.embed</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">embed(M::GeneralUnitaryMatrices, p, X)</code></pre><p>Embed the tangent vector <code>X</code> at point <code>p</code> in <code>M</code> from its Lie algebra representation (set of skew matrices) into the Riemannian submanifold representation</p><p>The formula reads</p><p class="math-container">\[X_{\text{embedded}} = p * X\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L189-L200">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ManifoldsBase.get_coordinates-Tuple{Manifolds.GeneralUnitaryMatrices{&lt;:Any, ‚Ñù}, Vararg{Any}}" href="#ManifoldsBase.get_coordinates-Tuple{Manifolds.GeneralUnitaryMatrices{&lt;:Any, ‚Ñù}, Vararg{Any}}"><code>ManifoldsBase.get_coordinates</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_coordinates(M::Rotations, p, X)
get_coordinates(M::OrthogonalMatrices, p, X)
get_coordinates(M::UnitaryMatrices, p, X)</code></pre><p>Extract the unique tangent vector components <span>$X^i$</span> at point <code>p</code> on <a href="rotations.html#Rotations"><code>Rotations</code></a> <span>$\mathrm{SO}(n)$</span> from the matrix representation <code>X</code> of the tangent vector.</p><p>The basis on the Lie algebra <span>$ùî∞ùî¨(n)$</span> is chosen such that for <span>$\mathrm{SO}(2)$</span>, <span>$X^1 = Œ∏ = X_{21}$</span> is the angle of rotation, and for <span>$\mathrm{SO}(3)$</span>, <span>$(X^1, X^2, X^3) = (X_{32}, X_{13}, X_{21}) = Œ∏ u$</span> is the angular velocity and axis-angle representation, where <span>$u$</span> is the unit vector along the axis of rotation.</p><p>For <span>$\mathrm{SO}(n)$</span> where <span>$n ‚â• 4$</span>, the additional elements of <span>$X^i$</span> are <span>$X^{j (j - 3)/2 + k + 1} = X_{jk}$</span>, for <span>$j ‚àà [4,n], k ‚àà [1,j)$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L329-L346">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ManifoldsBase.get_embedding-Union{Tuple{Manifolds.GeneralUnitaryMatrices{ManifoldsBase.TypeParameter{Tuple{n}}, ùîΩ}}, Tuple{ùîΩ}, Tuple{n}} where {n, ùîΩ}" href="#ManifoldsBase.get_embedding-Union{Tuple{Manifolds.GeneralUnitaryMatrices{ManifoldsBase.TypeParameter{Tuple{n}}, ùîΩ}}, Tuple{ùîΩ}, Tuple{n}} where {n, ùîΩ}"><code>ManifoldsBase.get_embedding</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_embedding(M::OrthogonalMatrices)
get_embedding(M::Rotations)
get_embedding(M::UnitaryMatrices)</code></pre><p>Return the embedding, i.e. The <span>$\mathbb F^{n√ón}$</span>, where <span>$\mathbb F = \mathbb R$</span> for the first two and <span>$\mathbb F = \mathbb C$</span> for the unitary matrices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L459-L466">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ManifoldsBase.get_vector-Tuple{Manifolds.GeneralUnitaryMatrices{&lt;:Any, ‚Ñù}, Vararg{Any}}" href="#ManifoldsBase.get_vector-Tuple{Manifolds.GeneralUnitaryMatrices{&lt;:Any, ‚Ñù}, Vararg{Any}}"><code>ManifoldsBase.get_vector</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_vector(M::OrthogonalMatrices, p, X‚Å±, B::DefaultOrthogonalBasis)
get_vector(M::Rotations, p, X‚Å±, B::DefaultOrthogonalBasis)</code></pre><p>Convert the unique tangent vector components <code>X‚Å±</code> at point <code>p</code> on <a href="rotations.html#Rotations"><code>Rotations</code></a> or <a href="generalunitary.html#Manifolds.OrthogonalMatrices"><code>OrthogonalMatrices</code></a> to the matrix representation <span>$X$</span> of the tangent vector. See <a href="circle.html#ManifoldsBase.get_coordinates-Tuple{Circle{‚ÑÇ}, Any, Any, DefaultOrthonormalBasis{&lt;:Any, TangentSpaceType}}"><code>get_coordinates</code></a> for the conventions used.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L475-L483">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ManifoldsBase.injectivity_radius-Tuple{Manifolds.GeneralUnitaryMatrices{&lt;:Any, ‚ÑÇ, Manifolds.DeterminantOneMatrices}}" href="#ManifoldsBase.injectivity_radius-Tuple{Manifolds.GeneralUnitaryMatrices{&lt;:Any, ‚ÑÇ, Manifolds.DeterminantOneMatrices}}"><code>ManifoldsBase.injectivity_radius</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">injectivity_radius(G::GeneralUnitaryMatrices{&lt;:Any,‚ÑÇ,DeterminantOneMatrices})</code></pre><p>Return the injectivity radius for general complex unitary matrix manifolds, where the determinant is <span>$+1$</span>, which is<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup></p><p class="math-container">\[    \operatorname{inj}_{\mathrm{SU}(n)} = œÄ \sqrt{2}.\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L645-L654">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ManifoldsBase.injectivity_radius-Tuple{Manifolds.GeneralUnitaryMatrices}" href="#ManifoldsBase.injectivity_radius-Tuple{Manifolds.GeneralUnitaryMatrices}"><code>ManifoldsBase.injectivity_radius</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">injectivity_radius(G::GeneraliUnitaryMatrices)</code></pre><p>Return the injectivity radius for general unitary matrix manifolds, which is<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup></p><p class="math-container">\[    \operatorname{inj}_{\mathrm{U}(n)} = œÄ.\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L634-L642">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ManifoldsBase.injectivity_radius-Union{Tuple{Manifolds.GeneralUnitaryMatrices{ManifoldsBase.TypeParameter{Tuple{n}}, ‚Ñù}}, Tuple{n}} where n" href="#ManifoldsBase.injectivity_radius-Union{Tuple{Manifolds.GeneralUnitaryMatrices{ManifoldsBase.TypeParameter{Tuple{n}}, ‚Ñù}}, Tuple{n}} where n"><code>ManifoldsBase.injectivity_radius</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">injectivity_radius(G::SpecialOrthogonal)
injectivity_radius(G::Orthogonal)
injectivity_radius(M::Rotations)
injectivity_radius(M::Rotations, ::ExponentialRetraction)</code></pre><p>Return the radius of injectivity on the <a href="rotations.html#Rotations"><code>Rotations</code></a> manifold <code>M</code>, which is <span>$œÄ\sqrt{2}$</span>. <sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L659-L670">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ManifoldsBase.is_flat-Tuple{Manifolds.GeneralUnitaryMatrices}" href="#ManifoldsBase.is_flat-Tuple{Manifolds.GeneralUnitaryMatrices}"><code>ManifoldsBase.is_flat</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">is_flat(M::GeneralUnitaryMatrices)</code></pre><p>Return true if <a href="generalunitary.html#Manifolds.GeneralUnitaryMatrices"><code>GeneralUnitaryMatrices</code></a> <code>M</code> is SO(2) or U(1) and false otherwise.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L692-L696">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ManifoldsBase.manifold_dimension-Tuple{Manifolds.GeneralUnitaryMatrices{&lt;:Any, ‚ÑÇ, Manifolds.DeterminantOneMatrices}}" href="#ManifoldsBase.manifold_dimension-Tuple{Manifolds.GeneralUnitaryMatrices{&lt;:Any, ‚ÑÇ, Manifolds.DeterminantOneMatrices}}"><code>ManifoldsBase.manifold_dimension</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">manifold_dimension(M::GeneralUnitaryMatrices{&lt;:Any,‚ÑÇ,DeterminantOneMatrices})</code></pre><p>Return the dimension of the manifold of special unitary matrices.</p><p class="math-container">\[\dim_{\mathrm{SU}(n)} = n^2-1.\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L832-L839">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ManifoldsBase.manifold_dimension-Tuple{Manifolds.GeneralUnitaryMatrices{&lt;:Any, ‚Ñù}}" href="#ManifoldsBase.manifold_dimension-Tuple{Manifolds.GeneralUnitaryMatrices{&lt;:Any, ‚Ñù}}"><code>ManifoldsBase.manifold_dimension</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">manifold_dimension(M::Rotations)
manifold_dimension(M::OrthogonalMatrices)</code></pre><p>Return the dimension of the manifold orthogonal matrices and of the manifold of rotations</p><p class="math-container">\[\dim_{\mathrm{O}(n)} = \dim_{\mathrm{SO}(n)} = \frac{n(n-1)}{2}.\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L819-L827">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ManifoldsBase.project-Tuple{Manifolds.GeneralUnitaryMatrices, Any, Any}" href="#ManifoldsBase.project-Tuple{Manifolds.GeneralUnitaryMatrices, Any, Any}"><code>ManifoldsBase.project</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">project(M::OrthogonalMatrices, p, X)
project(M::Rotations, p, X)
project(M::UnitaryMatrices, p, X)</code></pre><p>Orthogonally project the tangent vector <span>$X ‚àà ùîΩ^{n√ón}$</span>, <span>$\mathbb F ‚àà \{\mathbb R, \mathbb C\}$</span> to the tangent space of <code>M</code> at <code>p</code>, and change the representer to use the corresponding Lie algebra, i.e. we compute</p><p class="math-container">\[    \operatorname{proj}_p(X) = \frac{p^{\mathrm{H}} X - (p^{\mathrm{H}} X)^{\mathrm{H}}}{2},\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L980-L992">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ManifoldsBase.project-Union{Tuple{ùîΩ}, Tuple{UnitaryMatrices{&lt;:Any, ùîΩ}, Any}} where ùîΩ" href="#ManifoldsBase.project-Union{Tuple{ùîΩ}, Tuple{UnitaryMatrices{&lt;:Any, ùîΩ}, Any}} where ùîΩ"><code>ManifoldsBase.project</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs"> project(G::UnitaryMatrices, p)
 project(G::OrthogonalMatrices, p)</code></pre><p>Project the point <span>$p ‚àà ùîΩ^{n√ón}$</span> to the nearest point in <span>$\mathrm{U}(n,ùîΩ)=$</span><a href="group.html#Manifolds.Unitary"><code>Unitary(n,ùîΩ)</code></a> under the Frobenius norm. If <span>$p = U S V^\mathrm{H}$</span> is the singular value decomposition of <span>$p$</span>, then the projection is</p><p class="math-container">\[  \operatorname{proj}_{\mathrm{U}(n,ùîΩ)} \colon p ‚Ü¶ U V^\mathrm{H}.\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L955-L967">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ManifoldsBase.retract-Tuple{Manifolds.GeneralUnitaryMatrices, Any, Any, PolarRetraction}" href="#ManifoldsBase.retract-Tuple{Manifolds.GeneralUnitaryMatrices, Any, Any, PolarRetraction}"><code>ManifoldsBase.retract</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">retract(M::Rotations, p, X, ::PolarRetraction)
retract(M::OrthogonalMatrices, p, X, ::PolarRetraction)</code></pre><p>Compute the SVD-based retraction on the <a href="rotations.html#Rotations"><code>Rotations</code></a> and <a href="generalunitary.html#Manifolds.OrthogonalMatrices"><code>OrthogonalMatrices</code></a> <code>M</code> from <code>p</code> in direction <code>X</code> (as an element of the Lie group) and is a second-order approximation of the exponential map. Let</p><p class="math-container">\[USV = p + pX\]</p><p>be the singular value decomposition, then the formula reads</p><p class="math-container">\[\operatorname{retr}_p X = UV^\mathrm{T}.\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L1001-L1018">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ManifoldsBase.retract-Tuple{Manifolds.GeneralUnitaryMatrices, Any, Any, QRRetraction}" href="#ManifoldsBase.retract-Tuple{Manifolds.GeneralUnitaryMatrices, Any, Any, QRRetraction}"><code>ManifoldsBase.retract</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">retract(M::Rotations, p, X, ::QRRetraction)
retract(M::OrthogonalMatrices, p. X, ::QRRetraction)</code></pre><p>Compute the QR-based retraction on the <a href="rotations.html#Rotations"><code>Rotations</code></a> and <a href="generalunitary.html#Manifolds.OrthogonalMatrices"><code>OrthogonalMatrices</code></a> <code>M</code> from <code>p</code> in direction <code>X</code> (as an element of the Lie group), which is a first-order approximation of the exponential map.</p><p>This is also the default retraction on these manifolds.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L1021-L1029">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ManifoldsBase.riemann_tensor-Tuple{Manifolds.GeneralUnitaryMatrices, Vararg{Any, 4}}" href="#ManifoldsBase.riemann_tensor-Tuple{Manifolds.GeneralUnitaryMatrices, Vararg{Any, 4}}"><code>ManifoldsBase.riemann_tensor</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">riemann_tensor(::GeneralUnitaryMatrices, p, X, Y, Z)</code></pre><p>Compute the value of Riemann tensor on the <a href="generalunitary.html#Manifolds.GeneralUnitaryMatrices"><code>GeneralUnitaryMatrices</code></a> manifold. The formula reads [<a href="../misc/references.html#Rentmeesters:2011">Ren11</a>] <span>$R(X,Y)Z=\frac{1}{4}[Z, [X, Y]]$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L1050-L1055">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Statistics.mean-Tuple{Manifolds.GeneralUnitaryMatrices{&lt;:Any, ‚Ñù}, Any}" href="#Statistics.mean-Tuple{Manifolds.GeneralUnitaryMatrices{&lt;:Any, ‚Ñù}, Any}"><code>Statistics.mean</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">mean(
    M::Rotations,
    x::AbstractVector,
    [w::AbstractWeights,]
    method = GeodesicInterpolationWithinRadius(œÄ/2/‚àö2);
    kwargs...,
)</code></pre><p>Compute the Riemannian <a href="../features/statistics.html#Statistics.mean-Tuple{AbstractManifold, Vararg{Any}}"><code>mean</code></a> of <code>x</code> using <a href="https://juliamanifolds.github.io/ManifoldsBase.jl/stable/functions/#ManifoldsBase.GeodesicInterpolationWithinRadius"><code>GeodesicInterpolationWithinRadius</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/bd0264f5c0e52853787083e281fd3b0e88793812/src/manifolds/GeneralUnitaryMatrices.jl#L941-L952">source</a></section></article><h2 id="Footnotes-and-References"><a class="docs-heading-anchor" href="#Footnotes-and-References">Footnotes and References</a><a id="Footnotes-and-References-1"></a><a class="docs-heading-anchor-permalink" href="#Footnotes-and-References" title="Permalink"></a></h2><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a><blockquote><p>For a derivation of the injectivity radius, see <a href="https://sethaxen.com/blog/2023/02/the-injectivity-radii-of-the-unitary-groups/">sethaxen.com/blog/2023/02/the-injectivity-radii-of-the-unitary-groups/</a>.</p></blockquote></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="projectivespace.html">¬´ Projective space</a><a class="docs-footer-nextpage" href="rotations.html">Rotations ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Tuesday 7 May 2024 11:52">Tuesday 7 May 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
