using Manifolds, Test

# Approximate derivative of f at x
# https://en.wikipedia.org/wiki/Finite_difference_coefficient
function finite_difference(f::Function, x::Float64, h::Float64; order=1::Int64)#={{{=#
    if order == 1
        return (
            (1 / 12) * f(x - 2 * h) +
            (-2 / 3) * f(x - 1 * h) +
            (2 / 3) * f(x + 1 * h) +
            (-1 / 12) * f(x + 2 * h)
        ) / h
    elseif order == 2
        return (
            (-1 / 12) * f(x - 2 * h) +
            (4 / 3) * f(x - 1 * h) +
            (-5 / 2) * f(x) +
            (4 / 3) * f(x + 1 * h) +
            (-1 / 12) * f(x + 2 * h)
        ) / h^2
    elseif order == 3
        return (
            (1 / 8) * f(x - 3 * h) +
            (-1) * f(x - 2 * h) +
            (13 / 8) * f(x - 1 * h) +
            (-13 / 8) * f(x + 1 * h) +
            (1) * f(x + 2 * h) +
            (-1 / 8) * f(x + 3 * h)
        ) / h^3
    end
end#=}}}=#

# Manifolds to test
Ms =  [
    Segre{ℝ, (10,)}(),
    Segre{ℝ, (2,)}(),
    Segre{ℝ, (7,)}(),
    Segre{ℝ, (7, 2)}(),
    Segre{ℝ, (9, 8)}(),
    Segre{ℝ, (2, 2)}(),
    Segre{ℝ, (7, 9, 9)}(),
    Segre{ℝ, (10, 7, 3)}(),
    Segre{ℝ, (5, 6, 3)}(),
    Segre{ℝ, (9, 3, 6, 6)}(),
    Segre{ℝ, (5, 4, 10, 10)}(),
    Segre{ℝ, (10, 6, 3, 4)}(),
    MetricManifold(Segre{ℝ, (10,)}(), WarpedMetric{1.2025837056880606}()),
    MetricManifold(Segre{ℝ, (9,)}(), WarpedMetric{1.1157384770946328}()),
    MetricManifold(Segre{ℝ, (4,)}(), WarpedMetric{1.108519951945247}()),
    MetricManifold(Segre{ℝ, (2, 9)}(), WarpedMetric{1.1302422072971439}()),
    MetricManifold(Segre{ℝ, (4, 7)}(), WarpedMetric{1.4990018903833313}()),
    MetricManifold(Segre{ℝ, (2, 2)}(), WarpedMetric{1.1978398577942357}()),
    MetricManifold(Segre{ℝ, (9, 6, 10)}(), WarpedMetric{1.4545138169484464}()),
    MetricManifold(Segre{ℝ, (9, 9, 2)}(), WarpedMetric{0.886048645869852}()),
    MetricManifold(Segre{ℝ, (10, 10, 7)}(), WarpedMetric{1.2810851738110494}()),
    MetricManifold(Segre{ℝ, (9, 3, 8, 10)}(), WarpedMetric{1.396673190458706}()),
    MetricManifold(Segre{ℝ, (10, 9, 7, 6)}(), WarpedMetric{1.294280190668267}()),
    MetricManifold(Segre{ℝ, (7, 2, 8, 8)}(), WarpedMetric{1.2374529454448573}())
    ]

# ps[i] is a point on Ms[i]
ps = [
    [[0.4679314536763416], [-0.317396495862958, 0.09740239786995583, -0.03435690079466174, -0.507098294482249, -0.3456993992812562, 0.03370180478069075, 0.12197903860091835, -0.19063489706041362, -0.6772451984545433, -0.030292993087650443]],
    [[0.3298310216639224], [0.2514005595224343, -0.96788313275509]],
    [[0.42312947328046224], [0.33560958022362747, -0.7750899034491946, 0.23449838016304786, 0.36554747855051023, -0.28711573724812484, -0.014134328816621394, 0.12390389837644036]],
    [[1.5024828708442504], [-0.20674979086955983, 0.006156775886150006, -0.3570727686996312, -0.02472149296318015, -0.8820637035264094, -0.19877726490312608, 0.10749756092041758], [0.13573491868289245, 0.9907451901726038]],
    [[0.3013653757380563], [0.5977968840579448, -0.22702223761000456, 0.5118227538696087, -0.11912796582968001, 0.06221848112591997, 0.1884433539067577, -0.10700788275590943, -0.3518682598612047, 0.37456880426014166], [0.013604873029341946, -0.16528022578112536, 0.20155485791540892, -0.3541277493897382, 0.676862752046083, -0.2658785210172399, 0.5147053312531512, -0.112740319727795]],
    [[2.851092491176718], [0.3804764585148756, -0.9247906057675856], [0.43841826755186564, -0.8987710624384948]],
    [[0.5567549635823631], [0.20108807178297264, 0.11422009200726954, -0.4229195164047098, 0.8118482504243884, -0.2985123290622806, -0.10304198468607091, 0.0939765805139303], [0.04424901152619659, -0.7169306819079923, -0.031129292324036512, 0.6372250118096429, -0.02583896509973039, 0.014153747195613426, 0.16225623748001994, -0.11092394734951527, 0.19372269982536366], [0.42796852361059873, 0.1000612228302854, -0.6494403216595616, 0.012394320858700462, -0.44765471097923526, 0.28788160552521874, 0.26926315361113184, 0.14434420119149496, 0.09108177932795573]],
    [[0.36252817849574176], [-0.4152409797128937, 0.3949651690781115, 0.059637140694856684, -0.29809447149493, -0.45495068818315665, 0.15339000916151824, 0.5145387514659299, 0.0726835092343826, 0.15840576161081632, 0.23135797656647117], [-0.539717469908245, 0.4395297187977435, 0.21328340065082524, 0.45891791025442036, -0.08479985319672712, -0.07573386931397807, -0.4964842269000107], [0.3787170228715312, 0.8302726053139932, 0.40892642058497286]],
    [[0.2755990738257318], [0.21794010543619222, -0.832205317244186, -0.08165195766640711, -0.32019564073885964, 0.3882578136419659], [0.8072220207586441, 0.1839997459775723, 0.25829762282479984, -0.16088661411000194, 0.4709383701765526, -0.012312173701218641], [-0.5999408691302599, 0.19608311412450938, -0.7756431949694802]],
    [[0.13874530878036045], [0.22313639103335817, -0.582683687448744, 0.019810748294280565, -0.532091804219692, 0.4183784535017075, 0.14178309829111962, -0.20220724006960822, 0.29098277220121593, 0.08046116169937856], [0.9267624891781729, -0.13156790592635095, 0.35185391113703934], [-0.20128032438008028, -0.8385905159101716, 0.32092863797763976, -0.004535145988646948, 0.2201729511393691, -0.3236669445683654], [-0.4807744861170881, -0.7965214809133648, 0.05085093394774735, -0.18228152610151416, -0.3136581939724126, -0.014682951172671068]],
    [[0.21051807193802943], [0.23403384696597218, 0.42054682357471496, -0.5698122696955275, 0.5838315012795727, -0.32066069773765116], [0.5766960203474961, -0.6743800959552224, 0.13162023644111331, 0.4419381174485529], [-0.21057589355060127, 0.08811991196707877, 0.3405460927874034, -0.3897589394700625, 0.7083087794882124, -0.1136094071563721, 0.08025571453602402, 0.38379031842997346, -0.10397276906281434, 0.029227598658195648], [-0.5554668166067296, -0.20795381463643023, 0.2553028805249397, 0.10256974403643938, -0.08894446390830917, 0.04610645378979823, 0.27966690408533734, -0.07380638485934377, -0.33321238127988634, 0.6064514324865661]],
    [[0.4828275813633084], [0.23384095547788736, 0.3512388738563172, 0.20430444349630456, 0.6579221192887889, 0.09844835569247844, 0.363573528638023, 0.2687104582601494, -0.14301608669058016, -0.09631021994329247, -0.3217692977748192], [-0.5116624664211036, 0.07668016024356412, 0.5061460483419392, 0.3214705004283764, -0.46018395871455636, 0.40127956928413683], [-0.38096699727867506, 0.2861444037357305, -0.8791959549470149], [0.692923641553941, -0.3060961599674285, 0.22172696315719087, 0.6140025420451529]],
    [[1.1838757652294163], [0.210872386528422, 0.07121151449265378, -0.5646662541775129, 0.3616416663029674, 0.06637879222702027, 0.07584789624963773, -0.5828313418578935, 0.2675952004007925, 0.22734623628568493, 0.16638557775398255]],
    [[0.3032739397640297297], [-0.48082028355309697, 0.3388907360614881, 0.454066186534629, -0.17812152265340722, -0.2993680565146906, -0.4376744632861303, -0.07894707721342749, -0.15363745968032946, 0.3241053320409901]],
    [[1.1617468533361055], [-0.02260630098657834, 0.2972001146356296, 0.7596474220087696, -0.5780111082424827]],
    [[1.2844162220009774], [-0.30842015389728145, 0.951250234517699], [0.30279327531038325, 0.08852690888227953, 0.05590206678861999, -0.11020418544430191, 0.34622673649276936, 0.039237251633264296, 0.2036788352046126, 0.7474907644209177, -0.4044368794841003]],
    [[0.18104388996897572], [0.5520877166363866, -0.052976780373050814, -0.8311689032169315, -0.03938106404973989], [0.034274688844047635, 0.16403282417490214, 0.2354752745921137, 0.49694577571607884, -0.1464762658164691, -0.0454250584931338, -0.8037387865251501]],
    [[1.6905902450546004], [-0.12543067772892338, -0.99210238639188], [0.8762083930519261, -0.48193241429204725]],
    [[0.5007028223906543], [-0.06769241297456885, -0.5449485746545011, 0.398606571568952, 0.6501033139153659, -0.04258821690222594, -0.13267612920115782, 0.28917066939208946, -0.0862022715614269, 0.08037444499516286], [-0.435703924552393, 0.003588856443541161, -0.6651813230937048, 0.2132673584452006, -0.23794057413100464, -0.5153487505082289], [0.10026563183607826, -0.41453578717039885, 0.22729656824470607, -0.4898014879827773, 0.3079502543279662, 0.32626734055020185, 0.22241280421779944, -0.20185051232763798, 0.26385177592505493, -0.4067248155023813]],
    [[0.42070460277285854], [-0.11765364391216213, -0.02107059901087521, 0.01919962552849528, 0.0075532937836861914, -0.407416349154066, 0.2526422092654315, 0.18892381530643113, -0.039220900801933495, -0.8474911902514953], [-0.32443831265566164, -0.2349409435382715, -0.24293165040461917, 0.17482035071905289, 0.4202882276170908, 0.29174253040759934, -0.12773231584125186, 0.17922569173029038, 0.6631525474037887], [0.2845093749411345, -0.9586732579824081]],
    [[0.10062440822372039], [0.07996808517600432, -0.26307264663569147, -0.4495698788298603, 0.6111308460433761, -0.11895028828957643, 0.20924569495870432, 0.3301577806915321, -0.004487812699664358, 0.3268240075329048, -0.27392104072489637], [0.12284217101173843, 0.35404646594484673, -0.035991021401721314, 0.5860476109030441, -0.4404194916015131, 0.2346021425142989, -0.16531437985938108, 0.29739181674429876, 0.0961161858068593, 0.3752295207239467], [0.37225889195343176, -0.40269820383703075, 0.5891470410337922, -0.5231944785778554, 0.017605742011659636, 0.24075511508976774, 0.14197812515009833]],
    [[0.18481028402754704], [0.3100324954044331, 0.20571167887073383, 0.2759549800636245, -0.5098047663273968, -0.40513901097801985, -0.006849531735112356, 0.32426009440794523, 0.0980343539650855, 0.496558786543343], [0.7400543367573574, -0.6634600702609377, -0.11018309224186618], [-0.3047981091301781, -0.2991724005041669, -0.180567141067543, -0.46275630707119686, 0.5780573143957574, 0.04795327307127396, 0.27896164368216786, -0.3956977653578857], [-0.5375940335785957, -0.33527871549213856, -0.34423023822843113, -0.057618837476544824, 0.2307053118861316, -0.5816558302641435, 0.1347923363882464, 0.005386448290725161, 0.17361223551501662, -0.19203856057632393]],
    [[0.4228588017696557], [-0.141865030134013, 0.44059694416524103, -0.4181744594149625, -0.3452888941246838, -0.3554076392829921, 0.06722507728789844, -0.08166976238961376, -0.07165859365772556, -0.13418586367363106, 0.5753345078159252], [0.45050543565810647, 0.3522148480832122, 0.20063517590059027, -0.2069225940646595, 0.5565420673454308, -0.2904080923745975, 0.3836714803715129, 0.18159571033346678, 0.12514543453657165], [0.14887119923616898, 0.10387753894769929, -0.13940282319720718, -0.6456183547647123, -0.468455996706801, 0.3389787430786487, -0.4432076338534407], [-0.08150071800245477, -0.5444374572967173, 0.6051990477077818, 0.2041079018657187, -0.4187164733526199, 0.3371884933536173]],
    [[0.17800461834682948], [0.40442214560226664, -0.18410967602595124, -0.37808224287777675, 0.5298695372118921, 0.20342335952859486, 0.47237240617396475, 0.3381149112046999], [-0.0671758988249334, -0.997741148102584], [0.5860119193049029, -0.1655879827363143, 0.42146580605026046, -0.05072788682343524, 0.01966945374695293, -0.18509497429620517, -0.2917989581694971, 0.5737335943846366], [-0.45925413330012654, -0.054244623817065345, -0.11041902728376159, 0.03752800032819433, 0.24065851466537416, -0.17318765966122213, -0.5175866433893724, -0.6455509506489918]]
    ]

# qs[i] is a point on Ms[i] that is connected to ps[i] by a geodesic and uses the closest representation to ps[i]
qs = [
    [[0.2285468999681258], [0.0072000169737206285, 0.46919050788513217, -0.0578728225972693, 0.14417171957969074, 0.5393873747379379, 0.3535952408499787, -0.19179220675967715, 0.0603486044844522, -0.3902812557079805, 0.38335320681028]],
    [[0.5], [0.2514005595224343, -0.96788313275509]], # m = 0
    [[0.7626963166735549], [-0.04331677552451647, -0.008943154324947739, -0.8741092621910937, 0.26370232932220805, 0.2684875896184496, 0.30167858701939854, -0.03663605553981364]],
    [[0.9263875479802128], [-0.2876490379709154, 0.5934703502895091, 0.00669105544965959, -0.5238009412763243, 0.48771046854635186, 0.22195505041284128, 0.05927252688380565], [-0.8467814852966212, 0.5319408953623024]],
    [[0.5053216839247762], [-0.59015897645163, 0.41560724598915816, 0.3244409818454344, 0.2767905184327968, 0.2788412597376433, 0.1764703807465072, 0.301994778424145, 0.2876603862925981, 0.11943395810822663], [-0.03534714586479288, 0.15957987916099206, -0.28718149774238777, -0.19635088853199553, 0.684165557894705, -0.5666526357569592, 0.2510512156243137, 0.007316029468452894]],
    [[0.18066790739255756], [-0.992558358800348, -0.12176988287569214], [-0.7201988141976301, -0.6937677334874601]],
    [[0.05929877942048794], [-0.2492472329981639, 0.19078207722614024, -0.6950020535594956, 0.6155692112895002, 0.12163736596071065, 0.07617216946811589, -0.13757492254479187], [-0.3446138929389734, -0.44528715923871226, 0.09867730315307487, 0.3856741902911293, -0.03976898819561624, -0.09854548801276108, 0.5786967392957476, 0.419483004838766, -0.048271382271637374], [-0.13898349823957276, 0.37007148419755803, -0.5672020653516858, 0.2664429979574558, 0.26019214805889984, -0.183973837333837, -0.537331406376888, -0.2092584392846679, -0.13023121083469708]],
    [[0.4428343667970336], [-0.127255572630727, 0.22668672002145898, 0.3495203443639004, -0.2800785570522293, 0.3076023585481211, 0.2954405117453133, 0.6120999631203197, 0.09785748462223727, 0.40179977381828863, -0.06496817376226975], [0.08909415980355775, 0.880431882384782, -0.3060967538577087, 0.013454468756813096, -0.29939494476539896, -0.16687570624161663, 0.07443689564200096], [0.14631014012300886, 0.5274221714215308, 0.8369105065598011]],
    [[0.9747973672469175], [0.5036745603591766, 0.08655987562606954, 0.45670653353901913, 0.16988849841032172, 0.7080793497266027], [-0.04773379921570165, 0.14480351638724792, 0.46223423790321516, 0.1869203226531565, -0.4654696219322667, -0.7151865207075913], [-0.6614475098892549, 0.6975530383411345, -0.27551216009888874]],
    [[0.5944460845919239], [0.18440528974038717, -0.3234774292705488, -0.07521274368923382, -0.5055464117085976, 0.17461559395815557, 0.20174607290008786, -0.5921554567742019, 0.22060599004214254, 0.3600218594053353], [0.9391716922907767, -0.20920363981570536, -0.27237909150215467], [0.594536709760007, -0.6154768837189905, 0.2868298100684849, 0.08944875927641796, 0.42003473849671874, 0.031823015747801525], [0.04047760394645142, 0.5651446411453817, 0.4996377449872775, 0.5242952935259201, -0.18199312205158755, -0.34832193537003325]],
    [[0.35664035777449904], [0.13343426198137742, -0.25425996956084335, -0.922195129235849, 0.08550784318326136, 0.2445234507695054], [0.4047997839831198, -0.5275627401918468, -0.1815584055185977, 0.7244661727327466], [-0.48114822474834057, 0.07687937224998155, 0.18315655165440772, 0.4530633997597068, 0.3699870416956907, 0.2678528031163627, -0.09413476091065198, 0.11453703309553476, 0.49851411436369913, 0.21128473391689526], [-0.3768156565668107, 0.14736306468252625, -0.06614007558247408, -0.48760209381974895, -0.3574364962985913, 0.5633803923618522, 0.024688951851943863, -0.3699931126715858, -0.003533128694901466, 0.10718456273036511]],
    [[0.11597881520641286], [0.004793068006686758, 0.5431793112729557, -0.2543049740455072, 0.24843954495843448, 0.3105833349418175, 0.22857210987819054, 0.244361879116985, -0.4284169847117112, 0.3591924409584363, 0.2399161670796564], [0.16123153683830393, 0.11403720071692096, 0.07121418589008548, 0.7353846315348165, 0.6113006204016374, 0.20359136354078292], [-0.12820954768918336, -0.7223351856222379, -0.6795544065734709], [-0.5181411756487838, -0.5982091832712966, 0.13154159318612907, 0.5969692658832942]],
    [[0.9068920036691095], [0.028598193298964708, 0.4294897666239807, 0.5582305652867099, 0.20015138065027618, -0.36032666340358765, -0.06085371828646839, 0.3481371808459643, 0.3824819666832563, 0.15057862863095645, 0.19832899484009994]],
    [[0.26091111882856616], [-0.2735468559596818, 0.7908310184653957, -0.3965289688792057, -0.20393895097120848, 0.009693462487979644, 0.22432025309225306, 0.14645403468888063, 0.07594795417367314, 0.15264889046998872]],
    [[0.7507973403445075], [-0.3623234540901233, -0.8628926515811954, 0.04303829727534214, -0.3496937108828457]],
    [[1.8900272913460916], [-0.24462417095922365, 0.9696179737311559], [0.0029148214868594184, 0.046733730849394826, 0.3464166332779196, -0.41612585782053313, 0.4403234930433767, -0.07014699792539351, -0.6626027503215617, 0.06409791188610743, -0.25037156781949155]],
    [[0.0038033069402429436], [-0.6935787317124584, 0.4529983876547129, -0.5165298785674818, 0.2166515364483497], [-0.4548679332583842, 0.38597993504553063, 0.20134736150306345, 0.16454891197012098, -0.6254798836839162, 0.4249626997707289, -0.06840444087211281]],
    [[0.05069728715399965], [0.9989195510484316, 0.046472901062876736], [0.9990218321402392, 0.0442196665202251]],
    [[1.3388920951283048], [-0.2894849285247092, -0.375237468281043, 0.10659685105991663, 0.5326935539788507, -0.2687936085300003, -0.28583226069914086, -0.06940771783985483, 0.566949781731537, 0.0083926101085135], [-0.2692873331242094, -0.352948146454535, -0.36201078692503574, 0.26291906209331745, -0.430264386434885, -0.6462246148490923], [-0.2899662461053266, 0.561676369276759, 0.29953621040966766, 0.026981212635263388, -0.1879070254370779, -0.10235375900374745, -0.04777542564881818, -0.6562458092558364, 0.02736625708068412, -0.17468256196490237]],
    [[1.1931486977771844], [0.22644039039058186, -0.11411958485037178, 0.30437736829730944, -0.62733810852234, -0.6264916698299722, 0.07060731738622097, 0.2251625848885129, -0.02341401611326633, -0.02791368478545802], [0.6571431019356029, 0.006127671303832962, -0.03377055193505131, -0.2634138473656534, 0.0015253787707612755, -0.3506356042585966, 0.27828523163579455, 0.4040591774006482, 0.3659835342176074], [0.5769596212360408, -0.8167726706147582]],
    [[0.09396735191763278], [0.08808204191629705, -0.269420904705849, -0.6118443181714507, 0.2480461224526081, 0.1084861630557538, 0.2683009932904934, 0.38655863782557004, 0.32133983398494953, 0.33119696155689554, -0.19401189178526185], [-0.5120308222265519, 0.7045182787166198, -0.09497155095499868, -0.018552062467794783, -0.10973828476807547, -0.3071753378516766, -0.055696702155718036, -0.19520860631422926, 0.2906599716297778, 0.004872010410999308], [-0.071497555279541, -0.7200146974217542, 0.13219105850125198, 0.5589884484433559, 0.2558843206526261, -0.11634032369835579, 0.2598317093251373]],
    [[0.5595013700016621], [-0.16410496932023275, 0.2124425044194968, 0.019103430387761126, -0.49321855967754313, 0.2187406652190155, -0.2438450092656317, -0.29126737061752705, -0.6546701444600094, 0.2521323190300214], [0.5091077043894671, -0.7810695653023092, -0.36157942348777083], [0.09792086442785906, -0.46300382891140285, -0.34321497128243517, -0.4715033116632154, 0.23250354333074766, 0.3343541579831825, 0.33398745563364823, -0.39815681352786747], [0.1472380561455175, -0.2928950599225513, -0.06829513714619305, 0.2630794095929546, -0.07520704498840525, -0.097452294891074, 0.1546325256973868, -0.7547590605905541, 0.42527618176727117, -0.17050835599699163]],
    [[0.0879788405568045], [0.4752198883185735, 0.4601150437982469, 0.004558213453811248, -0.3747084951936111, -0.06469017263215665, 0.006333332718496339, -0.19475186049495816, -0.4040009330690733, 0.3550915844479287, 0.30095342923066604], [0.3443393165370433, 0.3660193874394325, -0.08495542638537015, 0.09676362754304287, 0.5155711330857424, -0.004321193772576179, -0.6430158188019451, 0.16550949028930745, 0.15551404574943303], [0.4892943761703814, 0.06614536658571389, -0.2830598467537517, -0.19219480553946047, -0.5053021840588248, -0.4208210443148484, -0.4546794862909613], [-0.045503401271809414, -0.49376674883678284, -0.011090272673863474, 0.6509068904350033, -0.5051014195999987, 0.2742145509818364]],
    [[1.4349423523410283], [0.06370019368643771, 0.31519275409207537, -0.717868367412602, 0.2601814359189934, 0.03539231049664084, -0.46547257907453504, 0.309271891789521], [0.6968005890360706, -0.7172649016360588], [0.39039913946740623, -0.5538051672666193, -0.10251421913304977, -0.18753950466778713, 0.5673704705466129, 0.37985274492764076, 0.06722234077506756, -0.1564989325835006], [-0.7130313109989243, 0.24441120802232372, 0.5661277861967524, -0.06364217193543024, 0.2700793817903238, -0.14762085346258608, 0.0921868105034791, 0.06375984394161507]]
    ]

# vs[i] is a tangent vector to Ms[i] at ps[i] such that exp(Ms[i], ps[i], t * vs[i]) is the closes representation to ps[i] for t in [-1, 1]
vs = [
    [[0.6940789907123062], [0.14913995456500687, -0.030547142938236793, 0.31162623436384285, -0.20563967625033036, 0.19319043822673818, 0.317062500120066, -0.8754858218076765, -0.3259209038205042, -0.033243255319008624, -1.1548635082931478]],
    [[0.2389420207891795], [0.0, 0.0]], # m = 0
    [[0.46132409636616317], [0.7034437676859567, 0.6114140712984324, -0.08829607209219353, 0.03327833095019875, -0.6185892330923073, 0.1326136814054642, 0.5700109876145869]],
    [[0.45470843046349313], [0.433513329547113, -0.7320515075884788, -0.38765391945909755, 0.19640702045402264, 0.14944186690806377, -0.9671407596317976, -0.9289295848779034], [-0.5045110500803344, 0.06911945375717096]],
    [[-0.19135891857701476], [-0.0069569775655274405, 0.4648330993586129, -0.5249300916156493, -0.6942918549175187, 0.03839836910376858, 0.48996587981873707, 0.19149786106059058, 0.25496379149224513, 0.8306443019906313], [-0.14991071399697806, -0.0899250894563053, 0.48363972474877626, -0.06740963522851286, -0.17392353118572687, -0.8626165876780832, -0.4781319504914857, -0.002601732145143469]],
    [[0.032475437742255364], [-0.0793840052835045, -0.032660090840698486], [-0.16688671771785502, -0.08140692187036919]],
    [[-0.14362437882603868], [0.21703580244995338, -0.07582942569056315, -0.4131524696769127, 0.07113227925464494, 0.9216831076067749, -0.3117658924120991, -0.2601938828890881], [-0.40993096871840384, 0.06033520676657045, 0.3353505686920585, 0.32669207217743906, -0.26949939576113957, 0.4622586254534011, -0.23046667729151138, 0.39890816877066293, -0.352075854880814], [0.27574595870419494, -0.20132897843112602, 0.7181884086912088, 0.20902304397906357, -0.9797911979282492, -0.22738728408774556, -0.08434852248139064, -0.03906999050989374, 0.23241083119724726]],
    [[0.167542758489263], [-0.7172648711179583, -0.12978356499468247, -0.14709754758453525, 0.7429222145447074, -0.301380485416464, 0.10648701938150486, -0.5862695196566239, -0.6731434017042006, -0.1027873036321029, 0.8518198213004147], [0.36528861191780526, -0.05502523773982651, 0.3349143864166638, 0.5976408658825734, 0.22224119027517705, 0.5079433605241578, 0.13504430515015828], [-0.09838274427397142, 0.1575018337179488, -0.22867252665062765]],
    [[0.0005576618010449276], [-0.5529387542450745, -0.18931262357519596, -0.4740879804055004, 0.7218017303773806, 0.4001673857383268], [0.04653671285987987, -0.3342761936754844, 0.10416238554693465, -0.3780599114751379, -0.13425764881025848, 0.045590813877080076], [-0.3467728705815678, 1.0951463617116348, 0.5450739839349461]],
    [[-0.10835780918855986], [-0.2879956140065193, 0.43075721925722893, -0.3291055923326802, 0.017387780693294552, 0.060086501392198954, -0.22944578876172467, -0.2678362137267055, 0.821848362075142, 0.5607641072034037], [0.1257205818761756, 0.5344739830694265, -0.1312860116480018], [-0.32028258895073813, 0.05581149125388041, -0.38726569273936556, -0.4124721885803405, 0.09543462429188473, -0.2587175245909177], [0.23313088537058163, 0.398484868218528, 0.17079789329674128, -0.5464610930958373, -1.0423151616550292, 0.3909668100967531]],
    [[-0.13373401585247496], [-0.0462149976885849, -0.22586363815314267, -0.24082866649963608, -0.17798976955515672, -0.22606766311009552], [-1.1531492828944132, -1.048323182821658, 0.3469323589434465, -0.19825175056321256], [-0.33544764292008533, 0.5454762716081148, -0.44056401394680517, 0.6346538879978276, 0.4071906233657455, 0.20386210363713045, 0.1131664536677318, 0.13733952167695518, 0.3499954521074497, -0.40947620073175056], [0.5235561961524053, -0.33651887371172584, 0.165664680004435, 0.3177740663156395, -0.5050069337944564, 0.007676908750572816, -0.15745475915753057, -0.13379200089703605, 0.7775600848786371, 0.6495661761313964]],
    [[0.14255661510910747], [-0.01620371146007782, -0.2176640728621523, -0.26783759524037853, 0.1887922975530844, -0.03868441552368684, 0.24619823528128237, 0.16400437859951833, 0.8207953853819989, -0.683215714398723, 0.2095762101658616], [-0.587587477362466, 0.9611453504625634, -0.4956705989932666, -0.8797827478845143, 0.2660001180346881, 0.7021729654279507], [0.6165274130606305, 0.1402548199881536, -0.22150177598219462], [0.42439566636895776, 0.04342532989904936, 0.1811774237827697, -0.5227232167013833]],
    [[-0.25050034943799143], [0.3488629827096742, -0.01790447096652751, 0.41078746198742494, 0.2674738658616262, -0.3676063246452534, 0.27995679376647054, -0.6476807696598814, -0.05608263854802896, -1.002407614041255, -0.41159169074078095]],
    [[1.5189255716984038], [0.14389418968383233, -0.7434685056546961, 0.17177099801922532, -0.0699519450185816, -0.48084553564682225, -0.2504085373789058, 0.5705781638468338, -0.7229621177887824, -0.2742605768830553]],
    [[-0.2000130047239455], [0.28376287916446385, -0.011498145899119377, 0.276592098504903, 0.3464992149574739]],
    [[0.7638265778356526], [0.043718096583251764, 0.014174547965435269], [0.1589574325807131, 0.8748133883099838, -0.3528071207217161, -0.2644899757823254, 0.24010835273681236, -0.1673897092037622, -0.6222042985569745, -0.09191448012128656, 0.039882538236865134]],
    [[0.13319966661993943], [-0.27617394286645647, -0.22020251242074337, -0.2045923981917276, 0.7425959288733582], [-0.7440711602827321, -0.42811046699670163, -0.07153818588627878, -0.1126683907082826, -0.31430569035654404, 1.0115723034951567, -0.20961404535149197]],
    [[0.4767148797604099], [0.3384876432473121, -0.04279471058404047], [-0.27439746807899096, -0.49888606251189316]],
    [[-0.2827629165886028], [-0.5431768324825607, -0.2133080279346807, -0.10499961310795408, 0.09083087776121102, 0.37394345246532357, 0.41219715056530515, -0.17844896356814216, 0.6017127772767268, 0.04825845645947814], [0.1686105642978755, 0.27823583527578005, -0.06479699938479212, 0.4075789329243761, -0.1242362543997863, 0.16905085277591742], [0.4498529143568951, -0.38162629109703405, -0.6140545422956211, 0.15825503736095084, -0.2582602332898444, 0.7274993022330352, -0.2411292264007391, -0.5521909388447415, -0.32703914771404785, 0.28418328300445966]],
    [[-0.05589178950257751], [-0.1019705158920252, -0.4021433820745908, 0.48255194721701017, 0.008131662295720925, 0.07202859076099435, -0.18565046869387167, 0.3240465427833554, -0.4904527437336233, 0.04012334309767329], [-0.47219983715545033, -0.3425847967691243, -0.26741555241645554, 0.5136974943331476, -1.3528826516837709, -0.5084770566734448, 0.5426586250054705, -0.31969383279201147, 0.6862705068300334], [0.09849573584104232, 0.029230981468574946]],
    [[-0.05719286771089035], [0.4242973237170861, -0.5219356456168175, 0.3310684379655346, 0.12413567167651018, -0.5923469397738462, -0.37146828706242285, -0.5751410323943549, -0.055651487469272024, 0.5472629066920902, 0.29283912917169935], [0.1875320328414897, 0.6808265997858123, -0.2995863467195515, -0.13554874838930378, 0.6373044353809255, 0.8178243633205413, -0.9612380226211692, 0.07781549715708687, -0.3845106658570097, -0.6707841245616247], [-0.2707020905807271, -0.5625117726096117, 0.10488366055899745, -0.28409682013973964, -0.25019752929639916, -0.8986902851125926, -0.8128844484365579]],
    [[-0.13762858893746074], [-0.44703815295307797, 0.5944800147380626, 1.4927738811624347, 0.2690676585035225, 0.1392293231358478, -0.40920070507884104, -0.7332317211680289, -0.3830957876846897, 0.1418909392355959], [-0.28919223043248377, -0.334256240757651, 0.07031663871919733], [1.4923062450401439, -0.07045305045420008, 1.1439824974086474, -0.48836659931427834, 0.9029762904802794, -0.4051626818191545, 0.7052172856721804, 0.7200604408974567], [-0.4660428754709174, 0.3303812040550049, 0.0416448317248993, 0.0923448025024135, -0.11839363942123281, 0.12128945856537898, -0.3046909560916853, -0.9180764335769804, -0.8185102432606277, -0.8637091370051597]],
    [[0.08588821780925351], [-0.19846651453049668, -0.12131137905689643, -0.012056169732668959, 0.387028828005472, -0.1673202197809444, 0.15365077102586527, -0.5066602440919681, -0.5263849388489793, -1.0529289245626894, -0.2368951143092367], [-0.5124015057222998, 0.10937701513453171, 1.100622688156337, -0.3529295809332267, -0.14952258183921502, 0.28769664553265084, -0.29663286648941295, 0.8048977491005426, 0.26266525195090656], [0.5229761285972861, 0.058988804914361245, 0.16088566715699476, 0.0876297447684608, -0.12424872326482747, -0.18192414077364386, 0.0034228886467715103], [-0.4422179502033592, 0.06409501421449978, -0.03443123742857476, -0.40737856180759047, -0.49232052745173593, -0.3063601971060485]],
    [[0.0020120000622140064], [-0.4605158014626578, 0.04861856501815409, 0.12440850145559806, 0.41986549071776175, 0.45760378449565353, 0.3823068642538414, -0.7509927996480504], [0.7945555246182702, -0.05349582066856984], [-0.2002746258874713, 0.06644197619406682, 0.3105130297384215, -0.019792549607544785, -0.0029621125749771035, 0.5952370789475336, -0.15048879670202958, 0.10947909205995154], [0.47460069009979067, 0.34348555903411404, 0.8553181291195778, 0.36336966197832254, -0.4154570058919746, 0.7084181186043732, -0.8911752856098722, -0.12208726470275424]]
    ]

# us[i] is a tangent vector to Ms[i] at ps[i]
us = [
    [[-0.37772914799158225], [-0.59695867308892, 0.3750933177933997, 0.34564315403507745, 0.046043813336741984, -0.0545409875155681, 0.2577121584084208, -0.3308621558840682, 0.15972331014082508, 0.23275600794660842, -0.33394550809020124]],
    [[1.3683817863110515], [1.309120423677036, 0.34003444822705764]],
    [[-0.12929062734170355], [0.15850990687718194, 0.17487391887026144, 1.0186159795799787, -0.34163759242980707, 0.14845978504467341, -0.13138435258479628, 0.07372358714600029]],
    [[-0.2603225446842325], [0.3602679784109386, 0.17337068990715637, -0.19313197776041668, -0.25410123672991486, 0.08222041883237792, -0.21642611657517966, 0.2574667569083157], [1.3205385203894777, -0.18091754616690692]],
    [[-0.3096239639876968], [0.8763931296077601, 0.9630409930052396, -0.024742767752841448, -0.5119584268098544, -0.65137269579901, -0.5585309447674137, 0.36820697176827755, 0.788214538036487, 0.2908132604789067], [0.2655385329237167, -0.33415351180043346, -0.5131255776726478, 0.27265294689102404, -0.0733048224201999, -0.5967809983817592, 0.11338960014259027, 0.23310946516775605]],
    [[-0.5123951975200387], [-0.7694459734927109, -0.31656471982654616], [-1.1392866599419809, -0.5557411721084375]],
    [[-0.14766117733667908], [-1.0051180880053472, 0.9460677967957836, 0.5835821685582908, 0.6948551934342009, 0.6374252884087097, -0.009680426176410788, -0.36146835559128143], [0.4688516869504158, -0.28425151202447, -0.3187195701047898, -0.35633492041750464, 0.554715750802327, -0.10721116773599117, 0.28645702408100504, -0.1610220090851739, -0.28845747034499986], [0.09417372769886223, 0.1989812337413881, -0.08400464069697863, -0.6790036003882072, -0.22919842842946442, 0.3185935243022103, -0.9397877219225759, -0.548382602086301, 0.3462072647694016]],
    [[-0.0360207524796129], [0.20350245773360448, 0.37364752980981, -0.13027127184216153, -0.08190812987077147, 0.4553806555417341, -0.5133558357167839, -0.01992655851146799, 0.7876406853642887, 0.14590589840824297, 0.5882183495667237], [0.1421766874190634, 0.16985174267090664, 0.2674424928046712, 0.19679295366232205, 0.020504602587278625, -0.7983181858070574, 0.41087597326194303], [0.08272242498791532, 0.043641892904065484, -0.1652205757255303]],
    [[0.07334723852895442], [-0.335402461448991, -0.04149991778158621, 0.8259416067042924, -0.36669745774013474, -0.0293979473512328], [0.25357991790389556, -0.6762696649693698, -0.1500007754391727, -0.21823190285300317, -0.1554963524472741, 0.2760192231713663], [-0.6373006596520467, -0.671494722883091, 0.3231820209261418]],
    [[-0.8237610837914967], [0.3004390493463726, 0.4405860908850111, -0.7157767786794753, -0.26422248721975317, 0.43563297876352225, -0.05301527548401603, 0.2653406121711885, -0.16921344490396534, -0.10660913986306259], [0.2301095438238535, 0.13543635311552182, -0.5554515952958057], [-0.047141475305190236, 0.26349478946841576, 0.7660038342835548, -0.44707592462720674, -0.008237239351391848, 0.10681017970047482], [-0.10101942119876328, -0.09752768648570287, -0.03101236164578546, -0.017267002331470507, 0.426143631920239, -0.3979129485173604]],
    [[-0.17314190690191722], [-1.1339790699243253, -0.6846816962035396, 0.2090090635616599, 0.6968343188160526, -0.8282658301524312], [0.26096836011459945, 0.5854265047018472, 0.7062605498807286, 0.34245153599846784], [-0.4642499534514001, 0.3677311750533016, -0.5795938822926545, -0.2327468766014096, 0.008116599138855707, 0.25047446112097677, 0.1664040210464276, -0.13265399018639917, -0.38415949773048125, -0.10878478149940779], [0.36290342984947627, -0.5552686774454564, -0.03722341001087248, -0.08247270899765498, 0.42071065664777474, 0.029450006187029542, -0.6467198752580883, 0.3282922917661867, 0.13054924199752604, 0.6409942919440069]],
    [[0.15795465249466936], [0.5351607860771331, -0.41785689120228914, -0.030904801558696852, 0.20801945515978773, 0.39257256533026225, -0.08950160299890557, 0.6172225568521781, 0.8206592397973528, 0.5312616693613874, 0.34916321649313975], [-0.48125632002442126, -0.3885025059033661, -0.39789961820933506, -0.8112377504395194, -0.13593743657921403, 0.45648408250913297], [-0.6908584605178826, -0.25115275205263854, 0.217617378343041], [-0.05159880494311214, -0.08968056529390697, -0.31839202789900106, 0.12849987939389101]],
    [[-0.11566741406383592], [-0.6189044291634334, -0.4887938523139652, 0.377907148579411, 0.4086524760594208, 0.07938663795474155, -0.6960459002055371, -0.5157245121702985, -0.0949098978719522, 0.35850803987739277, -0.4702399492568731]],
    [[0.996024398644524], [-0.7416787110144638, 0.14070197751838798, -0.13795012958209601, -0.4757150483429905, -0.1360189820310271, 0.3238908388104348, 0.5189337739664109, 0.6803924956106052, -0.5549192083475457]],
    [[-0.5889817889278641], [0.08753868748426015, 0.07610237172143071, -0.1871044108743123, -0.21019436123666874]],
    [[-0.44426957903450753], [0.02248238255936011, 0.0072893752214958085], [-0.11483810063446695, 0.7180538788465062, 1.2336105712455359, 0.5094984474406282, 0.44539460730056, -0.22600080346686421, 0.23177494146123226, 0.04078051728077603, 0.6543369295727094]],
    [[-0.8389592975128012], [-0.3425282245979182, 0.7830546276591328, -0.3052977538552278, 0.5882182554997865], [0.03745255029472473, -0.18373865390118915, 0.31498165370594844, 0.46034942779621935, 0.11932816285894, 0.030905964762235363, 0.31751727602532254]],
    [[-0.4656394904731537], [-0.49930548339416325, 0.06312677606155825], [0.1221872729023376, 0.22215047352319392]],
    [[0.26115469823295706], [0.9332535998779934, 0.8409422500428906, 1.1570765490059969, 0.009748111907376684, 0.1823249755535606, 0.42856570496684815, 0.5854663071660117, 0.3272130825134361, -0.2809222008539077], [-0.3442363693316475, -0.5817781819508783, 0.35114374833485607, 1.1229502716222781, 0.45619247794084083, 0.08783351766172355], [0.06361430009419232, 0.6926810562240848, -0.4297785211478541, -0.46202875308860125, -0.36949007474336926, 0.8488609929914562, 0.030242445794160633, -0.14503901054294097, 0.2058457533515663, 0.2491580414140638]],
    [[0.9549180463751705], [0.3895017091001908, 0.49171007245983317, -0.7574299513534506, -0.34411683885229793, 0.0513658453673059, 0.06981342473422567, -0.1439873053399203, -0.18295666103878877, -0.11403644383556799], [-0.15850209669311577, 0.2414976982465587, -0.09000199478941477, -0.47413124486427444, 0.09572564708049942, -0.36176114242096513, -0.1257338263899131, -0.06322697714974733, 0.19138488813360416], [-0.19020791605007967, -0.056448779449793374]],
    [[-0.5581377638463701], [-0.25985100085298074, -0.12823304129983562, 0.6940528086313831, 0.3949636485406578, 0.6535818467393291, 0.5759145253409661, 0.2526448903910712, -0.5437798878532403, -0.36348766005250244, -0.17477846468203878], [0.11703814560342424, 0.5421400308047751, 0.5209685317484212, 0.004412884829451791, -0.10761650749037417, 0.4539634764966858, 0.15393382881531487, 0.37298468621560743, 0.20920463087073315, -1.1982965330635182], [-0.2361677344675108, -0.08561184124338428, 0.33089548131311, 0.09448935004937808, -0.5233825679847084, -0.09673390251592129, -0.4195453536456808]],
    [[0.1798820030601053], [-0.1533759903297747, 0.2964688376499158, -0.14860837418627715, -0.5551072496477686, 0.19870817329497556, -0.3760368493600557, 0.4044751294601737, -0.32878881969363477, -0.5566640994443255], [0.5598006445911394, 0.4954191143909883, 0.7768169558982286], [0.035077508613607256, -0.18338072549214748, -0.11985026451776065, 0.7471592115103867, 0.34655767438419205, 0.22412820486882898, 0.6981705844979219, 0.3181720496138494], [0.18466074016625922, 0.5419495972646897, 0.5887579351606795, -0.5653359894384714, 0.16017679421854783, -0.49769950032627924, -0.6930225262597705, 0.3904417023562996, 0.6252695138324811, -0.5591798774189761]],
    [[0.02775921877564232], [-0.32610417589316576, -0.9533681500385859, -0.7953634329826215, -1.0380444511104359, 1.8624955384484987, 0.44685665513406264, -0.8501002862266008, -1.070462937138491, -0.02354710201871483, 0.28743720819281715], [0.2653138406460859, -0.2282890286319614, 0.02811495791663485, 0.03337784871438022, 0.1768829048441087, -0.2345694568284544, -0.46257070907000497, -0.2368037688836088, 0.12834132594241648], [-0.5490049782150824, -0.15079368647293154, 0.4956415766510821, -0.04311702187664941, -0.13959940872666987, 0.1745102984539435, -0.031814296573279166], [1.060646643382475, -0.07879165090994764, -0.13387349603704785, -0.2653272097959495, -0.9301322737127853, -0.6249913037816839]],
    [[0.16969505385956252], [0.0930186150799604, 0.1546667070131112, 0.5068773816789583, 0.21700722366006517, -0.408452920217741, 0.26880615167829464, 0.06987247642683876], [-0.0984469609988096, 0.006628235293547613], [0.016225795251541872, -0.7366173566083619, 1.1134825891599547, -0.7078026064080831, -0.024735556978746676, -0.65431320330066, 0.7988331267058175, -0.913679346443505], [-0.41346861893716785, -0.30448423297022137, 0.7646027070405849, -0.3087443669597033, 0.3795212472780163, -0.002675858285340116, 0.4202373636203284, -0.023732041788181002]]
    ]

# When testing that exp(Ms[i], ps[i], t * vs[i]) is an extremum of the length functional, we parametrize curves in Ms[i] and take a derivative along dys[i]
dys = [
    [0.24768051036976024, 0.15340874919881428, 0.10461792180729243, 0.1621738878738882, 0.13788895788409475, 0.13920478959340893, 0.1980520199776914, 0.225220769065586, 0.09192923424127934, 0.15861132814448145, 0.07788788182581427, 0.2033127058413462, 0.11406283238286104, 0.020870012361419343, 0.2719578430552649, 0.15170700765742606, 0.07022129511933332, 0.04843952826362164, 0.2555544578976192, 0.06681340738035137, 0.15586613310716685, 0.018646851863471762, 0.1979297092698637, 0.23753411269988997, 0.21343310337377225, 0.08016910818336964, 0.1464783972931314, 0.025950651929534232, 0.1449831966165307, 0.23373068876892722, 0.11880598168141776, 0.19121899600576953, 0.15179084381364852, 0.04935589775227154, 0.1560593153225572, 0.04411343229804097, 0.2392666728301238, 0.1484349911958273, 0.17060958026859915, 0.01433037040599356],
    [0.49490048799897596, 0.3065322528949179, 0.20904131890947963, 0.32404623250194, 0.27552152748971576, 0.2781507442742417, 0.3957357855481444, 0.45002276663457547],
    [0.2774747194904695, 0.17186273392192533, 0.11720271596589263, 0.18168225662692275, 0.15447602176127323, 0.15595013869479196, 0.2218762736147053, 0.2523132305670958, 0.10298766925985375, 0.17769114622380935, 0.08725724171457977, 0.22776978268478074, 0.1277837823108223, 0.023380526861408162, 0.30467244314999586, 0.16995628493998063, 0.07866841899027918, 0.05426646003407173, 0.2862958470725858, 0.07485058652127569, 0.17461572368939868, 0.02088993591975766, 0.22173924979601844, 0.2661077821279658, 0.17616832761102516, 0.24286311298519137, 0.32029952947731805, 0.07192152273314319],
    [0.2703013619564934, 0.1674196883015804, 0.11417275710290055, 0.17698535383607492, 0.15048246250457872, 0.15191847013635482, 0.2161402633508973, 0.2457903551976426, 0.10032520193833194, 0.1730974227854145, 0.08500144200281991, 0.22188141170224845, 0.12448027862860386, 0.022776086648557087, 0.29679596211605436, 0.16556252539583352, 0.07663466003347703, 0.05286354765112583, 0.278894443170582, 0.07291552728513738, 0.17010150697308607, 0.020349883191748984, 0.21600678191201325, 0.2592282859804155, 0.23292611292832396, 0.08749101451887183, 0.15985638202387917, 0.02832074493766232, 0.1582246235190211, 0.255077492415341, 0.12965662340215453, 0.20868317404203518],
    [0.19457563274485226, 0.1205165654713542, 0.08218692016467483, 0.12740238140112917, 0.10832435377645168, 0.10935805960596295, 0.15558792674492308, 0.17693145731489499, 0.07221879869975649, 0.12460366577951727, 0.061188035614062594, 0.15972067533731096, 0.08960675892678109, 0.016395298340405255, 0.21364769199403277, 0.11917969226849504, 0.0551652324585789, 0.03805366779842952, 0.2007613367396708, 0.052488025793646274, 0.12244706467838061, 0.014648802986629832, 0.15549184052751536, 0.1866047118849567, 0.167671170717676, 0.06298014699696033, 0.11507214190657873, 0.02038660414496235, 0.11389752539236134, 0.18361677546291374, 0.09333293534087271, 0.15021996314975533, 0.11924555321621164, 0.0387735596171921, 0.12259882692942942, 0.03465512481835747, 0.18796579590043078, 0.11660922488526533, 0.13402938722767327, 0.011257813079646883, 0.09066268061997902, 0.07657067329789471, 0.17155609506972255, 0.02437048731808387, 0.2215711733203188, 0.2103628283958812, 0.13577361182582945, 0.05424502888292601, 0.028934213909226063, 0.0924565622310047, 0.1986597950667768, 0.0790211436628239, 0.07639807345045613, 0.12722079565692512, 0.1446707992261107, 0.06036826781167918, 0.0585884798528245, 0.15137516172871096, 0.22086742806031712, 0.08175559977855866, 0.10596354820935999, 0.010750489568562414, 0.05896893496182565, 0.16027814898868079],
    [0.387733284839387, 0.24015485982792192, 0.1637748986177967, 0.253876310924278, 0.2158592878529835, 0.21791916632378672, 0.3100419978963423, 0.35257351688061767, 0.2461713430135757, 0.3393682593390343, 0.44757514819657734, 0.1005005728492324],
    [0.16353440643700792, 0.10129020125571776, 0.06907539765598648, 0.10707750259980159, 0.0910430491609086, 0.09191184484141025, 0.13076652451317197, 0.14870505851042468, 0.06069752009721213, 0.1047252743607885, 0.05142652727905344, 0.13423996349664308, 0.07531152759015192, 0.013779707893699597, 0.17956384365300332, 0.10016660338980309, 0.04636455972831437, 0.03198285359980099, 0.16873328677427074, 0.0441144557626597, 0.10291272221322205, 0.012311836110395775, 0.1306857672142806, 0.1568351101623881, 0.14092209282890691, 0.05293273783140711, 0.09671434268855209, 0.017134268875714943, 0.09572711622173373, 0.1543238480770115, 0.07844325605769907, 0.12625492803046978, 0.10022195734569302, 0.03258789894704945, 0.10304027338340047, 0.029126490235301297, 0.15797905641835802, 0.09800621027247283, 0.11264728258206483, 0.009461820854890907, 0.07619899497188476, 0.06435512726649247, 0.14418724370624061, 0.020482591380646117, 0.18622326856315144, 0.17680302406232687, 0.11411324587011096, 0.04559115895133764, 0.024318253167761508, 0.0777066933426362, 0.16696701026147626, 0.06641466684484068, 0.06421006278332052, 0.1069248857665583, 0.12159103864374035, 0.05073753945931583, 0.04924168633871106, 0.12722583436268306, 0.18563179386637813, 0.0687128870870491, 0.08905886988994213, 0.009035432164352614, 0.049561446318667116, 0.1347085017272271, 0.1200359392924501, 0.027268283817115106, 0.04224558795450571, 0.04315262171954351, 0.05403346926811662, 0.0023262859537098515, 0.010721414504714139, 0.13403654903491943, 0.10987330337776338, 0.013298908898025385, 0.14340914694684173, 0.17825169707180502, 0.10868078009526573, 0.0016445884181541684, 0.07063958523304881, 0.1101738445443299, 0.11758054831650003, 0.060827727766064016, 0.14865227744166581, 0.11702503201869387, 0.09342064187053477, 0.15738531812684184, 0.03201521439082036, 0.06114448967602477, 0.10382777552410098, 0.1431354723068435, 0.18877393058117947, 0.04238816261102419],
    [0.18931478384099465, 0.11725809249396936, 0.07996478698818024, 0.12395773281339016, 0.10539552836400544, 0.10640128531778455, 0.15138120999255955, 0.17214766373220333, 0.07026617913163342, 0.12123468761259337, 0.05953366088302137, 0.15540221917752278, 0.08718401146951676, 0.015952009599231567, 0.2078711812851488, 0.11595736507064407, 0.05367369958461762, 0.03702478975393335, 0.19533324153872214, 0.051068878035693224, 0.11913639572715305, 0.014252735205439095, 0.15128772171130855, 0.18155937717307144, 0.16313775262089256, 0.061277317960149645, 0.11196087281767074, 0.01983540026317905, 0.11081801505923433, 0.17865222723918714, 0.09080944119283771, 0.14615838299541906, 0.1160214452995229, 0.03772521745978412, 0.11928405469835733, 0.0337181350584281, 0.18288366080789226, 0.11345639683447971, 0.13040556062135805, 0.010953429366412056, 0.08821138362439966, 0.0745003896914418, 0.16691763812644678, 0.02371156898547879, 0.21558043106834748, 0.2046751323592965, 0.13210262565520578, 0.052778376061538665, 0.028151903578888155, 0.08995676306701976, 0.19328852040933758, 0.07688460533499909, 0.07433245652145608, 0.12378105670329538, 0.1407592548832129, 0.058736057595709795, 0.05700439074739889, 0.14728234783203958, 0.2148957133578259, 0.07954512844968857, 0.1030985532015983, 0.010459822641440727, 0.05737455928138075, 0.1559446201057239, 0.13895900193366503, 0.03156699173602045, 0.04890539260876352, 0.04995541568895709, 0.06255157417661084, 0.002693013244577135, 0.012411591625591608, 0.15516673744807902],
    [0.2208827351133444, 0.13681070045747248, 0.09329879317581574, 0.14462749557513332, 0.12297007186353966, 0.12414353725437031, 0.17662379572008607, 0.20085302392695362, 0.08198295726125182, 0.14145038674302837, 0.06946080797470483, 0.18131530204975832, 0.1017218123213999, 0.018611982853869447, 0.24253338351044798, 0.13529307872148416, 0.06262370707329344, 0.04319861693798904, 0.22790476144676877, 0.059584535506577115, 0.1390022078881141, 0.016629357048352854, 0.17651471841061875, 0.21183412621988404, 0.19034072388880155, 0.07149521720826639, 0.13063017748479328, 0.023142922984180615, 0.12929674993937262, 0.20844221347143077, 0.1059517769179363, 0.17053007029227615, 0.13536784423072898, 0.04401583989479429, 0.13917448876740884, 0.039340582618640645, 0.21337923212968313, 0.13237507784892918, 0.15215048882937396, 0.012779896996084542, 0.10292049721512919, 0.08692321596963569, 0.19475089953352745, 0.027665436925096435, 0.2515281389291008, 0.23880439830403508, 0.15413053686754696, 0.06157908971918815],
    [0.1715795373556408, 0.1062732072642473, 0.07247358541051933, 0.11234521687243985, 0.0955219430260548, 0.09643347940647069, 0.13719962830095694, 0.15602065459839623, 0.0636835553069129, 0.10987726996268543, 0.053956472834027505, 0.14084394430027286, 0.07901650388441198, 0.014457605324831525, 0.1883975482043314, 0.10509433361797467, 0.04864548006260954, 0.03355626099441541, 0.17703417838482685, 0.046284681464683716, 0.10797554869382073, 0.0129175210883459, 0.1371148981191942, 0.164550666915154, 0.14785480326481754, 0.05553678192838664, 0.1014722377736982, 0.01797719507885178, 0.10043644436402703, 0.1619158624347057, 0.08230229880238973, 0.1324660822900412, 0.10515241073061003, 0.03419107175394852, 0.10810937478733341, 0.030559377859677404, 0.16575088999747303, 0.10282765922416374, 0.11818900408120409, 0.009927298359990544, 0.07994763052677145, 0.06752109970877263, 0.15128058435355177, 0.021490239451779292, 0.19538458579496817, 0.1855009091519671, 0.1197270859333567, 0.047834031570543896, 0.02551459792914639, 0.08152950063326206, 0.17518100929637484, 0.06968195903934253, 0.06736889872885857, 0.11218509200201603, 0.1275727512737259, 0.053233590023432004, 0.05166414789821036, 0.13348475269051732, 0.19476401329869034, 0.07209324101046329, 0.09344015137889938, 0.009479933332347762, 0.051999638579474684, 0.14133553242896432, 0.12594114827928685, 0.028609756342773685, 0.04432387406709532, 0.04527552966766203, 0.056691664223667886, 0.002440728384874828, 0.011248858149159562, 0.14063052279470464, 0.11527855802353276, 0.013953153258528188, 0.15046420885860654, 0.18702085012439856, 0.11402736815129268, 0.0017254945064788542, 0.07411472372909801, 0.11559388441532585, 0.10893561836452229, 0.15017707070132247, 0.198060728501197, 0.04447346273248423],
    [0.15352324557245492, 0.09508947248635916, 0.0648467773137381, 0.10052248994615477, 0.08546962500750059, 0.08628523522382116, 0.12276133012550565, 0.1396017126485001, 0.05698177213314873, 0.09831425914354645, 0.04827832594018572, 0.1260221339994952, 0.07070114721768485, 0.012936149187027587, 0.1685714013686324, 0.09403465842703182, 0.04352623918178691, 0.030024944562363123, 0.15840386366444553, 0.04141388086399268, 0.09661266683324013, 0.011558136784825031, 0.12268551658326957, 0.14723406319463364, 0.13229520035155487, 0.04969233010940552, 0.09079373635463328, 0.01608535246877302, 0.08986694538383312, 0.14487653419367338, 0.07364115922533956, 0.11852592211670533, 0.09408662375438188, 0.03059295057071266, 0.09673240964485387, 0.027343440505776938, 0.1483079799672769, 0.09200651908735905, 0.10575130214923645, 0.008882592222129873, 0.07153428610112707, 0.06041546988453471, 0.1353604669880599, 0.019228699177151067, 0.1748231532056124, 0.16597959213878738, 0.107127522889412, 0.04280018403537061, 0.022829551495057773, 0.0729496870082825, 0.1567457141121245, 0.06234892968263987, 0.0602792858804522, 0.10037921592768378, 0.11414754418852645, 0.04763151620423726, 0.04622723541111018, 0.11943739203007579, 0.17426788708699534, 0.06450645872078792, 0.0836069121502298, 0.008482305963885847, 0.046527420497518554, 0.12646198951003412, 0.1126876440684275, 0.025598988763302813, 0.039659420394756825, 0.04051092785723106, 0.05072567756422609, 0.0021838766380988884, 0.010065076749004063, 0.1258311720542961, 0.10314713890387746, 0.012484783484285916, 0.13463000333533406, 0.16733958106731892, 0.10202761886684918, 0.0015439108936574257, 0.06631520930151812, 0.1034292817038221, 0.11038256588952834, 0.057104008819336624, 0.13955216270266796, 0.1098610568880544, 0.08770166753227544, 0.14775058882543593, 0.03005532430797646, 0.057401379369977516, 0.02755102955172378, 0.05922224994122391, 0.17215444540682492, 0.11921375673164347, 0.014339320851720466, 0.07226503986645506, 0.0717760634504068, 0.17528349052139683, 0.14331799583358729, 0.055100951418902915, 0.14579838397697775, 0.0716513592338211, 0.1554316797606585, 0.029621643272853243, 0.09658002282375533, 0.07404757373098435],
    [0.17846031137802032, 0.11053503204293935, 0.07537995974563472, 0.11685054461552731, 0.09935261487813324, 0.1003007061761313, 0.1427016808932576, 0.16227747801487458, 0.06623742717159986, 0.11428362678390792, 0.056120264054923916, 0.14649214319442222, 0.08218526582214918, 0.015037391916391805, 0.19595276705818235, 0.10930888257761537, 0.050596287021758744, 0.03490195205115243, 0.1841336973279205, 0.048140814420656146, 0.11230564167550687, 0.013435546401317802, 0.14261355281660268, 0.17114956543023846, 0.15378415536045742, 0.057763947546553146, 0.1055415315159862, 0.018698126133919378, 0.10446420016714315, 0.16840909861672573, 0.08560282943855643, 0.13777830769824043, 0.10936928872956436, 0.03556222032998324, 0.11244483453432241, 0.031784886312244846, 0.17239792049806787, 0.10695130879960922, 0.12292868249243113, 0.0103254081679582, 0.0831537330012127, 0.07022886682365666, 0.15734731894762363, 0.02235205248399433, 0.20322000255288147, 0.19293996544324854, 0.12452844532248876, 0.04975229738993509, 0.026537797929146605, 0.0847990401055136, 0.18220621146533902, 0.0724763820863788, 0.07007056219895538, 0.11668399833223729, 0.13268874171440578, 0.055368391812715356, 0.05373601108320975, 0.13883782936185077, 0.20257454352772494, 0.07498436257180507, 0.09718733811319212, 0.009860102669626628, 0.0540849557905192, 0.1470034452521622, 0.1309917073073869, 0.029757080034537288, 0.046101373680117005, 0.04709119308060735, 0.058965143546946014, 0.0025386077749533845, 0.011699965851902326, 0.14627016294592948, 0.11990152017630731, 0.014512710044560078, 0.15649820472762588, 0.1945208598983612, 0.11860015442119298, 0.0017946912064986773, 0.07708691186744215, 0.12022949195506588],
    [0.24768051036976024, 0.15340874919881428, 0.10461792180729243, 0.1621738878738882, 0.13788895788409475, 0.13920478959340893, 0.1980520199776914, 0.225220769065586, 0.09192923424127934, 0.15861132814448145, 0.07788788182581427, 0.2033127058413462, 0.11406283238286104, 0.020870012361419343, 0.2719578430552649, 0.15170700765742606, 0.07022129511933332, 0.04843952826362164, 0.2555544578976192, 0.06681340738035137, 0.15586613310716685, 0.018646851863471762, 0.1979297092698637, 0.23753411269988997, 0.21343310337377225, 0.08016910818336964, 0.1464783972931314, 0.025950651929534232, 0.1449831966165307, 0.23373068876892722, 0.11880598168141776, 0.19121899600576953, 0.15179084381364852, 0.04935589775227154, 0.1560593153225572, 0.04411343229804097, 0.2392666728301238, 0.1484349911958273, 0.17060958026859915, 0.01433037040599356],
    [0.24802588780879425, 0.153622669627372, 0.10476380599437246, 0.16240003082711635, 0.1380812367802985, 0.1393989033476937, 0.19832819309827035, 0.22553482757717827, 0.0920574247212134, 0.15883250329562493, 0.07799649237864552, 0.2035962147115505, 0.11422188700075789, 0.020899114495500196, 0.2723370739572822, 0.1519185550969481, 0.07031921502040975, 0.04850707463695044, 0.25591081514216235, 0.06690657516129511, 0.15608348022827995, 0.018672853917218492, 0.19820571183459643, 0.23786534152126568, 0.21373072460581133, 0.08028089978632086, 0.14668265371062417, 0.025986838748155147, 0.14518536805535576, 0.23405661391576318, 0.11897165037143213, 0.19148564083396585, 0.1574713038353601, 0.21708766594943277, 0.28630563284911986, 0.06428837755455744],
    [0.37258942960245, 0.23077503463910054, 0.15737827636974977, 0.24396056148760667, 0.20742838461456795, 0.20940780958141045, 0.29793256257804646, 0.33880291087698405, 0.13829049729675522, 0.23860135056090637, 0.1171678846232154, 0.3058462895900371, 0.17158639407244533, 0.03139506612744243, 0.40911017773906017, 0.2282150798437472],
    [0.24768051036976024, 0.15340874919881428, 0.10461792180729243, 0.1621738878738882, 0.13788895788409475, 0.13920478959340893, 0.1980520199776914, 0.225220769065586, 0.09192923424127934, 0.15861132814448145, 0.07788788182581427, 0.2033127058413462, 0.11406283238286104, 0.020870012361419343, 0.2719578430552649, 0.15170700765742606, 0.07022129511933332, 0.04843952826362164, 0.2555544578976192, 0.06681340738035137, 0.15586613310716685, 0.018646851863471762, 0.1979297092698637, 0.23753411269988997, 0.21343310337377225, 0.08016910818336964, 0.1464783972931314, 0.025950651929534232, 0.1449831966165307, 0.23373068876892722, 0.11880598168141776, 0.19121899600576953, 0.15179084381364852, 0.04935589775227154, 0.1560593153225572, 0.04411343229804097, 0.2392666728301238, 0.1484349911958273, 0.17060958026859915, 0.01433037040599356],
    [0.24768051036976024, 0.15340874919881428, 0.10461792180729243, 0.1621738878738882, 0.13788895788409475, 0.13920478959340893, 0.1980520199776914, 0.225220769065586, 0.09192923424127934, 0.15861132814448145, 0.07788788182581427, 0.2033127058413462, 0.11406283238286104, 0.020870012361419343, 0.2719578430552649, 0.15170700765742606, 0.07022129511933332, 0.04843952826362164, 0.2555544578976192, 0.06681340738035137, 0.15586613310716685, 0.018646851863471762, 0.1979297092698637, 0.23753411269988997, 0.21343310337377225, 0.08016910818336964, 0.1464783972931314, 0.025950651929534232, 0.1449831966165307, 0.23373068876892722, 0.11880598168141776, 0.19121899600576953, 0.15179084381364852, 0.04935589775227154, 0.1560593153225572, 0.04411343229804097, 0.2392666728301238, 0.1484349911958273, 0.17060958026859915, 0.01433037040599356],
    [0.387733284839387, 0.24015485982792192, 0.1637748986177967, 0.253876310924278, 0.2158592878529835, 0.21791916632378672, 0.3100419978963423, 0.35257351688061767, 0.2461713430135757, 0.3393682593390343, 0.44757514819657734, 0.1005005728492324],
    [0.16353440643700792, 0.10129020125571776, 0.06907539765598648, 0.10707750259980159, 0.0910430491609086, 0.09191184484141025, 0.13076652451317197, 0.14870505851042468, 0.06069752009721213, 0.1047252743607885, 0.05142652727905344, 0.13423996349664308, 0.07531152759015192, 0.013779707893699597, 0.17956384365300332, 0.10016660338980309, 0.04636455972831437, 0.03198285359980099, 0.16873328677427074, 0.0441144557626597, 0.10291272221322205, 0.012311836110395775, 0.1306857672142806, 0.1568351101623881, 0.14092209282890691, 0.05293273783140711, 0.09671434268855209, 0.017134268875714943, 0.09572711622173373, 0.1543238480770115, 0.07844325605769907, 0.12625492803046978, 0.10022195734569302, 0.03258789894704945, 0.10304027338340047, 0.029126490235301297, 0.15797905641835802, 0.09800621027247283, 0.11264728258206483, 0.009461820854890907, 0.07619899497188476, 0.06435512726649247, 0.14418724370624061, 0.020482591380646117, 0.18622326856315144, 0.17680302406232687, 0.11411324587011096, 0.04559115895133764, 0.024318253167761508, 0.0777066933426362, 0.16696701026147626, 0.06641466684484068, 0.06421006278332052, 0.1069248857665583, 0.12159103864374035, 0.05073753945931583, 0.04924168633871106, 0.12722583436268306, 0.18563179386637813, 0.0687128870870491, 0.08905886988994213, 0.009035432164352614, 0.049561446318667116, 0.1347085017272271, 0.1200359392924501, 0.027268283817115106, 0.04224558795450571, 0.04315262171954351, 0.05403346926811662, 0.0023262859537098515, 0.010721414504714139, 0.13403654903491943, 0.10987330337776338, 0.013298908898025385, 0.14340914694684173, 0.17825169707180502, 0.10868078009526573, 0.0016445884181541684, 0.07063958523304881, 0.1101738445443299, 0.11758054831650003, 0.060827727766064016, 0.14865227744166581, 0.11702503201869387, 0.09342064187053477, 0.15738531812684184, 0.03201521439082036, 0.06114448967602477, 0.10382777552410098, 0.1431354723068435, 0.18877393058117947, 0.04238816261102419],
    [0.18931478384099465, 0.11725809249396936, 0.07996478698818024, 0.12395773281339016, 0.10539552836400544, 0.10640128531778455, 0.15138120999255955, 0.17214766373220333, 0.07026617913163342, 0.12123468761259337, 0.05953366088302137, 0.15540221917752278, 0.08718401146951676, 0.015952009599231567, 0.2078711812851488, 0.11595736507064407, 0.05367369958461762, 0.03702478975393335, 0.19533324153872214, 0.051068878035693224, 0.11913639572715305, 0.014252735205439095, 0.15128772171130855, 0.18155937717307144, 0.16313775262089256, 0.061277317960149645, 0.11196087281767074, 0.01983540026317905, 0.11081801505923433, 0.17865222723918714, 0.09080944119283771, 0.14615838299541906, 0.1160214452995229, 0.03772521745978412, 0.11928405469835733, 0.0337181350584281, 0.18288366080789226, 0.11345639683447971, 0.13040556062135805, 0.010953429366412056, 0.08821138362439966, 0.0745003896914418, 0.16691763812644678, 0.02371156898547879, 0.21558043106834748, 0.2046751323592965, 0.13210262565520578, 0.052778376061538665, 0.028151903578888155, 0.08995676306701976, 0.19328852040933758, 0.07688460533499909, 0.07433245652145608, 0.12378105670329538, 0.1407592548832129, 0.058736057595709795, 0.05700439074739889, 0.14728234783203958, 0.2148957133578259, 0.07954512844968857, 0.1030985532015983, 0.010459822641440727, 0.05737455928138075, 0.1559446201057239, 0.13895900193366503, 0.03156699173602045, 0.04890539260876352, 0.04995541568895709, 0.06255157417661084, 0.002693013244577135, 0.012411591625591608, 0.15516673744807902],
    [0.15582045376539008, 0.09651232095756643, 0.06581709648315832, 0.10202663406854806, 0.08674852920264194, 0.08757634360644034, 0.12459823978884935, 0.1416906093289221, 0.05783440518753825, 0.09978536093497073, 0.04900072706893626, 0.12790783591802443, 0.07175906684433664, 0.013129716146784482, 0.17109377902469772, 0.09544172344153798, 0.04417753360227171, 0.03047421560521984, 0.1607741018133701, 0.042033567518396465, 0.09805830725702788, 0.011731084187142908, 0.12452129182889228, 0.14943716471837143, 0.13427476779100272, 0.0504358893497519, 0.09215230661051434, 0.016326041775071437, 0.09121164782573381, 0.147044359398728, 0.07474307101517241, 0.12029945627009313, 0.09549446633957638, 0.031050720834981428, 0.09817984181142858, 0.027752587507058002, 0.15052715078657608, 0.09338323652622518, 0.10733368634652816, 0.009015504756326845, 0.07260467220125497, 0.06131948225009717, 0.13738590080822852, 0.019516423196562774, 0.17743907744797185, 0.168463187880263, 0.10873049983503855, 0.04344061430414566, 0.02317115600283071, 0.07404125211975868, 0.15909114093868224, 0.06328187290927392, 0.061181260489395074, 0.10188121620373095, 0.11585556353592591, 0.04834423895093465, 0.04691894553961334, 0.12122456474448282, 0.17687550273822134, 0.06547168561472232, 0.08485794408914797, 0.00860922891084781, 0.04722362237342663, 0.12835427310079645, 0.11437381855119912, 0.02598203308013339, 0.04025285460153236, 0.04111710339130102, 0.05148469905089557, 0.0022165545513796675, 0.01021568310626363, 0.12771401655964718, 0.10469055633023704, 0.012671596541814639, 0.13664450703816816, 0.16984352667631633, 0.10355428462415937, 0.0015670128333073261, 0.067307501000118, 0.10497692090616872, 0.11203424888888858, 0.057958470933006, 0.14164031795438256, 0.11150493641279158, 0.0890139703593684, 0.14996141925632728, 0.030505049930856305, 0.05826029111642219, 0.027963282761809472, 0.06010840784689968, 0.17473043708133734, 0.12099758313300277, 0.014553883833494794, 0.07334636042494769, 0.07285006732780068, 0.17790630291056034, 0.0989301973089577, 0.13638374168904252, 0.17986942419707855, 0.040388703981232836],
    [0.1490765359911958, 0.09233526241995971, 0.06296852894216698, 0.0976109157574458, 0.08299404810701023, 0.08378603465806785, 0.11920562114578914, 0.13555823199591513, 0.0553313289630816, 0.09546664504785775, 0.04687997291732666, 0.12237197777320692, 0.06865333050063585, 0.012561461312757724, 0.16368883089666822, 0.09131100042306806, 0.042265527528094815, 0.029155289884568912, 0.153815789880318, 0.040214352413767675, 0.09381433834769744, 0.011223362220940966, 0.11913200349775391, 0.1429695160437834, 0.12846334848596738, 0.04825302129601608, 0.08816394973267236, 0.015619449792770343, 0.08726400271162271, 0.1406802714694426, 0.07150818680750592, 0.11509288921319505, 0.0913614606055903, 0.029706843936407743, 0.0939306128799265, 0.026551453999575543, 0.14401232745525105, 0.08934160493420577, 0.10268827852213556, 0.008625313216639324, 0.06946233801138785, 0.05866557169947423, 0.13143983149579208, 0.018671751331583056, 0.16975950445661273, 0.161172091881058, 0.1040246378463513, 0.04156050213755719, 0.022168307101803907, 0.07083674267232855, 0.15220566764447255, 0.06054302998342982, 0.058533332184146566, 0.09747179158578337, 0.11084132839998145, 0.046251897641031985, 0.044888291006624594, 0.11597795894213936, 0.1692203212911706, 0.06263806747503713, 0.08118528762078707, 0.008236621012006807, 0.04517978141038145, 0.12279909313025451, 0.10942371341935776, 0.0248575292652322, 0.038510708849485854, 0.0393375529042932, 0.049256438455844605, 0.002120621948981863, 0.00977354778184982, 0.12218654692727692, 0.10015954331772974, 0.012123169149384955, 0.13073052528871054, 0.16249268953840867, 0.09907244951333158, 0.0014991924320470194, 0.06439442866999417, 0.10043351401912919, 0.1071854004601844, 0.055450025136289674, 0.13551011723482043, 0.10667899665704653, 0.08516144084638168, 0.14347108081661994, 0.029184789698902848, 0.0557387825256351, 0.026753030352160315, 0.057506912662784994, 0.16716809419341475, 0.11576080110723733, 0.01392399094397694, 0.0701719259281324, 0.06969711242341488, 0.1702065083755876, 0.13916687524684004, 0.05350498510320062, 0.1415754204215561, 0.06957602019036072, 0.15092969351716987, 0.028763669977259567, 0.09378263985254962, 0.07190282975849477, 0.09464849295042106, 0.13048104587817877, 0.1720846656652933, 0.03864067866059161],
    [0.14423132094112415, 0.08933422540125728, 0.060921955602620925, 0.09443841194968906, 0.08029661481691686, 0.08106286059575217, 0.1153312564391741, 0.13115238246727773, 0.053532976284372855, 0.09236383331232718, 0.04535630221478635, 0.11839470164137629, 0.06642199243011034, 0.01215319463954323, 0.15836869395012684, 0.08834325348324733, 0.04089183334666819, 0.028207698445053192, 0.1488165418423116, 0.0389073245555702, 0.09076522910288898, 0.010858585811402444, 0.11526003147710948, 0.13832278846703247, 0.12428809350483766, 0.0466847244246111, 0.08529848674563507, 0.015111793824602163, 0.08442778937693121, 0.1361079478368881, 0.06918406154782372, 0.11135219457426855, 0.08839207363278813, 0.028741326148019417, 0.0908777245352768, 0.02568849120221335, 0.1393317069153209, 0.08643786635491431, 0.09935075267171747, 0.008344977366795651, 0.06720470596146004, 0.056758851040656824, 0.12716783627194342, 0.018064890902733784, 0.16424206134984198, 0.15593375279542385, 0.10064367827736079, 0.04020972235785182, 0.021447803271404914, 0.06853444037229196, 0.14725875103768507, 0.058575289063624865, 0.056630909511498614, 0.09430380952603941, 0.10723881597934645, 0.04474864034400212, 0.04342935300735328, 0.11220849818557717, 0.163720402460575, 0.060602234637766365, 0.07854664180835778, 0.007968918252321884, 0.0437113695279008, 0.11880793509714194, 0.10586727565020065, 0.024049621608251144, 0.03725905200848255, 0.038059022368970546, 0.047655528994591224, 0.002051698497585555, 0.009455892555355895, 0.11821529758108007, 0.09690420522267214, 0.011729147640724243, 0.12648158359965736, 0.15721142901244226, 0.0958524436268398, 0.001450466388834312, 0.06230151141203584, 0.09716927145794031, 0.10370171127996149, 0.05364781465071019, 0.13110583150938676, 0.10321176637367188, 0.08239356398278831, 0.1388080516188944, 0.02823623947037694, 0.05392718698398778, 0.02588351601554489, 0.05563785019185841, 0.16173487587711605, 0.1119983983118956, 0.01347143997725202, 0.06789123118741493, 0.06743184984661066, 0.16467453695890372, 0.1346437393023796, 0.05176599138864854, 0.1369740030812226, 0.06731469329603086, 0.14602424801785077, 0.027828806782710006, 0.09073456085723504, 0.06956587800031083, 0.049289988943616116, 0.15151295985733645, 0.12735852037121487, 0.003333862247204956, 0.05712354925607144, 0.08951490067034465, 0.08782182415229184, 0.0578016188069583, 0.09157227240732324, 0.12624021265090699, 0.16649165126886764, 0.03738479760227176],
    [0.1694589116999309, 0.10495973076633594, 0.07157785304667531, 0.11095669378356957, 0.09434134604936262, 0.09524161635770365, 0.1355039187996205, 0.1540923278989471, 0.06289646272400928, 0.10851924929627423, 0.053289601467273046, 0.13910319312249428, 0.07803990476341967, 0.014278917532309872, 0.18606906148410648, 0.10379542732894517, 0.04804424955083078, 0.0331415246623844, 0.17484613646324135, 0.04571262908307061, 0.10664103222246049, 0.012757867862499155, 0.13542023583479298, 0.16251691410696706, 0.1460274018511314, 0.05485037883855437, 0.10021809853261156, 0.017755007155458, 0.09919510694134144, 0.15991467431380685, 0.08128508912194579, 0.13082887672960547, 0.10385278664144561, 0.03376848952138687, 0.10677320430144628, 0.030181681301506596, 0.1637023031134973, 0.10155676774358248, 0.11672825510064294, 0.009804602589163004, 0.07895952320919036, 0.06668657725609006, 0.14941084223083015, 0.021224632294707106, 0.19296974325749094, 0.18320822324566463, 0.118247327134454, 0.047242830101371744, 0.02519925198639844, 0.08052184229937957, 0.17301587149245923, 0.06882072959230966, 0.06653625739386522, 0.11079854796562234, 0.12599602450612882, 0.052575653077750396, 0.0510256083660385, 0.13183495694235145, 0.19235684068489467, 0.07120220948743744, 0.0922852841648866, 0.009362766739239825, 0.05135695257298015, 0.13958870550104785, 0.12438458719824694, 0.028256155999520978, 0.043776056151534036, 0.044715949829245226, 0.05599098744442927, 0.0024105623679280823, 0.011109828649743763, 0.13889240938555025, 0.11385378050363983, 0.013780700207108917, 0.14860455667344946, 0.1847093786107272, 0.11261805462777208, 0.0017041683741461791, 0.07319870782750477, 0.11416520964027846, 0.12184024260650132, 0.06303138754099037, 0.15403763468383044, 0.12126460112952524, 0.09680507390833237, 0.16308705494091372, 0.03317505781633879, 0.06335962506420917]
    ]

# Xs are tangent vectors in a chart
Xs = [
    [-0.597609995187605, -0.4256244780566225, 0.039001131483688445, 0.2861310539156201, -0.5445479395430848, 0.5398107502679328, -0.370911828798264, 0.9784991722126772, -0.858313200235999, 0.6327050201672981],
    [-0.5103976757921316, -0.7856231887301031],
    [0.06161321757315563, -0.2461307077230097, 0.04558383266520161, 0.6251649963255619, 0.5702228612959974, -0.6849942773520477, 0.47667344530694655],
    [0.20291047527778772, -0.33259407228555404, 0.2518919563557016, 0.7589380540013582, 0.5699565849101806, -0.0840258727078147, 0.17702183701764684, -0.020864846013727956],
    [-0.5689099191621423, 0.544600536529926, -0.34916078856459043, 0.9822571022455582, 0.030233304809939243, 0.5950623927405945, 0.10709287674567114, -0.45335793482945186, -0.42415769187544816, 0.44897078165811233, -0.059509496330804046, -0.988472595808626, 0.7941397305966094, -0.1645857296563873, 0.6909105365607005, 0.8511592194074467],
    [-0.9098421775458598, -0.20952423053057156, 0.9924786336664817],
    [-0.33715222274078416, -0.26704690491931915, -0.5195355208430397, 0.645753717662719, 0.10444433627227578, 0.33684638019021196, 0.06539241093725567, 0.09555909109964422, 0.7542247481144044, -0.20290163218931467, -0.2664420819862636, 0.339548396803274, 0.9402884626822843, -0.6574225234652968, 0.07702642759782674, -0.5460026086958019, -0.6357161050460245, -0.5843960906310703, -0.2548940878123618, 0.6267033715997288, 0.08231062546698587, 0.15159625893365325, -0.12967230344148017],
    [0.42221703960978085, 0.6412610989675429, -0.3378728652151137, -0.7259095427151108, 0.3792220940510249, 0.09853495773970455, -0.03328822790230723, 0.10717331421952858, 0.9602549746343043, 0.36453406652382325, 0.05098955982227471, -0.8550440747345822, -0.13618136406595704, -0.6238820462729322, 0.15657227739200308, -0.7875237399365813, 0.3339506933166785, -0.7658809531191957],
    [0.8929561594617814, 0.9142838995513609, -0.9454002503436634, 0.599611685359211, -0.08033334402177683, 0.352934685220305, 0.9826231085574035, -0.13566440227650745, -0.15023573234217635, 0.8858256604892685, -0.9499508153272389, 0.6730026466902008],
    [-0.34597205746030824, 0.9028413427061659, 0.32181983134495096, 0.9413815779327186, 0.16359943156565016, 0.7838434998605843, -0.35087705212133735, -0.2339200570289206, -0.9229212375554967, 0.9129319387405792, -0.9083283912242541, 0.13034732808854765, 0.9882693345252747, 0.19949043337639316, 0.5191850007789172, 0.6832919121607344, 0.08923979072216182, -0.1641363924011765, 0.060902972183083826, -0.13189846296393637, 0.8496859744073246],
    [0.09276610111152617, 0.09805875319182467, 0.40149199598583674, 0.4121056057132706, -0.5187299383130162, 0.9808043473462107, 0.9121302771494377, -0.05119856203718953, 0.6638686937978975, 0.8072960740642445, 0.588215689842168, 0.5571754021224098, -0.8228465883832383, 0.09319381915262914, -0.2212392016482081, 0.4600044998096078, -0.7708333499135387, -0.7406857285885389, -0.8937974999435008, 0.19396510657575705, 0.5206418037886062, 0.4451978368270184, 0.8422191864577384, -0.018333885981625553, 0.6610697223081674, -0.14582004740489873],
    [0.22774235157623135, -0.9570617965471404, -0.7677114506774323, 0.7761020139166568, 0.5705454599965643, -0.38571286832595675, -0.789873188052665, 0.9318173591345504, 0.2627790302374746, -0.23646863157711917, -0.5637044935797642, 0.20520758669977424, 0.7064722394615206, -0.584610567954003, 0.6716584109355441, 0.25481219283479906, -0.9870528012093185, 0.4129387951226837, 0.2284244974693428, -0.7618228616844276],
    [-0.3508209068712791, 0.5477811869201115, 0.9576443316471701, 0.3815048454137753, -0.3581096313769696, -0.3297365896057076, 0.46016273166688904, -0.8346220116109249, -0.3150517800054915, 0.5838284430955387],
    [0.6225357146388626, 0.7513896391924713, 0.15368488777021372, 0.9474331253267687, -0.7931484910144164, 0.5669848314865438, 0.5833361007240527, -0.15116391703821175, 0.12146654441996918],
    [-0.6912699112418559, -0.2315737570979124, 0.6276350160464672, 0.706838194684831],
    [0.30756479319371266, -0.43184860921312285, 0.37624726262849206, 0.8139529250407125, -0.585675532332042, -0.5857479127690419, -0.45612298630613823, 0.2559126942459271, -0.7348456829025003, -0.8876636700373159],
    [0.9692875025266756, -0.23787854062334635, -0.24748080007875295, 0.7036144791890337, 0.882878776380204, 0.6653207722292824, -0.8471461307631554, 0.054870797521041625, 0.3479947908450005, -0.40254986389467895],
    [-0.5561604381577363, -0.6690805833024565, -0.49296974074635713],
    [0.5526596524494152, 0.9690315932495712, -0.8680156139856099, 0.39561955960098705, -0.7189141230781315, 0.1091438241240188, -0.1514792667377174, -0.8842187642857129, -0.90929587555064, 0.0553477365473245, -0.38102440387803127, -0.21972849843690567, -0.1366925641984078, 0.234658614104986, 0.6618349090074298, 0.3456641681297574, -0.13000537043751015, 0.015349401356097525, 0.4014083014273322, -0.05782560373055445, -0.3626979339434868, -0.46909114377791794, 0.037734998042463275],
    [-0.23849715068438293, 0.7921459122177519, 0.7585522723532372, 0.8898425015365772, 0.6681429223463302, -0.7046659515927074, -0.2533112691118138, -0.9895684050716598, 0.7064520294805683, -0.06906516907342031, 0.8213751152386364, -0.6183596959717537, 0.5207021021865952, 0.7449011143255648, 0.9149814958723772, -0.8454584370536609, 0.8033846014701953, 0.7737784202696005],
    [0.4835975048151546, -0.5987307405530511, 0.277769205131432, -0.5497708234569545, -0.9238315028510387, 0.5332814495117155, -0.5911554383083086, -0.9275056197495566, 0.5302218322249228, -0.7802927767456045, 0.20312945269109162, -0.2622275493784205, -0.17603338014279468, 0.45721842042830585, -0.07856217105142416, 0.458134032752032, 0.7601845863976819, -0.0687601004445304, 0.5084467209402248, -0.5503154953218936, 0.8116513645055918, -0.10424664785069293, -0.4650749134336116, 0.17127951460844226, -0.21534156550417394],
    [-0.6945216072262328, 0.06573632900997772, -0.106647523045865, 0.13865277008666044, -0.7820633695316517, -0.10880551946361727, 0.2658232882927578, -0.08490107870171215, 0.8401971948812119, -0.5389907554930264, 0.9847445142919777, 0.6022812602894703, 0.45645830164530143, -0.24553265752254427, 0.06468186895698413, 0.692893319789019, -0.19092820288195367, 0.45737634128864624, 0.10728439355457109, 0.5890201396380044, -0.9502112271317584, -0.2302405122715243, 0.8242967867244597, -0.7636718337376485, -0.2653389884306485, 0.500710013837995, -0.24084472766713083],
    [-0.8374018409716684, 0.4276765409684762, -0.6486173821583863, 0.08856823496937882, 0.557143175184845, -0.1985822093439542, -0.1801379487124286, 0.043017831672796714, -0.1929487463516646, -0.5763738177808153, -0.49637049997464744, 0.12581361013858916, 0.3855284958072094, 0.15109520635764673, 0.41672543545469565, -0.7485533043159125, 0.1884036602694128, 0.6381773143883831, 0.20656419313369856, 0.5496422308632847, 0.685510222422288, 0.17777973619459675, -0.2579184029541337, -0.2079419738929984, 0.6082747209746782, 0.5014782256507726, -0.7783280743075152, -0.5276060845071164, -0.9311912948488923],
    [0.6670456246431664, 0.07506905805544695, 0.8002014930850021, -0.761108481031973, -0.3309405791117992, -0.4968484241950417, 0.5855902060858931, 0.9782616605547247, 0.5179425134945737, 0.9992716621826399, 0.04240304791255256, 0.269024423156097, 0.3525829475191862, -0.43198618097746966, 0.3216754129865127, -0.7577084174756146, -0.4026041614694662, 0.1403933118873224, 0.7634052300441858, -0.5740345150905044, 0.912328468664054, -0.6498208158571068]
    ]

for (M, p, q, v, u, dy, X) in zip(Ms, ps, qs, vs, us, dys, Xs)
    V = typeof(M).parameters[2]

    @testset "Manifold $M" begin
        @testset "rand()" begin
            @test(is_point(M, rand(M)))
            @test(is_vector(M, p, rand(M, vector_at=p)))
        end

        @testset "exp()" begin
            @test(is_point(M, exp(M, p, v)))
            @test(isapprox(p, exp(M, p, 0.0 * v); atol=1e-5))

            geodesic_speed = finite_difference(t -> distance(M, p, exp(M, p, t * v)), -1.0, 1e-3)
            @test(isapprox(geodesic_speed, -norm(M, p, v); atol=1e-5))
            geodesic_speed = finite_difference(t -> distance(M, p, exp(M, p, t * v)), -0.811, 1e-3)
            @test(isapprox(geodesic_speed, -norm(M, p, v); atol=1e-5))
            geodesic_speed = finite_difference(t -> distance(M, p, exp(M, p, t * v)), -0.479, 1e-3)
            @test(isapprox(geodesic_speed, -norm(M, p, v); atol=1e-5))
            geodesic_speed = finite_difference(t -> distance(M, p, exp(M, p, t * v)), 0.181, 1e-3)
            @test(isapprox(geodesic_speed, norm(M, p, v); atol=1e-5))
            geodesic_speed = finite_difference(t -> distance(M, p, exp(M, p, t * v)), 0.703, 1e-3)
            @test(isapprox(geodesic_speed, norm(M, p, v); atol=1e-5))
            geodesic_speed = finite_difference(t -> distance(M, p, exp(M, p, t * v)), 1.0, 1e-3)
            @test(isapprox(geodesic_speed, norm(M, p, v); atol=1e-5))


            # Geodesics are (locally) length-minizing. So let B_a be a one-parameter
            # family of curves such that B_0 is a geodesic. Then the derivative of
            # length(B_a) at a = 0 should be 0, and the second derivative should be
            # nonnegative.

            n = manifold_dimension(M)
            x = get_coordinates(M, p, v)
            x0 = 0.0 * x
            x1 = 0.2 * x
            x2 = 0.4 * x
            x3 = 0.6 * x
            x4 = 0.8 * x
            x5 = 1.0 * x

            function curve_length(y::Vector{Float64})
                @assert(length(y) == 4 * n)

                # Control points
                y1 = y[1:n]
                y2 = y[(n + 1):(2 * n)]
                y3 = y[(2 * n + 1):(3 * n)]
                y4 = y[(3 * n + 1):(4 * n)]

                # Bezier curve from 0 to v with control points y1, ..., y4
                function b(t)
                    return (
                        (1 - t)^5 * x0 +
                        5 * t * (1 - t)^4 * (x1 + y1) +
                        10 * t^2 * (1 - t)^3 * (x2 + y2) +
                        10 * t^3 * (1 - t)^2 * (x3 + y3) +
                        5 * t^4 * (1 - t) * (x4 + y4) +
                        t^5 * x5
                    )
                end

                # Length of curve on manifold
                ps_ = [exp(M, p, get_vector(M, p, b(t))) for t in 0.0:1e-3:1.0]
                ds = [distance(M, p1, p2) for (p1, p2) in zip(ps_[1:(end - 1)], ps_[2:end])]
                return sum(ds)
            end

            # dy = rand(4 * n); dy = dy / norm(dy)
            f = a -> curve_length(a * dy)
            @test(isapprox(finite_difference(f, 0.0, 1e-3), 0.0; atol=1e-5))
            @test(finite_difference(f, 0.0, 1e-3; order=2) >= 0.0)
        end

        @testset "log()" begin
            @test(is_vector(M, p, log(M, p, q)))
            @test(isapprox(0.0 * v, log(M, p, p); atol=1e-5))
            @test(isapprox(q, exp(M, p, log(M, p, q)), atol=1e-10))
        end

        @testset "riemann_tensor()" begin

            # Test Riemann tensor by testing that sectional curvature is difference
            # between circumference and 2 pi r for small circles. Since the sectional
            # curvature contains the same information as the Riemann tensor, this
            # should be fine.

            sectional_curvature(M, p, u, v,) = inner(M, p, riemann_tensor(M, p, u, v, v), u) / (inner(M, p, u, u) * inner(M, p, v, v) - inner(M, p, u, v)^2)

            # Orthonormalize
            u_ = u / norm(M, p, u)
            v_ = v - inner(M, p, u_, v) * u_
            v_ = v_ / norm(M, p, v_)

            r = 1e-2
            ps_ = [
                exp(M, p, r * (cos(theta) * u_ + sin(theta) * v_)) for
                theta in 0.0:1e-3:(2 * pi)
            ]
            ds = [distance(M, p1, p2) for (p1, p2) in zip(ps_, [ps_[2:end]..., ps_[1]])]
            C = sum(ds)
            K = 3 * (2 * pi * r - C) / (pi * r^3) # https://en.wikipedia.org/wiki/Bertrand%E2%80%93Diguet%E2%80%93Puiseux_theorem

            @test(isapprox(K, sectional_curvature(M, p, u, v); rtol=1e-2, atol=1e-2))
        end

        @testset "get_coordinates()" begin
            @test(isapprox(v, get_vector(M, p, get_coordinates(M, p, v))))
        end

        @testset "get_vector()" begin
            @test(isapprox(X, get_coordinates(M, p, get_vector(M, p, X))))
        end

    end
end

# TODO: Test that distance and inner are compatible
