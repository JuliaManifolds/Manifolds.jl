<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Symplectic Stiefel · Manifolds.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img class="docs-light-only" src="../assets/logo.png" alt="Manifolds.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.png" alt="Manifolds.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">Manifolds.jl</a></span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Manifolds</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox" checked/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Basic manifolds</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="centeredmatrices.html">Centered matrices</a></li><li><a class="tocitem" href="choleskyspace.html">Cholesky space</a></li><li><a class="tocitem" href="circle.html">Circle</a></li><li><a class="tocitem" href="elliptope.html">Elliptope</a></li><li><a class="tocitem" href="essentialmanifold.html">Essential manifold</a></li><li><a class="tocitem" href="euclidean.html">Euclidean</a></li><li><a class="tocitem" href="fixedrankmatrices.html">Fixed-rank matrices</a></li><li><a class="tocitem" href="generalizedstiefel.html">Generalized Stiefel</a></li><li><a class="tocitem" href="generalizedgrassmann.html">Generalized Grassmann</a></li><li><a class="tocitem" href="grassmann.html">Grassmann</a></li><li><a class="tocitem" href="hyperbolic.html">Hyperbolic space</a></li><li><a class="tocitem" href="lorentz.html">Lorentzian manifold</a></li><li><a class="tocitem" href="multinomialdoublystochastic.html">Multinomial doubly stochastic matrices</a></li><li><a class="tocitem" href="multinomial.html">Multinomial matrices</a></li><li><a class="tocitem" href="multinomialsymmetric.html">Multinomial symmetric matrices</a></li><li><a class="tocitem" href="oblique.html">Oblique manifold</a></li><li><a class="tocitem" href="probabilitysimplex.html">Probability simplex</a></li><li><a class="tocitem" href="positivenumbers.html">Positive numbers</a></li><li><a class="tocitem" href="projectivespace.html">Projective space</a></li><li><a class="tocitem" href="generalunitary.html">Orthogonal and Unitary Matrices</a></li><li><a class="tocitem" href="rotations.html">Rotations</a></li><li><a class="tocitem" href="skewhermitian.html">Skew-Hermitian matrices</a></li><li><a class="tocitem" href="spectrahedron.html">Spectrahedron</a></li><li><a class="tocitem" href="sphere.html">Sphere</a></li><li><a class="tocitem" href="stiefel.html">Stiefel</a></li><li><a class="tocitem" href="symmetric.html">Symmetric matrices</a></li><li><a class="tocitem" href="symmetricpositivedefinite.html">Symmetric positive definite</a></li><li><a class="tocitem" href="symmetricpsdfixedrank.html">Symmetric positive semidefinite fixed rank</a></li><li><a class="tocitem" href="symplectic.html">Symplectic</a></li><li class="is-active"><a class="tocitem" href="symplecticstiefel.html">Symplectic Stiefel</a><ul class="internal"><li><a class="tocitem" href="#Literature"><span>Literature</span></a></li></ul></li><li><a class="tocitem" href="torus.html">Torus</a></li><li><a class="tocitem" href="tucker.html">Tucker</a></li><li><a class="tocitem" href="spheresymmetricmatrices.html">Unit-norm symmetric matrices</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Combined manifolds</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="graph.html">Graph manifold</a></li><li><a class="tocitem" href="power.html">Power manifold</a></li><li><a class="tocitem" href="product.html">Product manifold</a></li><li><a class="tocitem" href="vector_bundle.html">Vector bundle</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Manifold decorators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="connection.html">Connection manifold</a></li><li><a class="tocitem" href="group.html">Group manifold</a></li><li><a class="tocitem" href="metric.html">Metric manifold</a></li><li><a class="tocitem" href="quotient.html">Quotient manifold</a></li></ul></li></ul></li><li><span class="tocitem">Features on Manifolds</span><ul><li><a class="tocitem" href="../features/atlases.html">Atlases and charts</a></li><li><a class="tocitem" href="../features/differentiation.html">Differentiation</a></li><li><a class="tocitem" href="../features/distributions.html">Distributions</a></li><li><a class="tocitem" href="../features/statistics.html">Statistics</a></li><li><a class="tocitem" href="../features/testing.html">Testing</a></li><li><a class="tocitem" href="../features/utilities.html">Utilities</a></li></ul></li><li><span class="tocitem">Miscellanea</span><ul><li><a class="tocitem" href="../misc/about.html">About</a></li><li><a class="tocitem" href="../misc/contributing.html">Contributing</a></li><li><a class="tocitem" href="../misc/internals.html">Internals</a></li><li><a class="tocitem" href="../misc/notation.html">Notation</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manifolds</a></li><li><a class="is-disabled">Basic manifolds</a></li><li class="is-active"><a href="symplecticstiefel.html">Symplectic Stiefel</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="symplecticstiefel.html">Symplectic Stiefel</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/master/docs/src/manifolds/symplecticstiefel.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Symplectic-Stiefel"><a class="docs-heading-anchor" href="#Symplectic-Stiefel">Symplectic Stiefel</a><a id="Symplectic-Stiefel-1"></a><a class="docs-heading-anchor-permalink" href="#Symplectic-Stiefel" title="Permalink"></a></h1><p>The <a href="symplecticstiefel.html#Manifolds.SymplecticStiefel"><code>SymplecticStiefel</code></a> manifold, denoted <span>$\operatorname{SpSt}(2n, 2k)$</span>,  represents canonical symplectic bases of <span>$2k$</span> dimensonal symplectic subspaces of <span>$\mathbb{R}^{2n \times 2n}$</span>.  This means that the columns of each element <span>$p \in \operatorname{SpSt}(2n, 2k) \subset \mathbb{R}^{2n \times 2k}$</span>  constitute a canonical symplectic basis of <span>$\operatorname{span}(p)$</span>.  The canonical symplectic form is a non-degenerate, bilinear, and skew symmetric map  <span>$\omega_{2k}\colon \mathbb{F}^{2k} \times \mathbb{F}^{2k}  \rightarrow \mathbb{F}$</span>, given by <span>$\omega_{2k}(x, y) = x^T Q_{2k} y$</span> for elements <span>$x, y \in \mathbb{F}^{2k}$</span>, with</p><p class="math-container">\[    Q_{2k} = 
    \begin{bmatrix}
     0_k  &amp;  I_k \\
    -I_k  &amp;  0_k
    \end{bmatrix}.\]</p><p>Specifically given an element <span>$p \in \operatorname{SpSt}(2n, 2k)$</span> we require that</p><p class="math-container">\[    \omega_{2n} (p x, p y) = x^T(p^TQ_{2n}p)y = x^TQ_{2k}y = \omega_{2k}(x, y) \;\forall\; x, y \in \mathbb{F}^{2k},\]</p><p>leading to the requirement on <span>$p$</span> that <span>$p^TQ_{2n}p = Q_{2k}$</span>. In the case that <span>$k = n$</span>, this manifold reduces to the <a href="symplectic.html#Manifolds.Symplectic"><code>Symplectic</code></a> manifold, which is also known as the symplectic group.</p><article class="docstring"><header><a class="docstring-binding" id="Manifolds.SymplecticStiefel" href="#Manifolds.SymplecticStiefel"><code>Manifolds.SymplecticStiefel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SymplecticStiefel{n, k, 𝔽} &lt;: AbstractEmbeddedManifold{𝔽, DefaultIsometricEmbeddingType}</code></pre><p>The symplectic Stiefel manifold consists of all <span>$2n × 2k, \; n \geq k$</span> matrices satisfying the requirement</p><p class="math-container">\[\operatorname{SpSt}(2n, 2k, ℝ)
    = \bigl\{ p ∈ ℝ^{2n × 2n} \, \big| \, p^TQ_{2n}p = Q_{2k} \bigr\},\]</p><p>where</p><p class="math-container">\[Q_{2n} =
\begin{bmatrix}
  0_n &amp; I_n \\
 -I_n &amp; 0_n
\end{bmatrix}.\]</p><p>The symplectic Stiefel tangent space at <span>$p$</span> can be parametrized as <sup class="footnote-reference"><a id="citeref-Bendokat2021" href="#footnote-Bendokat2021">[Bendokat2021]</a></sup></p><p class="math-container">\[    \begin{align*}
    T_p\operatorname{SpSt}(2n, 2k)
    = \{&amp;X \in \mathbb{R}^{2n \times 2k} \;|\; p^{T}Q_{2n}X + X^{T}Q_{2n}p = 0 \}, \\
    = \{&amp;X = pΩ + p^sB \;|\;
        Ω ∈ ℝ^{2k × 2k}, Ω^+ = -Ω, \\
        &amp;\; p^s ∈ \operatorname{SpSt}(2n, 2(n- k)), B ∈ ℝ^{2(n-k) × 2k}, \},
    \end{align*}\]</p><p>where <span>$Ω \in \mathfrak{sp}(2n,F)$</span> is Hamiltonian and <span>$p^s$</span> means the symplectic complement of <span>$p$</span> s.t. <span>$p^{+}p^{s} = 0$</span>.</p><p><strong>Constructor</strong></p><pre><code class="nohighlight hljs">SymplecticStiefel(2n::Int, 2k::Int, field::AbstractNumbers=ℝ)
    -&gt; SymplecticStiefel{div(2n, 2), div(2k, 2), field}()</code></pre><p>Generate the (real-valued) symplectic Stiefel manifold of <span>$2n \times 2k$</span> matrices which span a <span>$2k$</span> dimensional symplectic subspace of <span>$ℝ^{2n \times 2n}$</span>. The constructor for the <a href="symplecticstiefel.html#Manifolds.SymplecticStiefel"><code>SymplecticStiefel</code></a> manifold accepts the even column dimension <span>$2n$</span> and an even number of columns <span>$2k$</span> for the real symplectic Stiefel manifold with elements <span>$p \in ℝ^{2n × 2k}$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/d817d1cdaff65d57277622c51c69f594b66bf025/src/manifolds/SymplecticStiefel.jl#L1-L41">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.exp-Tuple{SymplecticStiefel, Any, Any}" href="#Base.exp-Tuple{SymplecticStiefel, Any, Any}"><code>Base.exp</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">exp(::SymplecticStiefel, p, X)
exp!(M::SymplecticStiefel, q, p, X)</code></pre><p>Compute the exponential mapping</p><p class="math-container">\[    \operatorname{exp}\colon T\operatorname{SpSt}(2n, 2k)
    \rightarrow \operatorname{SpSt}(2n, 2k)\]</p><p>at a point <span>$p \in  \operatorname{SpSt}(2n, 2k)$</span> in the direction of <span>$X \in T_p\operatorname{SpSt}(2n, 2k)$</span>.</p><p>The tangent vector <span>$X$</span> can be written in the form <span>$X = \bar{\Omega}p$</span> <sup class="footnote-reference"><a id="citeref-Bendokat2021" href="#footnote-Bendokat2021">[Bendokat2021]</a></sup>, with</p><p class="math-container">\[    \bar{\Omega} = X (p^Tp)^{-1}p^T
        + Q_{2n}p(p^Tp)^{-1}X^T(I_{2n} - Q_{2n}^Tp(p^Tp)^{-1}p^TQ_{2n})Q_{2n}
        \in ℝ^{2n \times 2n},\]</p><p>where <span>$Q_{2n}$</span> is the <a href="symplectic.html#Manifolds.SymplecticMatrix"><code>SymplecticMatrix</code></a>. Using this expression for <span>$X$</span>, the exponential mapping can be computed as</p><p class="math-container">\[    \operatorname{exp}_p(X) = \operatorname{Exp}([\bar{\Omega} - \bar{\Omega}^T])
                              \operatorname{Exp}(\bar{\Omega}^T)p,\]</p><p>where <span>$\operatorname{Exp}(\cdot)$</span> denotes the matrix exponential.</p><p>Computing the above mapping directly however, requires taking matrix exponentials of two <span>$2n \times 2n$</span> matrices, which is computationally expensive when <span>$n$</span> increases. Therefore we instead follow <sup class="footnote-reference"><a id="citeref-Bendokat2021" href="#footnote-Bendokat2021">[Bendokat2021]</a></sup> who express the above exponential mapping in a way which only requires taking matrix exponentials of an <span>$8k \times 8k$</span> matrix and a <span>$4k \times 4k$</span> matrix.</p><p>To this end, first define</p><p class="math-container">\[\bar{A} = Q_{2k}p^TX(p^Tp)^{-1}Q_{2k} +
            (p^Tp)^{-1}X^T(p - Q_{2n}^Tp(p^Tp)^{-1}Q_{2k}) \in ℝ^{2k \times 2k},\]</p><p>and</p><p class="math-container">\[\bar{H} = (I_{2n} - pp^+)Q_{2n}X(p^Tp)^{-1}Q_{2k} \in ℝ^{2n \times 2k}.\]</p><p>We then let <span>$\bar{\Delta} = p\bar{A} + \bar{H}$</span>, and define the matrices</p><p class="math-container">\[    γ = \left[\left(I_{2n} - \frac{1}{2}pp^+\right)\bar{\Delta} \quad
              -p \right] \in ℝ^{2n \times 4k},\]</p><p>and</p><p class="math-container">\[    λ = \left[Q_{2n}^TpQ_{2k} \quad
        \left(\bar{\Delta}^+\left(I_{2n}
              - \frac{1}{2}pp^+\right)\right)^T\right] \in ℝ^{2n \times 4k}.\]</p><p>With the above defined matrices it holds that <span>$\bar{\Omega} = λγ^T$</span>.  As a last preliminary step, concatenate <span>$γ$</span> and <span>$λ$</span> to define the matrices <span>$Γ = [λ \quad -γ] \in ℝ^{2n \times 8k}$</span> and <span>$Λ = [γ \quad λ] \in ℝ^{2n \times 8k}$</span>.</p><p>With these matrix constructions done, we can compute the exponential mapping as</p><p class="math-container">\[    \operatorname{exp}_p(X) =
        Γ \operatorname{Exp}(ΛΓ^T)
        \begin{bmatrix}
            0_{4k} \\
            I_{4k}
        \end{bmatrix}
        \operatorname{Exp}(λγ^T)
        \begin{bmatrix}
            0_{2k} \\
            I_{2k}
        \end{bmatrix}.\]</p><p>which only requires computing the matrix exponentials of <span>$ΛΓ^T \in ℝ^{8k \times 8k}$</span> and <span>$λγ^T \in ℝ^{4k \times 4k}$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/d817d1cdaff65d57277622c51c69f594b66bf025/src/manifolds/SymplecticStiefel.jl#L154-L229">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.inv-Union{Tuple{k}, Tuple{n}, Tuple{SymplecticStiefel{n, k, 𝔽} where 𝔽, Any}} where {n, k}" href="#Base.inv-Union{Tuple{k}, Tuple{n}, Tuple{SymplecticStiefel{n, k, 𝔽} where 𝔽, Any}} where {n, k}"><code>Base.inv</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">inv(::SymplecticStiefel{n, k}, A)
inv!(::SymplecticStiefel{n, k}, q, p)</code></pre><p>Compute the symplectic inverse <span>$A^+$</span> of matrix <span>$A ∈ ℝ^{2n × 2k}$</span>. Given a matrix</p><p class="math-container">\[A ∈ ℝ^{2n × 2k},\quad
A =
\begin{bmatrix}
A_{1, 1} &amp; A_{1, 2} \\
A_{2, 1} &amp; A_{2, 2}
\end{bmatrix},\; A_{i, j} \in ℝ^{2n × 2k}\]</p><p>the symplectic inverse is defined as:</p><p class="math-container">\[A^{+} := Q_{2k}^T A^T Q_{2n},\]</p><p>where</p><p class="math-container">\[Q_{2n} =
\begin{bmatrix}
0_n &amp; I_n \\
 -I_n &amp; 0_n
\end{bmatrix}.\]</p><p>For any <span>$p \in \operatorname{SpSt}(2n, 2k)$</span> we have that <span>$p^{+}p = I_{2k}$</span>.</p><p>The symplectic inverse of a matrix A can be expressed explicitly as:</p><p class="math-container">\[A^{+} =
\begin{bmatrix}
  A_{2, 2}^T &amp; -A_{1, 2}^T \\[1.2mm]
 -A_{2, 1}^T &amp;  A_{1, 1}^T
\end{bmatrix}.\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/d817d1cdaff65d57277622c51c69f594b66bf025/src/manifolds/SymplecticStiefel.jl#L351-L386">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.rand-Union{Tuple{SymplecticStiefel{n, k, 𝔽} where {k, 𝔽}}, Tuple{n}} where n" href="#Base.rand-Union{Tuple{SymplecticStiefel{n, k, 𝔽} where {k, 𝔽}}, Tuple{n}} where n"><code>Base.rand</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rand(M::SymplecticStiefel; vector_at=nothing,
    hamiltonian_norm=(vector_at === nothing ? 1/2 : 1.0))</code></pre><p>Generate a random point <span>$p \in \operatorname{SpSt}(2n, 2k)$</span> or a random tangent vector <span>$X \in T_p\operatorname{SpSt}(2n, 2k)$</span> if <code>vector_at</code> is set to a point <span>$p \in \operatorname{Sp}(2n)$</span>.</p><p>A random point on <span>$\operatorname{SpSt}(2n, 2k)$</span> is found by first generating a random point on the symplectic manifold <span>$\operatorname{Sp}(2n)$</span>, and then projecting onto the Symplectic Stiefel manifold using the <a href="quotient.html#Manifolds.canonical_project-Tuple{AbstractManifold, Any}"><code>canonical_project</code></a> <span>$π_{\operatorname{SpSt}(2n, 2k)}$</span>. That is, <span>$p = π_{\operatorname{SpSt}(2n, 2k)}(p_{\operatorname{Sp}})$</span>.</p><p>To generate a random tangent vector in <span>$T_p\operatorname{SpSt}(2n, 2k)$</span> this code exploits the second tangent vector space parametrization of <a href="symplecticstiefel.html#Manifolds.SymplecticStiefel"><code>SymplecticStiefel</code></a>, showing that any <span>$X \in T_p\operatorname{SpSt}(2n, 2k)$</span> can be written as <span>$X = pΩ_X + p^sB_X$</span>. To generate random tangent vectors at <span>$p$</span> then, this function sets <span>$B_X = 0$</span> and generates a random Hamiltonian matrix <span>$Ω_X \in \mathfrak{sp}(2n,F)$</span> with Frobenius norm of <code>hamiltonian_norm</code> before returning <span>$X = pΩ_X$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/d817d1cdaff65d57277622c51c69f594b66bf025/src/manifolds/SymplecticStiefel.jl#L507-L528">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Manifolds.canonical_project-Union{Tuple{k}, Tuple{n}, Tuple{SymplecticStiefel{n, k, 𝔽} where 𝔽, Any}} where {n, k}" href="#Manifolds.canonical_project-Union{Tuple{k}, Tuple{n}, Tuple{SymplecticStiefel{n, k, 𝔽} where 𝔽, Any}} where {n, k}"><code>Manifolds.canonical_project</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">canonical_project(::SymplecticStiefel, p_Sp)
canonical_project!(::SymplecticStiefel{n,k}, p, p_Sp)</code></pre><p>Define the canonical projection from <span>$\operatorname{Sp}(2n, 2n)$</span> onto <span>$\operatorname{SpSt}(2n, 2k)$</span>, by projecting onto the first <span>$k$</span> columns and the <span>$n + 1$</span>&#39;th onto the <span>$n + k$</span>&#39;th columns <sup class="footnote-reference"><a id="citeref-Bendokat2021" href="#footnote-Bendokat2021">[Bendokat2021]</a></sup>.</p><p>It is assumed that the point <span>$p$</span> is on <span>$\operatorname{Sp}(2n, 2n)$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/d817d1cdaff65d57277622c51c69f594b66bf025/src/manifolds/SymplecticStiefel.jl#L58-L67">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Manifolds.get_total_space-Union{Tuple{SymplecticStiefel{n, k, 𝔽}}, Tuple{𝔽}, Tuple{k}, Tuple{n}} where {n, k, 𝔽}" href="#Manifolds.get_total_space-Union{Tuple{SymplecticStiefel{n, k, 𝔽}}, Tuple{𝔽}, Tuple{k}, Tuple{n}} where {n, k, 𝔽}"><code>Manifolds.get_total_space</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_total_space(::SymplecticStiefel)</code></pre><p>Return the total space of the <a href="symplecticstiefel.html#Manifolds.SymplecticStiefel"><code>SymplecticStiefel</code></a> manifold, which is the corresponding <a href="symplectic.html#Manifolds.Symplectic"><code>Symplectic</code></a> manifold.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/d817d1cdaff65d57277622c51c69f594b66bf025/src/manifolds/SymplecticStiefel.jl#L281-L285">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Manifolds.gradient-Tuple{SymplecticStiefel, Any, Any, Manifolds.RiemannianProjectionBackend}" href="#Manifolds.gradient-Tuple{SymplecticStiefel, Any, Any, Manifolds.RiemannianProjectionBackend}"><code>Manifolds.gradient</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">gradient(::SymplecticStiefel, f, p, backend::RiemannianProjectionBackend)
gradient!(::SymplecticStiefel, f, X, p, backend::RiemannianProjectionBackend)</code></pre><p>Compute the gradient of <span>$f\colon \operatorname{SpSt}(2n, 2k) \rightarrow ℝ$</span> at <span>$p \in \operatorname{SpSt}(2n, 2k)$</span>.</p><p>This function first computes the embedding gradient <span>$∇f(p) \in ℝ^{2n \times 2k}$</span> using the <a href="../features/differentiation.html#Manifolds.AbstractRiemannianDiffBackend"><code>AbstractRiemannianDiffBackend</code></a> in the <a href="../features/differentiation.html#Manifolds.RiemannianProjectionBackend"><code>RiemannianProjectionBackend</code></a>. Then it transforms the embedding gradient to the unique tangent vector space element <span>$\text{grad}f(p) \in T_p\operatorname{SpSt}(2n, 2k)$</span> which fulfills the variational equation</p><p class="math-container">\[    g_p(\text{grad}f(p), X)
    = \text{D}f(p)
    = \langle ∇f(p), X \rangle
    \quad\forall\; X \in T_p\operatorname{SpSt}(2n, 2k).\]</p><p>The manifold gradient <span>$\text{grad}f(p)$</span> is computed from <span>$∇f(p)$</span> as</p><p class="math-container">\[    \text{grad}f(p) = ∇f(p)p^Tp + Q_{2n}p∇f(p)^TQ_{2n}p,\]</p><p>where <span>$Q_{2n}$</span> is the <a href="symplectic.html#Manifolds.SymplecticMatrix"><code>SymplecticMatrix</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/d817d1cdaff65d57277622c51c69f594b66bf025/src/manifolds/SymplecticStiefel.jl#L288-L312">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Manifolds.symplectic_inverse_times-Union{Tuple{k}, Tuple{n}, Tuple{SymplecticStiefel{n, k, 𝔽} where 𝔽, Any, Any}} where {n, k}" href="#Manifolds.symplectic_inverse_times-Union{Tuple{k}, Tuple{n}, Tuple{SymplecticStiefel{n, k, 𝔽} where 𝔽, Any, Any}} where {n, k}"><code>Manifolds.symplectic_inverse_times</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">symplectic_inverse_times(::SymplecticStiefel, p, q)
symplectic_inverse_times!(::SymplecticStiefel, A, p, q)</code></pre><p>Directly compute the symplectic inverse of <span>$p \in \operatorname{SpSt}(2n, 2k)$</span>, multiplied with <span>$q \in \operatorname{SpSt}(2n, 2k)$</span>. That is, this function efficiently computes <span>$p^+q = (Q_{2k}p^TQ_{2n})q \in ℝ^{2k \times 2k}$</span>, where <span>$Q_{2n}, Q_{2k}$</span> are the <a href="symplectic.html#Manifolds.SymplecticMatrix"><code>SymplecticMatrix</code></a> of sizes <span>$2n \times 2n$</span> and <span>$2k \times 2k$</span> respectively.</p><p>This function performs this common operation without allocating more than a <span>$2k \times 2k$</span> matrix to store the result in, or in the case of the in-place function, without allocating memory at all.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/d817d1cdaff65d57277622c51c69f594b66bf025/src/manifolds/SymplecticStiefel.jl#L606-L620">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ManifoldsBase.check_point-Union{Tuple{k}, Tuple{n}, Tuple{SymplecticStiefel{n, k, 𝔽} where 𝔽, Any}} where {n, k}" href="#ManifoldsBase.check_point-Union{Tuple{k}, Tuple{n}, Tuple{SymplecticStiefel{n, k, 𝔽} where 𝔽, Any}} where {n, k}"><code>ManifoldsBase.check_point</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">check_point(M::SymplecticStiefel, p; kwargs...)</code></pre><p>Check whether <code>p</code> is a valid point on the <a href="symplecticstiefel.html#Manifolds.SymplecticStiefel"><code>SymplecticStiefel</code></a>, <span>$\operatorname{SpSt}(2n, 2k)$</span> manifold. That is, the point has the right <a href="https://juliamanifolds.github.io/ManifoldsBase.jl/stable/types.html#number-system"><code>AbstractNumbers</code></a> type and <span>$p^{+}p$</span> is (approximately) the identity, where for <span>$A \in \mathbb{R}^{2n \times 2k}$</span>, <span>$A^{+} = Q_{2k}^TA^TQ_{2n}$</span> is the symplectic inverse, with</p><p class="math-container">\[Q_{2n} =
\begin{bmatrix}
0_n &amp; I_n \\
 -I_n &amp; 0_n
\end{bmatrix}.\]</p><p>The tolerance can be set with <code>kwargs...</code> (e.g. <code>atol = 1.0e-14</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/d817d1cdaff65d57277622c51c69f594b66bf025/src/manifolds/SymplecticStiefel.jl#L79-L96">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ManifoldsBase.check_vector-Tuple{SymplecticStiefel, Vararg{Any, N} where N}" href="#ManifoldsBase.check_vector-Tuple{SymplecticStiefel, Vararg{Any, N} where N}"><code>ManifoldsBase.check_vector</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">check_vector(M::Symplectic, p, X; kwargs...)</code></pre><p>Checks whether <code>X</code> is a valid tangent vector at <code>p</code> on the <a href="symplecticstiefel.html#Manifolds.SymplecticStiefel"><code>SymplecticStiefel</code></a>, <span>$\operatorname{SpSt}(2n, 2k)$</span> manifold. First recall the definition of the symplectic inverse for <span>$A \in \mathbb{R}^{2n \times 2k}$</span>, <span>$A^{+} = Q_{2k}^TA^TQ_{2n}$</span> is the symplectic inverse, with</p><p class="math-container">\[    Q_{2n} =
    \begin{bmatrix}
    0_n &amp; I_n \\
     -I_n &amp; 0_n
\end{bmatrix}.\]</p><p>The we check that <span>$H = p^{+}X \in 𝔤_{2k}$</span>, where <span>$𝔤$</span> is the Lie Algebra of the symplectic group <span>$\operatorname{Sp}(2k)$</span>, characterized as <sup class="footnote-reference"><a id="citeref-Bendokat2021" href="#footnote-Bendokat2021">[Bendokat2021]</a></sup>,</p><p class="math-container">\[    𝔤_{2k} = \{H \in ℝ^{2k \times 2k} \;|\; H^+ = -H \}.\]</p><p>The tolerance can be set with <code>kwargs...</code> (e.g. <code>atol = 1.0e-14</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/d817d1cdaff65d57277622c51c69f594b66bf025/src/manifolds/SymplecticStiefel.jl#L112-L133">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ManifoldsBase.inner-Union{Tuple{k}, Tuple{n}, Tuple{SymplecticStiefel{n, k, 𝔽} where 𝔽, Any, Any, Any}} where {n, k}" href="#ManifoldsBase.inner-Union{Tuple{k}, Tuple{n}, Tuple{SymplecticStiefel{n, k, 𝔽} where 𝔽, Any, Any, Any}} where {n, k}"><code>ManifoldsBase.inner</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">inner(M::SymplecticStiefel{n, k}, p, X. Y)</code></pre><p>Compute the Riemannian inner product <span>$g^{\operatorname{SpSt}}$</span> at <span>$p \in \operatorname{SpSt}$</span> between tangent vectors <span>$X, X \in T_p\operatorname{SpSt}$</span>. Given by Proposition 3.10 in <sup class="footnote-reference"><a id="citeref-Bendokat2021" href="#footnote-Bendokat2021">[Bendokat2021]</a></sup>.</p><p class="math-container">\[g^{\operatorname{SpSt}}_p(X, Y)
    = \operatorname{tr}\left(X^T\left(I_{2n} -
        \frac{1}{2}Q_{2n}^Tp(p^Tp)^{-1}p^TQ_{2n}\right)Y(p^Tp)^{-1}\right).\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/d817d1cdaff65d57277622c51c69f594b66bf025/src/manifolds/SymplecticStiefel.jl#L326-L337">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ManifoldsBase.inverse_retract-Tuple{SymplecticStiefel, Any, Any, CayleyInverseRetraction}" href="#ManifoldsBase.inverse_retract-Tuple{SymplecticStiefel, Any, Any, CayleyInverseRetraction}"><code>ManifoldsBase.inverse_retract</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">inverse_retract(::SymplecticStiefel, p, q, ::CayleyInverseRetraction)
inverse_retract!(::SymplecticStiefel, q, p, X, ::CayleyInverseRetraction)</code></pre><p>Compute the Cayley Inverse Retraction <span>$X = \mathcal{L}_p^{\operatorname{SpSt}}(q)$</span> such that the Cayley Retraction from <span>$p$</span> along <span>$X$</span> lands at <span>$q$</span>, i.e. <span>$\mathcal{R}_p(X) = q$</span> <sup class="footnote-reference"><a id="citeref-Bendokat2021" href="#footnote-Bendokat2021">[Bendokat2021]</a></sup>.</p><p>First, recall the definition the standard symplectic matrix</p><p class="math-container">\[Q =
\begin{bmatrix}
 0    &amp;  I \\
-I    &amp;  0
\end{bmatrix}\]</p><p>as well as the symplectic inverse of a matrix <span>$A$</span>, <span>$A^{+} = Q^T A^T Q$</span>.</p><p>For <span>$p, q ∈ \operatorname{SpSt}(2n, 2k, ℝ)$</span> then, we can define the inverse cayley retraction as long as the following matrices exist.</p><p class="math-container">\[    U = (I + p^+ q)^{-1} \in ℝ^{2k \times 2k},
    \quad
    V = (I + q^+ p)^{-1} \in ℝ^{2k \times 2k}.\]</p><p>If that is the case, the inverse cayley retration at <span>$p$</span> applied to <span>$q$</span> is</p><p class="math-container">\[\mathcal{L}_p^{\operatorname{Sp}}(q) = 2p\bigl(V - U\bigr) + 2\bigl((p + q)U - p\bigr)
                                        ∈ T_p\operatorname{Sp}(2n).\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/d817d1cdaff65d57277622c51c69f594b66bf025/src/manifolds/SymplecticStiefel.jl#L410-L446">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ManifoldsBase.manifold_dimension-Union{Tuple{SymplecticStiefel{n, k, 𝔽} where 𝔽}, Tuple{k}, Tuple{n}} where {n, k}" href="#ManifoldsBase.manifold_dimension-Union{Tuple{SymplecticStiefel{n, k, 𝔽} where 𝔽}, Tuple{k}, Tuple{n}} where {n, k}"><code>ManifoldsBase.manifold_dimension</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">manifold_dimension(::SymplecticStiefel{n, k})</code></pre><p>Returns the dimension of the symplectic Stiefel manifold embedded in <span>$ℝ^{2n \times 2k}$</span>, i.e. <sup class="footnote-reference"><a id="citeref-Bendokat2021" href="#footnote-Bendokat2021">[Bendokat2021]</a></sup></p><p class="math-container">\[    \operatorname{dim}(\operatorname{SpSt}(2n, 2k)) = (4n - 2k + 1)k.\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/d817d1cdaff65d57277622c51c69f594b66bf025/src/manifolds/SymplecticStiefel.jl#L457-L465">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ManifoldsBase.project-Tuple{SymplecticStiefel, Any, Any}" href="#ManifoldsBase.project-Tuple{SymplecticStiefel, Any, Any}"><code>ManifoldsBase.project</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">project(::SymplecticStiefel, p, A)
project!(::SymplecticStiefel, Y, p, A)</code></pre><p>Given a point <span>$p \in \operatorname{SpSt}(2n, 2k)$</span>, project an element <span>$A \in \mathbb{R}^{2n \times 2k}$</span> onto the tangent space <span>$T_p\operatorname{SpSt}(2n, 2k)$</span> relative to the euclidean metric of the embedding <span>$\mathbb{R}^{2n \times 2k}$</span>.</p><p>That is, we find the element <span>$X \in T_p\operatorname{SpSt}(2n, 2k)$</span> which solves the constrained optimization problem</p><p class="math-container">\[    \operatorname{min}_{X \in \mathbb{R}^{2n \times 2k}} \frac{1}{2}||X - A||^2, \quad
    \text{s.t.}\;
    h(X)\colon= X^T Q p + p^T Q X = 0,\]</p><p>where <span>$h : \mathbb{R}^{2n \times 2k} \rightarrow \operatorname{skew}(2k)$</span> defines the restriction of <span>$X$</span> onto the tangent space <span>$T_p\operatorname{SpSt}(2n, 2k)$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/d817d1cdaff65d57277622c51c69f594b66bf025/src/manifolds/SymplecticStiefel.jl#L468-L487">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ManifoldsBase.retract-Tuple{SymplecticStiefel, Any, Any, CayleyRetraction}" href="#ManifoldsBase.retract-Tuple{SymplecticStiefel, Any, Any, CayleyRetraction}"><code>ManifoldsBase.retract</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">retract(::SymplecticStiefel, p, X, ::CayleyRetraction)
retract!(::SymplecticStiefel, q, p, X, ::CayleyRetraction)</code></pre><p>Compute the Cayley retraction on the Symplectic Stiefel manifold, computed inplace of <code>q</code> from <code>p</code> along <code>X</code>.</p><p>Given a point <span>$p \in \operatorname{SpSt}(2n, 2k)$</span>, every tangent vector <span>$X \in T_p\operatorname{SpSt}(2n, 2k)$</span> is of the form <span>$X = \tilde{\Omega}p$</span>, with</p><p class="math-container">\[    \tilde{\Omega} = \left(I_{2n} - \frac{1}{2}pp^+\right)Xp^+ -
                     pX^+\left(I_{2n} - \frac{1}{2}pp^+\right) \in ℝ^{2n \times 2n},\]</p><p>as shown in Proposition 3.5 of <sup class="footnote-reference"><a id="citeref-Bendokat2021" href="#footnote-Bendokat2021">[Bendokat2021]</a></sup>. Using this representation of <span>$X$</span>, the Cayley retraction on <span>$\operatorname{SpSt}(2n, 2k)$</span> is defined pointwise as</p><p class="math-container">\[    \mathcal{R}_p(X) = \operatorname{cay}\left(\frac{1}{2}\tilde{\Omega}\right)p.\]</p><p>The operator <span>$\operatorname{cay}(A) = (I - A)^{-1}(I + A)$</span> is the Cayley transform.</p><p>However, the computation of an <span>$2n \times 2n$</span> matrix inverse in the expression above can be reduced down to inverting a <span>$2k \times 2k$</span> matrix due to Proposition 5.2 of <sup class="footnote-reference"><a id="citeref-Bendokat2021" href="#footnote-Bendokat2021">[Bendokat2021]</a></sup>.</p><p>Let <span>$A = p^+X$</span> and <span>$H = X - pA$</span>. Then an equivalent expression for the Cayley retraction defined pointwise above is</p><p class="math-container">\[    \mathcal{R}_p(X) = -p + (H + 2p)(H^+H/4 - A/2 + I_{2k})^{-1}.\]</p><p>It is this expression we compute inplace of <code>q</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/d817d1cdaff65d57277622c51c69f594b66bf025/src/manifolds/SymplecticStiefel.jl#L550-L582">source</a></section></article><h2 id="Literature"><a class="docs-heading-anchor" href="#Literature">Literature</a><a id="Literature-1"></a><a class="docs-heading-anchor-permalink" href="#Literature" title="Permalink"></a></h2><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-Bendokat2021"><a class="tag is-link" href="#citeref-Bendokat2021">Bendokat2021</a><blockquote><p>Bendokat, Thomas and Zimmermann, Ralf: The real symplectic Stiefel and Grassmann manifolds: metrics, geodesics and applications arXiv preprint arXiv:2108.12447, 2021 (https://arxiv.org/abs/2108.12447)</p></blockquote></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="symplectic.html">« Symplectic</a><a class="docs-footer-nextpage" href="torus.html">Torus »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Wednesday 28 September 2022 16:46">Wednesday 28 September 2022</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
