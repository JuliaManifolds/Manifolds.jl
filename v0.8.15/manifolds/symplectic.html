<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Symplectic · Manifolds.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img class="docs-light-only" src="../assets/logo.png" alt="Manifolds.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.png" alt="Manifolds.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">Manifolds.jl</a></span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Manifolds</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox" checked/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Basic manifolds</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="centeredmatrices.html">Centered matrices</a></li><li><a class="tocitem" href="choleskyspace.html">Cholesky space</a></li><li><a class="tocitem" href="circle.html">Circle</a></li><li><a class="tocitem" href="elliptope.html">Elliptope</a></li><li><a class="tocitem" href="essentialmanifold.html">Essential manifold</a></li><li><a class="tocitem" href="euclidean.html">Euclidean</a></li><li><a class="tocitem" href="fixedrankmatrices.html">Fixed-rank matrices</a></li><li><a class="tocitem" href="generalizedstiefel.html">Generalized Stiefel</a></li><li><a class="tocitem" href="generalizedgrassmann.html">Generalized Grassmann</a></li><li><a class="tocitem" href="grassmann.html">Grassmann</a></li><li><a class="tocitem" href="hyperbolic.html">Hyperbolic space</a></li><li><a class="tocitem" href="lorentz.html">Lorentzian manifold</a></li><li><a class="tocitem" href="multinomialdoublystochastic.html">Multinomial doubly stochastic matrices</a></li><li><a class="tocitem" href="multinomial.html">Multinomial matrices</a></li><li><a class="tocitem" href="multinomialsymmetric.html">Multinomial symmetric matrices</a></li><li><a class="tocitem" href="oblique.html">Oblique manifold</a></li><li><a class="tocitem" href="probabilitysimplex.html">Probability simplex</a></li><li><a class="tocitem" href="positivenumbers.html">Positive numbers</a></li><li><a class="tocitem" href="projectivespace.html">Projective space</a></li><li><a class="tocitem" href="rotations.html">Rotations</a></li><li><a class="tocitem" href="skewhermitian.html">Skew-Hermitian matrices</a></li><li><a class="tocitem" href="spectrahedron.html">Spectrahedron</a></li><li><a class="tocitem" href="sphere.html">Sphere</a></li><li><a class="tocitem" href="stiefel.html">Stiefel</a></li><li><a class="tocitem" href="symmetric.html">Symmetric matrices</a></li><li><a class="tocitem" href="symmetricpositivedefinite.html">Symmetric positive definite</a></li><li><a class="tocitem" href="symmetricpsdfixedrank.html">Symmetric positive semidefinite fixed rank</a></li><li class="is-active"><a class="tocitem" href="symplectic.html">Symplectic</a><ul class="internal"><li><a class="tocitem" href="#Literature"><span>Literature</span></a></li></ul></li><li><a class="tocitem" href="symplecticstiefel.html">Symplectic Stiefel</a></li><li><a class="tocitem" href="torus.html">Torus</a></li><li><a class="tocitem" href="tucker.html">Tucker</a></li><li><a class="tocitem" href="spheresymmetricmatrices.html">Unit-norm symmetric matrices</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Combined manifolds</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="graph.html">Graph manifold</a></li><li><a class="tocitem" href="power.html">Power manifold</a></li><li><a class="tocitem" href="product.html">Product manifold</a></li><li><a class="tocitem" href="vector_bundle.html">Vector bundle</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Manifold decorators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="connection.html">Connection manifold</a></li><li><a class="tocitem" href="group.html">Group manifold</a></li><li><a class="tocitem" href="metric.html">Metric manifold</a></li></ul></li></ul></li><li><span class="tocitem">Features on Manifolds</span><ul><li><a class="tocitem" href="../features/atlases.html">Atlases and charts</a></li><li><a class="tocitem" href="../features/differentiation.html">Differentiation</a></li><li><a class="tocitem" href="../features/distributions.html">Distributions</a></li><li><a class="tocitem" href="../features/statistics.html">Statistics</a></li><li><a class="tocitem" href="../features/testing.html">Testing</a></li><li><a class="tocitem" href="../features/utilities.html">Utilities</a></li></ul></li><li><span class="tocitem">Miscellanea</span><ul><li><a class="tocitem" href="../misc/about.html">About</a></li><li><a class="tocitem" href="../misc/contributing.html">Contributing</a></li><li><a class="tocitem" href="../misc/internals.html">Internals</a></li><li><a class="tocitem" href="../misc/notation.html">Notation</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manifolds</a></li><li><a class="is-disabled">Basic manifolds</a></li><li class="is-active"><a href="symplectic.html">Symplectic</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="symplectic.html">Symplectic</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/master/docs/src/manifolds/symplectic.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Symplectic"><a class="docs-heading-anchor" href="#Symplectic">Symplectic</a><a id="Symplectic-1"></a><a class="docs-heading-anchor-permalink" href="#Symplectic" title="Permalink"></a></h1><p>The <a href="symplectic.html#Manifolds.Symplectic"><code>Symplectic</code></a> manifold, denoted <span>$\operatorname{Sp}(2n, \mathbb{F})$</span>, is a closed, embedded, submanifold of  <span>$\mathbb{F}^{2n \times 2n}$</span> that represents transformations into symplectic subspaces which keep the canonical symplectic form over <span>$\mathbb{F}^{2n \times 2n }$</span> invariant under the standard embedding inner product. The canonical symplectic form is a non-degenerate bilinear and skew symmetric map  <span>$\omega\colon \mathbb{F}^{2n} \times \mathbb{F}^{2n}  \rightarrow \mathbb{F}$</span>, given by <span>$\omega(x, y) = x^T Q_{2n} y$</span> for elements <span>$x, y \in \mathbb{F}^{2n}$</span>, with</p><p class="math-container">\[    Q_{2n} = 
    \begin{bmatrix}
     0_n  &amp;  I_n \\
    -I_n  &amp;  0_n
    \end{bmatrix}.\]</p><p>That means that an element <span>$p \in \operatorname{Sp}(2n)$</span> must fulfill the requirement that </p><p class="math-container">\[    \omega (p x, p y) = x^T(p^TQp)y = x^TQy = \omega(x, y),\]</p><p>leading to the requirement on <span>$p$</span> that <span>$p^TQp = Q$</span>.</p><p>The symplectic manifold also forms a group under matrix multiplication, called the <span>$\textit{symplectic group}$</span>.  Since all the symplectic matrices necessarily have determinant one, the <a href="https://en.wikipedia.org/wiki/Symplectic_group">symplectic group</a>  <span>$\operatorname{Sp}(2n, \mathbb{F})$</span> is a subgroup of the special linear group, <span>$\operatorname{SL}(2n, \mathbb{F})$</span>. When the underlying  field is either <span>$\mathbb{R}$</span> or <span>$\mathbb{C}$</span> the symplectic group with a manifold structure constitutes a Lie group, with the Lie Algebra </p><p class="math-container">\[    \mathfrak{sp}(2n,F) = \{H \in \mathbb{F}^{2n \times 2n} \;|\; Q H + H^{T} Q = 0\}.\]</p><p>This set is also known as the <a href="https://en.wikipedia.org/wiki/Hamiltonian_matrix">Hamiltonian matrices</a>, which have the  property that <span>$(QH)^T = QH$</span> and are commonly used in physics.</p><article class="docstring"><header><a class="docstring-binding" id="Manifolds.ExtendedSymplecticMetric" href="#Manifolds.ExtendedSymplecticMetric"><code>Manifolds.ExtendedSymplecticMetric</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ExtendedSymplecticMetric &lt;: AbstractMetric</code></pre><p>The extension of the <a href="symplectic.html#Manifolds.RealSymplecticMetric"><code>RealSymplecticMetric</code></a> at a point <code>p \in \operatorname{Sp}(2n)</code> as an inner product over the embedding space <span>$ℝ^{2n \times 2n}$</span>, i.e.</p><p class="math-container">\[    \langle x, y \rangle_{p} = \langle p^{-1}x, p^{-1}\rangle_{\operatorname{Fr}}
    = \operatorname{tr}(x^T(pp^T)^{-1}y), \;\forall\; x, y \in ℝ^{2n \times 2n}.\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/e016386c292372583cb4d46fabf83c1c33252200/src/manifolds/Symplectic.jl#L68-L77">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Manifolds.RealSymplecticMetric" href="#Manifolds.RealSymplecticMetric"><code>Manifolds.RealSymplecticMetric</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">RealSymplecticMetric &lt;: RiemannianMetric</code></pre><p>The canonical Riemannian metric on the symplectic manifold, defined pointwise for <span>$p \in \operatorname{Sp}(2n)$</span> by <sup class="footnote-reference"><a id="citeref-FioriSimone2011" href="#footnote-FioriSimone2011">[FioriSimone2011]</a></sup></p><p class="math-container">\[\begin{align*}
    &amp; g_p \colon T_p\operatorname{Sp}(2n) \times T_p\operatorname{Sp}(2n) \rightarrow ℝ, \\
    &amp; g_p(Z_1, Z_2) = \operatorname{tr}((p^{-1}Z_1)^T (p^{-1}Z_2)).
\end{align*}\]</p><p>This metric is also the default metric for the <a href="symplectic.html#Manifolds.Symplectic"><code>Symplectic</code></a> manifold.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/e016386c292372583cb4d46fabf83c1c33252200/src/manifolds/Symplectic.jl#L53-L65">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Manifolds.Symplectic" href="#Manifolds.Symplectic"><code>Manifolds.Symplectic</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Symplectic{n, 𝔽} &lt;: AbstractEmbeddedManifold{𝔽, DefaultIsometricEmbeddingType}</code></pre><p>The symplectic manifold consists of all <span>$2n \times 2n$</span> matrices which preserve the canonical symplectic form over <span>$𝔽^{2n × 2n} \times 𝔽^{2n × 2n}$</span>,</p><p class="math-container">\[    \omega\colon 𝔽^{2n × 2n} \times 𝔽^{2n × 2n} \rightarrow 𝔽,
    \quad \omega(x, y) = p^T Q_{2n} q, \; x, y \in 𝔽^{2n × 2n},\]</p><p>where</p><p class="math-container">\[Q_{2n} =
\begin{bmatrix}
  0_n &amp; I_n \\
 -I_n &amp; 0_n
\end{bmatrix}.\]</p><p>That is, the symplectic manifold consists of</p><p class="math-container">\[\operatorname{Sp}(2n, ℝ) = \bigl\{ p ∈ ℝ^{2n × 2n} \, \big| \, p^TQ_{2n}p = Q_{2n} \bigr\},\]</p><p>with <span>$0_n$</span> and <span>$I_n$</span> denoting the <span>$n × n$</span> zero-matrix and indentity matrix in <span>$ℝ^{n \times n}$</span> respectively.</p><p>The tangent space at a point <span>$p$</span> is given by <sup class="footnote-reference"><a id="citeref-Bendokat2021" href="#footnote-Bendokat2021">[Bendokat2021]</a></sup></p><p class="math-container">\[\begin{align*}
    T_p\operatorname{Sp}(2n)
        &amp;= \{X \in \mathbb{R}^{2n \times 2n} \;|\; p^{T}Q_{2n}X + X^{T}Q_{2n}p = 0 \}, \\
        &amp;= \{X = pQS \;|\; S ∈ R^{2n × 2n}, S^T = S \}.
\end{align*}\]</p><p><strong>Constructor</strong></p><pre><code class="nohighlight hljs">Symplectic(2n, field=ℝ) -&gt; Symplectic{div(2n, 2), field}()</code></pre><p>Generate the (real-valued) symplectic manifold of <span>$2n \times 2n$</span> symplectic matrices. The constructor for the <a href="symplectic.html#Manifolds.Symplectic"><code>Symplectic</code></a> manifold accepts the even column/row embedding dimension <span>$2n$</span> for the real symplectic manifold, <span>$ℝ^{2n × 2n}$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/e016386c292372583cb4d46fabf83c1c33252200/src/manifolds/Symplectic.jl#L1-L40">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Manifolds.SymplecticMatrix" href="#Manifolds.SymplecticMatrix"><code>Manifolds.SymplecticMatrix</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SymplecticMatrix{T}</code></pre><p>A lightweight structure to represent the action of the matrix representation of the canonical symplectic form,</p><p class="math-container">\[Q_{2n}(λ) = λ
\begin{bmatrix}
0_n &amp; I_n \\
 -I_n &amp; 0_n
\end{bmatrix} \quad \in ℝ^{2n \times 2n},\]</p><p>such that the canonical symplectic form is represented by</p><p class="math-container">\[\omega_{2n}(x, y) = x^TQ_{2n}(1)y, \quad x, y \in ℝ^{2n}.\]</p><p>The entire matrix is however not instantiated in memory, instead a scalar <span>$λ$</span> of type <code>T</code> is stored, which is used to keep track of scaling and transpose operations applied  to each <code>SymplecticMatrix</code>. For example, given <code>Q = SymplecticMatrix(1.0)</code> represented as <code>1.0*[0 I; -I 0]</code>, the adjoint <code>Q&#39;</code> returns <code>SymplecticMatrix(-1.0) = (-1.0)*[0 I; -I 0]</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/e016386c292372583cb4d46fabf83c1c33252200/src/manifolds/Symplectic.jl#L80-L102">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.exp-Tuple{Symplectic, Vararg{Any, N} where N}" href="#Base.exp-Tuple{Symplectic, Vararg{Any, N} where N}"><code>Base.exp</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">exp(M::Symplectic, p, X)
exp!(M::Symplectic, q, p, X)</code></pre><p>The Exponential mapping on the Symplectic manifold with the <a href="symplectic.html#Manifolds.RealSymplecticMetric"><code>RealSymplecticMetric</code></a> Riemannian metric.</p><p>For the point <span>$p \in \operatorname{Sp}(2n)$</span> the exponential mapping along the tangent vector <span>$X \in T_p\operatorname{Sp}(2n)$</span> is computed as <sup class="footnote-reference"><a id="citeref-WangRealSymplecticGroup" href="#footnote-WangRealSymplecticGroup">[WangRealSymplecticGroup]</a></sup></p><p class="math-container">\[    \operatorname{exp}_p(X) = p \operatorname{Exp}((p^{-1}X)^T)
                                \operatorname{Exp}(p^{-1}X - (p^{-1}X)^T),\]</p><p>where <span>$\operatorname{Exp}(\cdot)$</span> denotes the matrix exponential.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/e016386c292372583cb4d46fabf83c1c33252200/src/manifolds/Symplectic.jl#L312-L332">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.inv-Union{Tuple{n}, Tuple{Symplectic{n, ℝ}, Any}} where n" href="#Base.inv-Union{Tuple{n}, Tuple{Symplectic{n, ℝ}, Any}} where n"><code>Base.inv</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">inv(::Symplectic, A)
inv!(::Symplectic, A)</code></pre><p>Compute the symplectic inverse <span>$A^+$</span> of matrix <span>$A ∈ ℝ^{2n × 2n}$</span>. Given a matrix</p><p class="math-container">\[A ∈ ℝ^{2n × 2n},\quad
A =
\begin{bmatrix}
A_{1,1} &amp; A_{1,2} \\
A_{2,1} &amp; A_{2, 2}
\end{bmatrix}\]</p><p>the symplectic inverse is defined as:</p><p class="math-container">\[A^{+} := Q_{2n}^T A^T Q_{2n},\]</p><p>where</p><p class="math-container">\[Q_{2n} =
\begin{bmatrix}
0_n &amp; I_n \\
 -I_n &amp; 0_n
\end{bmatrix}.\]</p><p>The symplectic inverse of A can be expressed explicitly as:</p><p class="math-container">\[A^{+} =
\begin{bmatrix}
  A_{2, 2}^T &amp; -A_{1, 2}^T \\[1.2mm]
 -A_{2, 1}^T &amp;  A_{1, 1}^T
\end{bmatrix}.\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/e016386c292372583cb4d46fabf83c1c33252200/src/manifolds/Symplectic.jl#L427-L460">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.rand-Tuple{Symplectic}" href="#Base.rand-Tuple{Symplectic}"><code>Base.rand</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rand(::SymplecticStiefel; vector_at=nothing,
    hamiltonian_norm = (vector_at === nothing ? 1/2 : 1.0))</code></pre><p>Generate a random point on <span>$\operatorname{Sp}(2n)$</span> or a random tangent vector <span>$X \in T_p\operatorname{Sp}(2n)$</span> if <code>vector_at</code> is set to a point <span>$p \in \operatorname{Sp}(2n)$</span>.</p><p>A random point on <span>$\operatorname{Sp}(2n)$</span> is constructed by generating a random Hamiltonian matrix <span>$Ω \in \mathfrak{sp}(2n,F)$</span> with norm <code>hamiltonian_norm</code>, and then transforming it to a symplectic matrix by applying the Cayley transform</p><p class="math-container">\[    \operatorname{cay}\colon \mathfrak{sp}(2n,F) \rightarrow \operatorname{Sp}(2n),
    \; \Omega \mapsto (I - \Omega)^{-1}(I + \Omega).\]</p><p>To generate a random tangent vector in <span>$T_p\operatorname{Sp}(2n)$</span>, this code employs the second tangent vector space parametrization of <a href="symplectic.html#Symplectic">Symplectic</a>. It first generates a random symmetric matrix <span>$S$</span> by <code>S = randn(2n, 2n)</code> and then symmetrizes it as <code>S = S + S&#39;</code>. Then <span>$S$</span> is normalized to have Frobenius norm of <code>hamiltonian_norm</code> and <code>X = pQS</code> is returned, where <code>Q</code> is the <a href="symplectic.html#Manifolds.SymplecticMatrix"><code>SymplecticMatrix</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/e016386c292372583cb4d46fabf83c1c33252200/src/manifolds/Symplectic.jl#L660-L681">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Manifolds.change_representer-Tuple{Symplectic, EuclideanMetric, Any, Any}" href="#Manifolds.change_representer-Tuple{Symplectic, EuclideanMetric, Any, Any}"><code>Manifolds.change_representer</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">change_representer(::Symplectic, ::EuclideanMetric, p, X)
change_representer!(::Symplectic, Y, ::EuclideanMetric, p, X)</code></pre><p>Compute the representation of a tangent vector <span>$ξ ∈ T_p\operatorname{Sp}(2n, ℝ)$</span> s.t.</p><p class="math-container">\[    g_p(c_p(ξ), η) = ⟨ξ, η⟩^{\text{Euc}} \;∀\; η ∈ T_p\operatorname{Sp}(2n, ℝ).\]</p><p>with the conversion function</p><p class="math-container">\[    c_p : T_p\operatorname{Sp}(2n, ℝ) \rightarrow T_p\operatorname{Sp}(2n, ℝ), \quad
    c_p(ξ) = \frac{1}{2} pp^T ξ + \frac{1}{2} pQ ξ^T pQ.\]</p><p>Each of the terms <span>$c_p^1(ξ) = p p^T ξ$</span> and <span>$c_p^2(ξ) = pQ ξ^T pQ$</span> from the above definition of <span>$c_p(η)$</span> are themselves metric compatible in the sense that</p><p class="math-container">\[    c_p^i : T_p\operatorname{Sp}(2n, ℝ) \rightarrow \mathbb{R}^{2n \times 2n}\quad
    g_p^i(c_p(ξ), η) = ⟨ξ, η⟩^{\text{Euc}} \;∀\; η ∈ T_p\operatorname{Sp}(2n, ℝ),\]</p><p>for <span>$i \in {1, 2}$</span>. However the range of each function alone is not confined to <span>$T_p\operatorname{Sp}(2n, ℝ)$</span>, but the convex combination</p><p class="math-container">\[    c_p(ξ) = \frac{1}{2}c_p^1(ξ) + \frac{1}{2}c_p^2(ξ)\]</p><p>does have the correct range <span>$T_p\operatorname{Sp}(2n, ℝ)$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/e016386c292372583cb4d46fabf83c1c33252200/src/manifolds/Symplectic.jl#L114-L140">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Manifolds.change_representer-Union{Tuple{n}, Tuple{m}, Tuple{𝔽}, Tuple{MetricManifold{𝔽, Euclidean{Tuple{m, n}, 𝔽}, ExtendedSymplecticMetric}, EuclideanMetric, Any, Any}} where {𝔽, m, n}" href="#Manifolds.change_representer-Union{Tuple{n}, Tuple{m}, Tuple{𝔽}, Tuple{MetricManifold{𝔽, Euclidean{Tuple{m, n}, 𝔽}, ExtendedSymplecticMetric}, EuclideanMetric, Any, Any}} where {𝔽, m, n}"><code>Manifolds.change_representer</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">change_representer(MetMan::MetricManifold{𝔽, Euclidean{Tuple{m, n}, 𝔽}, ExtendedSymplecticMetric},
                   EucMet::EuclideanMetric, p, X)
change_representer!(MetMan::MetricManifold{𝔽, Euclidean{Tuple{m, n}, 𝔽}, ExtendedSymplecticMetric},
                    Y, EucMet::EuclideanMetric, p, X)</code></pre><p>Change the representation of a matrix <span>$ξ ∈ \mathbb{R}^{2n \times 2n}$</span> into the inner product space <span>$(ℝ^{2n \times 2n}, g_p)$</span> where the inner product is given by <span>$g_p(ξ, η) = \langle p^{-1}ξ, p^{-1}η \rangle = \operatorname{tr}(ξ^T(pp^T)^{-1}η)$</span>, as the extension of the <a href="symplectic.html#Manifolds.RealSymplecticMetric"><code>RealSymplecticMetric</code></a> onto the entire embedding space.</p><p>By changing the representation we mean to apply a mapping</p><p class="math-container">\[    c_p : \mathbb{R}^{2n \times 2n} \rightarrow \mathbb{R}^{2n \times 2n},\]</p><p>defined by requiring that it satisfy the metric compatibility condition</p><p class="math-container">\[    g_p(c_p(ξ), η) = ⟨p^{-1}c_p(ξ), p^{-1}η⟩ = ⟨ξ, η⟩^{\text{Euc}}
        \;∀\; η ∈ T_p\operatorname{Sp}(2n, ℝ).\]</p><p>In this case, we compute the mapping</p><p class="math-container">\[    c_p(ξ) = pp^T ξ.\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/e016386c292372583cb4d46fabf83c1c33252200/src/manifolds/Symplectic.jl#L150-L175">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Manifolds.gradient-Tuple{Symplectic, Any, Any, Manifolds.RiemannianProjectionBackend}" href="#Manifolds.gradient-Tuple{Symplectic, Any, Any, Manifolds.RiemannianProjectionBackend}"><code>Manifolds.gradient</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">gradient(M::Symplectic, f, p, backend::RiemannianProjectionBackend;
         extended_metric=true)
gradient!(M::Symplectic, f, p, backend::RiemannianProjectionBackend;
         extended_metric=true)</code></pre><p>Compute the manifold gradient <span>$\text{grad}f(p)$</span> of a scalar function <span>$f \colon \operatorname{Sp}(2n) \rightarrow ℝ$</span> at <span>$p \in \operatorname{Sp}(2n)$</span>.</p><p>The element <span>$\text{grad}f(p)$</span> is found as the Riesz representer of the differential <span>$\text{D}f(p) \colon T_p\operatorname{Sp}(2n) \rightarrow ℝ$</span> w.r.t. the Riemannian metric inner product at <span>$p$</span> <sup class="footnote-reference"><a id="citeref-FioriSimone2011" href="#footnote-FioriSimone2011">[FioriSimone2011]</a></sup>. That is, <span>$\text{grad}f(p) \in T_p\operatorname{Sp}(2n)$</span> solves the relation</p><p class="math-container">\[    g_p(\text{grad}f(p), X) = \text{D}f(p) \quad\forall\; X \in T_p\operatorname{Sp}(2n).\]</p><p>The default behaviour is to first change the representation of the Euclidean gradient from the Euclidean metric to the <a href="symplectic.html#Manifolds.RealSymplecticMetric"><code>RealSymplecticMetric</code></a> at <span>$p$</span>, and then we projecting the result onto the correct tangent tangent space <span>$T_p\operatorname{Sp}(2n, ℝ)$</span> w.r.t the Riemannian metric <span>$g_p$</span> extended to the entire embedding space.</p><p><strong>Arguments:</strong></p><ul><li><code>extended_metric = true</code>: If <code>true</code>, compute the gradient <span>$\text{grad}f(p)$</span> by   first changing the representer of the Euclidean gradient of a smooth extension   of <span>$f$</span>, <span>$∇f(p)$</span>, w.r.t. the <a href="symplectic.html#Manifolds.RealSymplecticMetric"><code>RealSymplecticMetric</code></a> at <span>$p$</span>   extended to the entire embedding space, before projecting onto the correct   tangent vector space w.r.t. the same extended metric <span>$g_p$</span>.   If <code>false</code>, compute the gradient by first projecting <span>$∇f(p)$</span> onto the   tangent vector space, before changing the representer in the tangent   vector space to comply with the <a href="symplectic.html#Manifolds.RealSymplecticMetric"><code>RealSymplecticMetric</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/e016386c292372583cb4d46fabf83c1c33252200/src/manifolds/Symplectic.jl#L343-L382">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Manifolds.project_normal!-Union{Tuple{𝔽}, Tuple{n}, Tuple{m}, Tuple{MetricManifold{𝔽, Euclidean{Tuple{m, n}, 𝔽}, ExtendedSymplecticMetric}, Any, Any, Any}} where {m, n, 𝔽}" href="#Manifolds.project_normal!-Union{Tuple{𝔽}, Tuple{n}, Tuple{m}, Tuple{MetricManifold{𝔽, Euclidean{Tuple{m, n}, 𝔽}, ExtendedSymplecticMetric}, Any, Any, Any}} where {m, n, 𝔽}"><code>Manifolds.project_normal!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">project_normal!(::MetricManifold{𝔽,Euclidean,ExtendedSymplecticMetric}, Y, p, X)</code></pre><p>Project onto the normal of the tangent space <span>$(T_p\operatorname{Sp}(2n))^{\perp_g}$</span> at a point <span>$p ∈ \operatorname{Sp}(2n)$</span>, relative to the riemannian metric <span>$g$</span> <a href="symplectic.html#Manifolds.RealSymplecticMetric"><code>RealSymplecticMetric</code></a>. That is,</p><p class="math-container">\[(T_p\operatorname{Sp}(2n))^{\perp_g} = \{Y \in \mathbb{R}^{2n \times 2n} :
                        g_p(Y, X) = 0 \;\forall\; X \in T_p\operatorname{Sp}(2n)\}.\]</p><p>The closed form projection operator onto the normal space is given by <sup class="footnote-reference"><a id="citeref-Gao2021Riemannian" href="#footnote-Gao2021Riemannian">[Gao2021Riemannian]</a></sup></p><p class="math-container">\[\operatorname{P}^{(T_p\operatorname{Sp}(2n))\perp}_{g_p}(X) = pQ\operatorname{skew}(p^TQ^TX),\]</p><p>where <span>$\operatorname{skew}(A) = \frac{1}{2}(A - A^T)$</span>. This function is not exported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/e016386c292372583cb4d46fabf83c1c33252200/src/manifolds/Symplectic.jl#L621-L644">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Manifolds.symplectic_inverse_times-Union{Tuple{n}, Tuple{Symplectic{n, 𝔽} where 𝔽, Any, Any}} where n" href="#Manifolds.symplectic_inverse_times-Union{Tuple{n}, Tuple{Symplectic{n, 𝔽} where 𝔽, Any, Any}} where n"><code>Manifolds.symplectic_inverse_times</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">symplectic_inverse_times(::Symplectic, p, q)
symplectic_inverse_times!(::Symplectic, A, p, q)</code></pre><p>Directly compute the symplectic inverse of <span>$p \in \operatorname{Sp}(2n)$</span>, multiplied with <span>$q \in \operatorname{Sp}(2n)$</span>. That is, this function efficiently computes <span>$p^+q = (Q_{2n}p^TQ_{2n})q \in ℝ^{2n \times 2n}$</span>, where <span>$Q_{2n}$</span> is the <a href="symplectic.html#Manifolds.SymplecticMatrix"><code>SymplecticMatrix</code></a> of size <span>$2n \times 2n$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/e016386c292372583cb4d46fabf83c1c33252200/src/manifolds/Symplectic.jl#L767-L777">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ManifoldsBase.check_point-Union{Tuple{ℝ}, Tuple{n}, Tuple{Symplectic{n, ℝ}, Any}} where {n, ℝ}" href="#ManifoldsBase.check_point-Union{Tuple{ℝ}, Tuple{n}, Tuple{Symplectic{n, ℝ}, Any}} where {n, ℝ}"><code>ManifoldsBase.check_point</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">check_point(M::Symplectic, p; kwargs...)</code></pre><p>Check whether <code>p</code> is a valid point on the <a href="symplectic.html#Manifolds.Symplectic"><code>Symplectic</code></a> <code>M</code>=<span>$\operatorname{Sp}(2n)$</span>, i.e. that it has the right <a href="https://juliamanifolds.github.io/ManifoldsBase.jl/stable/types.html#number-system"><code>AbstractNumbers</code></a> type and <span>$p^{+}p$</span> is (approximately) the identity, where <span>$A^{+} = Q_{2n}^TA^TQ_{2n}$</span> is the symplectic inverse, with</p><p class="math-container">\[Q_{2n} =
\begin{bmatrix}
0_n &amp; I_n \\
 -I_n &amp; 0_n
\end{bmatrix}.\]</p><p>The tolerance can be set with <code>kwargs...</code> (e.g. <code>atol = 1.0e-14</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/e016386c292372583cb4d46fabf83c1c33252200/src/manifolds/Symplectic.jl#L196-L210">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ManifoldsBase.check_vector-Tuple{Symplectic, Vararg{Any, N} where N}" href="#ManifoldsBase.check_vector-Tuple{Symplectic, Vararg{Any, N} where N}"><code>ManifoldsBase.check_vector</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">check_vector(M::Symplectic, p, X; kwargs...)</code></pre><p>Checks whether <code>X</code> is a valid tangent vector at <code>p</code> on the <a href="symplectic.html#Manifolds.Symplectic"><code>Symplectic</code></a> <code>M</code>=<span>$\operatorname{Sp}(2n)$</span>, i.e. the <a href="https://juliamanifolds.github.io/ManifoldsBase.jl/stable/types.html#number-system"><code>AbstractNumbers</code></a> fits and it (approximately) holds that <span>$p^{T}Q_{2n}X + X^{T}Q_{2n}p = 0$</span>, where</p><p class="math-container">\[Q_{2n} =
\begin{bmatrix}
0_n &amp; I_n \\
 -I_n &amp; 0_n
\end{bmatrix}.\]</p><p>The tolerance can be set with <code>kwargs...</code> (e.g. <code>atol = 1.0e-14</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/e016386c292372583cb4d46fabf83c1c33252200/src/manifolds/Symplectic.jl#L226-L241">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ManifoldsBase.distance-Union{Tuple{n}, Tuple{Symplectic{n, 𝔽} where 𝔽, Any, Any}} where n" href="#ManifoldsBase.distance-Union{Tuple{n}, Tuple{Symplectic{n, 𝔽} where 𝔽, Any, Any}} where n"><code>ManifoldsBase.distance</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">distance(M::Symplectic, p, q)</code></pre><p>Compute an approximate geodesic distance between two Symplectic matrices <span>$p, q \in \operatorname{Sp}(2n)$</span>, as done in <sup class="footnote-reference"><a id="citeref-WangRealSymplecticGroup" href="#footnote-WangRealSymplecticGroup">[WangRealSymplecticGroup]</a></sup>.</p><p class="math-container">\[    \operatorname{dist}(p, q)
        ≈ ||\operatorname{Log}(p^+q)||_{\operatorname{Fr}},\]</p><p>where the <span>$\operatorname{Log}(\cdot)$</span> operator is the matrix logarithm.</p><p>This approximation is justified by first recalling the Baker-Campbell-Hausdorf formula,</p><p class="math-container">\[\operatorname{Log}(\operatorname{Exp}(A)\operatorname{Exp}(B))
 = A + B + \frac{1}{2}[A, B] + \frac{1}{12}[A, [A, B]] + \frac{1}{12}[B, [B, A]]
    + \ldots \;.\]</p><p>Then we write the expression for the exponential map from <span>$p$</span> to <span>$q$</span> as</p><p class="math-container">\[    q =
    \operatorname{exp}_p(X)
    =
    p \operatorname{Exp}((p^{+}X)^T)
    \operatorname{Exp}([p^{+}X - (p^{+}X)^T]),
    X \in T_p\operatorname{Sp},\]</p><p>and with the geodesic distance between <span>$p$</span> and <span>$q$</span> given by <span>$\operatorname{dist}(p, q) = ||X||_p = ||p^+X||_{\operatorname{Fr}}$</span> we see that</p><p class="math-container">\[    \begin{align*}
    ||\operatorname{Log}(p^+q)||_{\operatorname{Fr}}
    &amp;= ||\operatorname{Log}\left(
        \operatorname{Exp}((p^{+}X)^T)
        \operatorname{Exp}(p^{+}X - (p^{+}X)^T)
    \right)||_{\operatorname{Fr}} \\
    &amp;= ||p^{+}X + \frac{1}{2}[(p^{+}X)^T, p^{+}X - (p^{+}X)^T]
            + \ldots ||_{\operatorname{Fr}} \\
    &amp;≈ ||p^{+}X||_{\operatorname{Fr}} = \operatorname{dist}(p, q).
    \end{align*}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/e016386c292372583cb4d46fabf83c1c33252200/src/manifolds/Symplectic.jl#L263-L304">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ManifoldsBase.inner-Union{Tuple{n}, Tuple{Symplectic{n, ℝ}, Any, Any, Any}} where n" href="#ManifoldsBase.inner-Union{Tuple{n}, Tuple{Symplectic{n, ℝ}, Any, Any, Any}} where n"><code>ManifoldsBase.inner</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">inner(::Symplectic{n, ℝ}, p, X, Y)</code></pre><p>Compute the canonical Riemannian inner product <a href="symplectic.html#Manifolds.RealSymplecticMetric"><code>RealSymplecticMetric</code></a></p><p class="math-container">\[    g_p(X, Y) = \operatorname{tr}((p^{-1}X)^T (p^{-1}Y))\]</p><p>between the two tangent vectors <span>$X, Y \in T_p\operatorname{Sp}(2n)$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/e016386c292372583cb4d46fabf83c1c33252200/src/manifolds/Symplectic.jl#L413-L421">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ManifoldsBase.inverse_retract-Tuple{Symplectic, Any, Any, CayleyInverseRetraction}" href="#ManifoldsBase.inverse_retract-Tuple{Symplectic, Any, Any, CayleyInverseRetraction}"><code>ManifoldsBase.inverse_retract</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">inverse_retract(M::Symplectic, p, q, ::CayleyInverseRetraction)</code></pre><p>Compute the Cayley Inverse Retraction <span>$X = \mathcal{L}_p^{\operatorname{Sp}}(q)$</span> such that the Cayley Retraction from <span>$p$</span> along <span>$X$</span> lands at <span>$q$</span>, i.e. <span>$\mathcal{R}_p(X) = q$</span> <sup class="footnote-reference"><a id="citeref-Bendokat2021" href="#footnote-Bendokat2021">[Bendokat2021]</a></sup>.</p><p>First, recall the definition the standard symplectic matrix</p><p class="math-container">\[Q =
\begin{bmatrix}
 0    &amp; I \\
-I  &amp; 0
\end{bmatrix}\]</p><p>as well as the symplectic inverse of a matrix <span>$A$</span>, <span>$A^{+} = Q^T A^T Q$</span>.</p><p>For <span>$p, q ∈ \operatorname{Sp}(2n, ℝ)$</span> then, we can then define the inverse cayley retraction as long as the following matrices exist.</p><p class="math-container">\[    U = (I + p^+ q)^{-1}, \quad V = (I + q^+ p)^{-1}.\]</p><p>If that is the case, the inverse cayley retration at <span>$p$</span> applied to <span>$q$</span> is</p><p class="math-container">\[\mathcal{L}_p^{\operatorname{Sp}}(q) = 2p\bigl(V - U\bigr) + 2\bigl((p + q)U - p\bigr)
                                        ∈ T_p\operatorname{Sp}(2n).\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/e016386c292372583cb4d46fabf83c1c33252200/src/manifolds/Symplectic.jl#L501-L534">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ManifoldsBase.manifold_dimension-Union{Tuple{Symplectic{n, 𝔽} where 𝔽}, Tuple{n}} where n" href="#ManifoldsBase.manifold_dimension-Union{Tuple{Symplectic{n, 𝔽} where 𝔽}, Tuple{n}} where n"><code>ManifoldsBase.manifold_dimension</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">manifold_dimension(::Symplectic{n})</code></pre><p>Returns the dimension of the symplectic manifold embedded in <span>$ℝ^{2n \times 2n}$</span>, i.e.</p><p class="math-container">\[    \operatorname{dim}(\operatorname{Sp}(2n)) = (2n + 1)n.\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/e016386c292372583cb4d46fabf83c1c33252200/src/manifolds/Symplectic.jl#L545-L553">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ManifoldsBase.project!-Union{Tuple{𝔽}, Tuple{n}, Tuple{m}, Tuple{MetricManifold{𝔽, Euclidean{Tuple{m, n}, 𝔽}, ExtendedSymplecticMetric}, Any, Any, Any}} where {m, n, 𝔽}" href="#ManifoldsBase.project!-Union{Tuple{𝔽}, Tuple{n}, Tuple{m}, Tuple{MetricManifold{𝔽, Euclidean{Tuple{m, n}, 𝔽}, ExtendedSymplecticMetric}, Any, Any, Any}} where {m, n, 𝔽}"><code>ManifoldsBase.project!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">project!(::MetricManifold{𝔽,Euclidean,ExtendedSymplecticMetric}, Y, p, X) where {𝔽}</code></pre><p>Compute the projection of <span>$X ∈ R^{2n × 2n}$</span> onto <span>$T_p\operatorname{Sp}(2n, ℝ)$</span> w.r.t. the Riemannian metric <span>$g$</span> <a href="symplectic.html#Manifolds.RealSymplecticMetric"><code>RealSymplecticMetric</code></a>. The closed form projection mapping is given by <sup class="footnote-reference"><a id="citeref-Gao2021Riemannian" href="#footnote-Gao2021Riemannian">[Gao2021Riemannian]</a></sup></p><p class="math-container">\[    \operatorname{P}^{T_p\operatorname{Sp}(2n)}_{g_p}(X) = pQ\operatorname{sym}(p^TQ^TX),\]</p><p>where <span>$\operatorname{sym}(A) = \frac{1}{2}(A + A^T)$</span>. This function is not exported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/e016386c292372583cb4d46fabf83c1c33252200/src/manifolds/Symplectic.jl#L594-L605">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ManifoldsBase.project-Tuple{Symplectic, Any, Any}" href="#ManifoldsBase.project-Tuple{Symplectic, Any, Any}"><code>ManifoldsBase.project</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">project(::Symplectic, p, A)
project!(::Symplectic, Y, p, A)</code></pre><p>Given a point <span>$p \in \operatorname{Sp}(2n)$</span>, project an element <span>$A \in \mathbb{R}^{2n \times 2n}$</span> onto the tangent space <span>$T_p\operatorname{Sp}(2n)$</span> relative to the euclidean metric of the embedding <span>$\mathbb{R}^{2n \times 2n}$</span>.</p><p>That is, we find the element <span>$X \in T_p\operatorname{SpSt}(2n, 2k)$</span> which solves the constrained optimization problem</p><p class="math-container">\[    \operatorname{min}_{X \in \mathbb{R}^{2n \times 2n}} \frac{1}{2}||X - A||^2, \quad
    \text{s.t.}\;
    h(X) \colon= X^T Q p + p^T Q X = 0,\]</p><p>where <span>$h\colon\mathbb{R}^{2n \times 2n} \rightarrow \operatorname{skew}(2n)$</span> defines the restriction of <span>$X$</span> onto the tangent space <span>$T_p\operatorname{SpSt}(2n, 2k)$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/e016386c292372583cb4d46fabf83c1c33252200/src/manifolds/Symplectic.jl#L556-L574">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ManifoldsBase.retract-Tuple{Symplectic, Any, Any}" href="#ManifoldsBase.retract-Tuple{Symplectic, Any, Any}"><code>ManifoldsBase.retract</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">retract(::Symplectic, p, X, ::CayleyRetraction)
retract!(::Symplectic, q, p, X, ::CayleyRetraction)</code></pre><p>Compute the Cayley retraction on <span>$p ∈ \operatorname{Sp}(2n, ℝ)$</span> in the direction of tangent vector <span>$X ∈ T_p\operatorname{Sp}(2n, ℝ)$</span>, as defined in by Birtea et al in proposition 2 <sup class="footnote-reference"><a id="citeref-birtea2020optimization" href="#footnote-birtea2020optimization">[birtea2020optimization]</a></sup>.</p><p>Using the symplectic inverse of a matrix <span>$A \in ℝ^{2n \times 2n}$</span>, <span>$A^{+} := Q_{2n}^T A^T Q_{2n}$</span> where</p><p class="math-container">\[Q_{2n} =
\begin{bmatrix}
0_n &amp; I_n \\
 -I_n &amp; 0_n
\end{bmatrix},\]</p><p>the retraction <span>$\mathcal{R}\colon T\operatorname{Sp}(2n) \rightarrow \operatorname{Sp}(2n)$</span> is defined pointwise as</p><p class="math-container">\[\begin{align*}
\mathcal{R}_p(X) &amp;= p \operatorname{cay}\left(\frac{1}{2}p^{+}X\right), \\
                 &amp;= p \operatorname{exp}_{1/1}(p^{+}X), \\
                 &amp;= p (2I - p^{+}X)^{-1}(2I + p^{+}X).
\end{align*}\]</p><p>Here <span>$\operatorname{exp}_{1/1}(z) = (2 - z)^{-1}(2 + z)$</span> denotes the Padé (1, 1) approximation to <span>$\operatorname{exp}(z)$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manifolds.jl/blob/e016386c292372583cb4d46fabf83c1c33252200/src/manifolds/Symplectic.jl#L715-L754">source</a></section></article><h2 id="Literature"><a class="docs-heading-anchor" href="#Literature">Literature</a><a id="Literature-1"></a><a class="docs-heading-anchor-permalink" href="#Literature" title="Permalink"></a></h2><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-WangRealSymplecticGroup"><a class="tag is-link" href="#citeref-WangRealSymplecticGroup">WangRealSymplecticGroup</a><blockquote><p>Wang, Jing and Sun, Huafei and Fiori, Simone: A Riemannian-steepest-descent approach for optimization on the real symplectic group, Mathematical Methods in the Applied Sciences, 41(11) pp. 4273-4286, 2018 doi <a href="https://doi.org/10.1002/mma.4890">10.1002/mma.4890</a></p></blockquote></li><li class="footnote" id="footnote-FioriSimone2011"><a class="tag is-link" href="#citeref-FioriSimone2011">FioriSimone2011</a><blockquote><p>Simone Fiori: Solving minimal-distance problems over the manifold of real-symplectic matrices, SIAM Journal on Matrix Analysis and Applications 32(3), pp. 938-968, 2011. doi <a href="https://doi.org/10.1137/100817115">10.1137/100817115</a>.</p></blockquote></li><li class="footnote" id="footnote-Gao2021Riemannian"><a class="tag is-link" href="#citeref-Gao2021Riemannian">Gao2021Riemannian</a><blockquote><p>Gao, Bin and Son, Nguyen Thanh and Absil, P-A and Stykel, Tatjana: Riemannian optimization on the symplectic Stiefel manifold, SIAM Journal on Optimization 31(2), pp. 1546-1575, 2021. doi <a href="https://doi.org/10.1137/20M1348522">10.1137/20M1348522</a></p></blockquote></li><li class="footnote" id="footnote-Bendokat2021"><a class="tag is-link" href="#citeref-Bendokat2021">Bendokat2021</a><blockquote><p>Bendokat, Thomas and Zimmermann, Ralf: The real symplectic Stiefel and Grassmann manifolds: metrics, geodesics and applications arXiv preprint arXiv:2108.12447, 2021 (https://arxiv.org/abs/2108.12447)</p></blockquote></li><li class="footnote" id="footnote-birtea2020optimization"><a class="tag is-link" href="#citeref-birtea2020optimization">birtea2020optimization</a><blockquote><p>Birtea, Petre and Ca{\c{s}}u, Ioan and Com{\u{a}}nescu, Dan: Optimization on the real symplectic group, Monatshefte f{&quot;u}r Mathematik, Springer doi <a href="https://doi.org/10.1007/s00605-020-01369-9">10.1007/s00605-020-01369-9</a></p></blockquote></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="symmetricpsdfixedrank.html">« Symmetric positive semidefinite fixed rank</a><a class="docs-footer-nextpage" href="symplecticstiefel.html">Symplectic Stiefel »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.20 on <span class="colophon-date" title="Sunday 10 July 2022 18:58">Sunday 10 July 2022</span>. Using Julia version 1.6.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
